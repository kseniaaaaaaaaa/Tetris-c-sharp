"use strict";(self.webpackChunkvkweb=self.webpackChunkvkweb||[]).push([[36834],{634268:(e,t,i)=>{i.d(t,{default:()=>r});const r={sticker:"Sticker-module__sticker--CtZU6",placeholder:"Sticker-module__placeholder--5PW3m",in:"Sticker-module__in--pEnhZ",tappable:"Sticker-module__tappable--M4lob",content:"Sticker-module__content--MQWSP",disabled:"Sticker-module__disabled--cK_tc",favorite:"Sticker-module__favorite--Xqlbr"}},881157:(e,t,i)=>{i.d(t,{default:()=>r});const r={favorite:"FavoriteButton-module__favorite--jHzWm",active:"FavoriteButton-module__active--aUeeT"}},705622:(e,t,i)=>{i.d(t,{default:()=>r});const r={overlay:"Overlay-module__overlay--YyHpH"}},145636:(e,t,i)=>{i.d(t,{default:()=>r});const r={iconAnimated:"PopupWrapper-module__iconAnimated--jlPzq",horizontalTremble:"PopupWrapper-module__horizontalTremble--RrOKq",stickerAnimationIsPlaying:"PopupWrapper-module__stickerAnimationIsPlaying--yaedE"}},899739:(e,t,i)=>{i.d(t,{default:()=>r});const r={wrapper:"Wrapper-module__wrapper--UjlcM",wrapperFlex:"Wrapper-module__wrapperFlex--g0FiZ",wrapperFlexLeft:"Wrapper-module__wrapperFlexLeft--toZla",wrapperFlexRight:"Wrapper-module__wrapperFlexRight--EzB15",icon:"Wrapper-module__icon--FlANj",iconAbsolute:"Wrapper-module__iconAbsolute--Z0rTi",iconAbsoluteLeft:"Wrapper-module__iconAbsoluteLeft--q4aty",iconAbsoluteRight:"Wrapper-module__iconAbsoluteRight--ooVCb",iconAbsoluteInsetLeft:"Wrapper-module__iconAbsoluteInsetLeft--FMAKS",iconAbsoluteInsetRight:"Wrapper-module__iconAbsoluteInsetRight--_WGDJ",iconRelative:"Wrapper-module__iconRelative--o019B",iconRelativeLeft:"Wrapper-module__iconRelativeLeft--gRekN",iconRelativeRight:"Wrapper-module__iconRelativeRight--Be_dd"}},39665:(e,t,i)=>{i.d(t,{Sticker:()=>f});var r=i(785893),s=i(659397),a=i(86894),n=i(571309),o=i(667294),c=i(319592),l=i(267744),d=i(956245),u=i(722257),h=i(634268);const m=92,g=16,p=new Set;function f({size:e,theme:t,plain:i,configs:f,dynamic:_,favorite:v,disabled:k,defaultConfigId:b,onFavoriteClick:x,sticker:C,UNSAFE_imageUrl:I,UNSAFE_animationUrl:A,name:w,group:y="sticker",loading:R,className:S,style:N,...j}){const{onClick:P}=j,{hasPointer:L}=(0,a.useAdaptivityWithJSMediaQueries)(),U=(0,d.getStickerContext)(C),F=(0,l.useOverlay)(U),{imageUrl:B,animationUrl:M}=(0,o.useMemo)((()=>{if(I||A)return{imageUrl:I,animationUrl:A};if(!C)return{};const i=u.BaseUrlBuilder.getAnimation({type:t,animations:U.animations})?.url||U.animationUrl;return{imageUrl:new u.BaseUrlBuilder({size:e,theme:t,configs:f,defaultConfigId:b,imageId:U.id,configContext:U.imageConfigContext,images:t===u.Theme.LIGHT?U.images:U.imagesWithBackground}).build(),animationUrl:i}}),[e,t,C,f,b,I,A]),[W,O]=(0,o.useState)(!p.has(B)),{lottieContainerRef:z,lottieLoading:T,lottieError:E}=(0,n.useLottie)({group:y,width:e,height:e,loop:!0,autoplay:!0,name:M||"",animationUrl:F?void 0:M});(0,o.useEffect)((()=>{_||O(!p.has(B))}),[B,_]);const D=!M||E,G=W&&T,$=Boolean(!i&&P),H=G||Boolean(F),X=e/m,q=Math.round(g*X);return(0,r.jsx)("div",{"data-testid":`sticker${M?"-animated":""}${U.id?`-${U.id}`:""}`,className:(0,s.classNames)(h.default.sticker,{[h.default.disabled]:k,[h.default.placeholder]:H,[h.default.tappable]:$},S),style:{"--sticker-size":`${e}px`,"--sticker-scale":String(X.toFixed(2)),width:e,height:e,...N},...j,children:(0,r.jsxs)("div",{ref:z,className:h.default.in,children:[x&&L&&!G&&(0,r.jsx)(c.FavoriteButton,{className:h.default.favorite,active:v,width:q,height:q,onClick:e=>{e.stopPropagation(),x?.()}}),D&&!F&&(0,r.jsx)("img",{className:h.default.content,alt:"",src:B,loading:R,onError:()=>{O(!p.has(B))},onLoad:()=>{p.add(B),O(!1)}}),F]})})}},319592:(e,t,i)=>{i.d(t,{FavoriteButton:()=>o});var r=i(785893),s=i(659397),a=i(587109),n=i(881157);function o({active:e,className:t,...i}){return(0,r.jsx)(a.Icon20Favorite,{className:(0,s.classNames)(n.default.favorite,{[n.default.active]:e},t),...i})}},256378:(e,t,i)=>{i.d(t,{AgeRestrictedOverlay:()=>o});var r=i(785893),s=i(108268),a=i(949780),n=i(141877);function o(){const{translate:e}=(0,s.useLangPack)();return(0,r.jsx)(n.Overlay,{icon:(0,r.jsx)(a.Icon2418CircleOutline,{}),description:e("stickers_kit_sticker_age_restricted")})}},734470:(e,t,i)=>{i.d(t,{BannedOverlay:()=>o});var r=i(785893),s=i(88493),a=i(108268),n=i(141877);function o(){const{translate:e}=(0,a.useLangPack)();return(0,r.jsx)(n.Overlay,{icon:(0,r.jsx)(s.Icon24BlockOutline,{}),description:e("stickers_kit_sticker_banned")})}},948845:(e,t,i)=>{i.d(t,{DeletedOverlay:()=>o});var r=i(785893),s=i(903421),a=i(108268),n=i(141877);function o(){const{translate:e}=(0,a.useLangPack)();return(0,r.jsx)(n.Overlay,{icon:(0,r.jsx)(s.Icon24DeleteOutline,{}),description:e("stickers_kit_sticker_deleted")})}},554288:(e,t,i)=>{i.d(t,{ModerationOverlay:()=>o});var r=i(785893),s=i(910301),a=i(108268),n=i(141877);function o(){const{translate:e}=(0,a.useLangPack)();return(0,r.jsx)(n.Overlay,{icon:(0,r.jsx)(s.Icon24ClockOutline,{}),description:e("stickers_kit_ugc_sticker_in_moderation")})}},141877:(e,t,i)=>{i.d(t,{Overlay:()=>o});var r=i(785893),s=i(659397),a=i(86894),n=i(705622);function o({icon:e,description:t,className:i}){return(0,r.jsxs)("div",{className:(0,s.classNames)(n.default.overlay,i),children:[e,t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.Spacing,{size:2}),(0,r.jsx)(a.Subhead,{dangerouslySetInnerHTML:{__html:t}})]})]})}},267744:(e,t,i)=>{i.d(t,{useOverlay:()=>c});var r=i(785893),s=i(734470),a=i(948845),n=i(554288),o=i(256378);function c({isUGC:e,isDeleted:t,isBanned:i,isRejected:c,isClaimed:l,isActiveAgeRestriction:d}){return e?t?(0,r.jsx)(a.DeletedOverlay,{}):i||c?(0,r.jsx)(s.BannedOverlay,{}):l?(0,r.jsx)(n.ModerationOverlay,{}):d?(0,r.jsx)(o.AgeRestrictedOverlay,{}):null:null}},676150:(e,t,i)=>{i.d(t,{LazyStickerRich:()=>c});var r=i(785893),s=i(667294),a=i(86894),n=i(659397);const o=(0,s.lazy)((()=>(0,n.asyncImportLoader)((async()=>{const{StickerRich:e}=await Promise.all([i.e(20795),i.e(36834),i.e(79344)]).then(i.bind(i,274648));return{default:e}}))));function c(e){const{size:t}=e.baseStickerProps;return(0,r.jsx)(s.Suspense,{fallback:(0,r.jsx)("div",{style:{width:t,height:t},children:(0,r.jsx)(a.Spinner,{})}),children:(0,r.jsx)(o,{...e})})}},274648:(e,t,i)=>{i.d(t,{StickerRich:()=>l});var r=i(785893),s=i(39665),a=i(766797),n=i(467149),o=i(956245),c=i(560944);function l({baseStickerProps:e,wrapperProps:t,popupProps:i}){var l;const{sticker:d}=e,u=(0,o.getStickerContext)(d);e.sticker=u,(l=t).icon??(l.icon=(0,c.getDefaultIcon)(d));const h=(0,r.jsx)(s.Sticker,{...e}),{isUGC:m,isPopup:g}=u;return g?(0,r.jsx)(a.PopupWrapper,{wrapperProps:t,...i,children:h}):m?(0,r.jsx)(n.Wrapper,{...t,children:h}):h}},766797:(e,t,i)=>{i.d(t,{PopupWrapper:()=>o});var r=i(785893),s=i(659397),a=i(467149),n=i(145636);function o({wrapperProps:e,isAnimationPlaying:t,children:i}){return(0,r.jsx)(a.Wrapper,{...e,contentClassName:(0,s.classNames)(e.contentClassName,n.default.iconAnimated),stickerContainerClassName:(0,s.classNames)(e.stickerContainerClassName,{[n.default.stickerAnimationIsPlaying]:t}),children:i})}},467149:(e,t,i)=>{i.d(t,{Wrapper:()=>c});var r=i(785893),s=i(86894),a=i(659397),n=i(674411),o=i(899739);function c({icon:e,children:t,iconPosition:i,onContentClick:c,contentClassName:l="",wrapperClassName:d="",stickerContainerClassName:u=""}){const h=(0,n.stylesModifier)(i);return(0,r.jsxs)("div",{"data-testid":"sticker-rich-wrapper",className:(0,a.classNames)(o.default.wrapper,h.wrapper,d),children:[(0,r.jsx)("div",{"data-testid":"sticker-rich-sticker-wrapper",className:(0,a.classNames)(u,h.stickerWrapper),children:t}),(0,r.jsx)("div",{"data-testid":"sticker-rich-icon-wrapper",className:(0,a.classNames)(o.default.icon,h.icon,l),children:(0,r.jsx)(s.Tappable,{activeMode:"opacity",hoverMode:"opacity",disabled:!c,onClick:c,children:e})})]})}},674411:(e,t,i)=>{i.d(t,{stylesModifier:()=>a});var r=i(659397),s=i(899739);const a=(e="rightInset")=>{let t={wrapper:"",stickerWrapper:"",icon:""};switch(e){case"leftAbsolute":return{...t,icon:(0,r.classNames)(s.default.iconAbsolute,s.default.iconAbsoluteLeft)};case"rightAbsolute":return{...t,icon:(0,r.classNames)(s.default.iconAbsolute,s.default.iconAbsoluteRight)};case"leftInset":return{...t,icon:(0,r.classNames)(s.default.iconAbsolute,s.default.iconAbsoluteInsetLeft)};case"rightInset":return{...t,icon:(0,r.classNames)(s.default.iconAbsolute,s.default.iconAbsoluteInsetRight)};case"leftRelative":return{...t,wrapper:(0,r.classNames)(s.default.wrapperFlex,s.default.wrapperFlexLeft),icon:(0,r.classNames)(s.default.iconRelative,s.default.iconRelativeLeft)};case"rightRelative":return{...t,wrapper:(0,r.classNames)(s.default.wrapperFlex,s.default.wrapperFlexRight),icon:(0,r.classNames)(s.default.iconRelative,s.default.iconRelativeRight)};default:return t}}},560944:(e,t,i)=>{i.d(t,{getDefaultIcon:()=>n});var r=i(785893),s=i(376648),a=i(956245);const n=e=>{const t=(0,a.getStickerContext)(e),{isUGC:i}=t;return i?(0,r.jsx)(s.Icon20UgcChatStickerCircleFillBlackAlpha,{}):null}},956245:(e,t,i)=>{i.d(t,{getStickerContext:()=>s});var r=i(366617);function s(e){return e instanceof r.StickerContext?e:new r.StickerContext(e)}},366617:(e,t,i)=>{i.d(t,{StickerContext:()=>r,getStickerContext:()=>s});class r{get rawData(){return this.ugc||this.base}get isUGC(){return Boolean(this.ugc)}get isPopup(){return Boolean(this.base?.popup)}get isBase(){return Boolean(this.base)}get id(){return this.base?.sticker_id||this.ugc?.id}get ownerId(){return this.ugc?.owner_id}get packId(){return this.base?.product_id||this.ugc?.pack_id}get images(){return this.base?.images||this.ugc?.images}get imagesWithBackground(){return this.base?.images_with_background||this.base?.images||this.ugc?.images}get animations(){return this.base?.animations}get animationUrl(){return this.base?.animation_url}get imageConfigContext(){return this.base?.image_config_context}get isAllowed(){return!!this.isUGC||this.base?.is_allowed}get isActiveAgeRestriction(){return"age_18"===this.ugc?.active_restriction}get isBanned(){return"banned"===this.ugc?.status}get isRejected(){return"rejected"===this.ugc?.status}get isDeleted(){return Boolean(this.ugc?.is_deleted)}get isClaimed(){return Boolean(this.ugc?.is_claimed)}get popupLayers(){return this.base?.popup?.layers}constructor(e){e&&("id"in e?this.ugc=e:"sticker_id"in e&&(this.base=e))}}function s(...e){return new r(...e)}},722257:(e,t,i)=>{i.d(t,{BaseUrlBuilder:()=>o,BaseUrlImageVariant:()=>a,Theme:()=>r});var r,s,a,n=i(75856);!function(e){e.LIGHT="light",e.DARK="dark"}(r||(r={})),function(e){e.PNG="png"}(s||(s={})),function(e){e.SQUARE="square"}(a||(a={}));class o{setSize(e){return this.size=e,this}setTheme(e){return this.theme=e,this}setFormat(e){return this.format=e,this}setImageId(e){return this.imageId=e,this}setDefaultConfigId(e){return this.defaultConfigId=e,this}setImages(e){return this.images=e,this}setConfigs(e){return this.configs=e,this}setConfigContext(e){return this.configContext=e,this}build(){return this.images?this.findImage():this.configContext||this.configs?.length?this.buildBaseUrl():void 0}static build({config:e,variant:t,size:i,retinaSize:r,format:s=o.DEFAULT_FORMAT}){if(!e)return"";const{base_url:a,version:c}=e;r&&n.PIXEL_RATIO>n.DEFAULT_PIXEL_RATIO&&(i=r);return`${a}/${t}${i>1?`_${i}x`:""}.${s}${void 0!==c?`?${c}`:""}`}get retinaSize(){return this.upscale?Number(this.size)*n.PIXEL_RATIO:Number(this.size)}static getAnimation({type:e,animations:t}){return t?.find((t=>t.type===e))}findImage(){const e=this.retinaSize;return this.images?.find((t=>t.theme===this.theme&&(t.height>=e||t.width>=e)))?.url||this.images?.[this.images.length-1]?.url}buildBaseUrl(){const{config_id:e}=this.configContext||{},t=this.configs?.find((({id:t})=>t===e||t===this.defaultConfigId));if(!t)return this.findImage();const{pattern:i,sizes:r,theme_modifiers:s}=t;return i.replace(/{([^]+?)}/g,((e,t)=>{switch(t){case"image_id":return this.getImageIdModifier();case"size":return this.getSizeModifier(r);case"version":return this.getVersionModifier();case"theme_modifier":return this.getCommonModifier(s,this.theme);case"format":return this.getCommonModifier(this.formatModifiers,this.format)}return""}))}getImageIdModifier(){return String(this.imageId)}getSizeModifier(e){const t=this.retinaSize,i=e.find((({width:e,height:i})=>e>=t||i>=t));if(!i)return String(t);const{modifier:r,format_modifiers:s}=i;return this.formatModifiers=s,r}getVersionModifier(){const e=this.configContext?.version;return e?String(e):""}getCommonModifier(e,t){const i=e?.find((({id:e})=>e===t));if(!i)return"";const{modifier:r}=i;return r}constructor({size:e,theme:t,format:i,upscale:a,imageId:n,defaultConfigId:c,images:l,configs:d,configContext:u}){this.format=o.DEFAULT_FORMAT,this.upscale=!0,this.size=e,this.theme=t||r.LIGHT,this.format=i||s.PNG,this.imageId=n,this.defaultConfigId=c,void 0!==a&&(this.upscale=a),l?.[0]?.theme&&(l=l.sort((({theme:e},{theme:i})=>Number(e===t)-Number(i===t)))),this.images=l,this.configs=d,this.configContext=u}}o.DEFAULT_FORMAT=s.PNG},42762:(e,t,i)=>{function r(e,t,i){return Math.max(t,Math.min(e,i))}i.d(t,{clamp:()=>r})},75856:(e,t,i)=>{i.d(t,{DEFAULT_PIXEL_RATIO:()=>s,PIXEL_RATIO:()=>a});var r=i(42762);const s=1,a=Math.ceil((0,r.clamp)(window.devicePixelRatio,1,2))}}]);try{stManager.done("dist/web/chunks/sticker-lib.31bb0b4a.js")}catch(e){}