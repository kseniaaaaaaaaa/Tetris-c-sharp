"use strict";(self.webpackChunkvkweb=self.webpackChunkvkweb||[]).push([[86365],{81483:(_,e,t)=>{t.d(e,{Icon24Bookmark:()=>i});var i=(0,t(28178).makeIcon)("Icon24Bookmark","bookmark_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24" id="bookmark_24"><path fill-rule="evenodd" d="M11.083 3h1.834c1.056 0 1.903 0 2.588.056.704.058 1.316.179 1.88.466a4.8 4.8 0 0 1 2.093 2.093c.287.564.409 1.176.466 1.88C20 8.18 20 9.027 20 10.083v7.615c0 .773 0 1.414-.046 1.914-.044.494-.144 1.026-.481 1.454a2.46 2.46 0 0 1-1.896.935c-.544.007-1.027-.238-1.447-.503-.423-.268-.933-.658-1.546-1.128l-1.617-1.24c-.607-.466-.714-.526-.797-.549a.66.66 0 0 0-.34 0c-.083.023-.19.083-.797.549l-1.617 1.24c-.613.47-1.123.86-1.546 1.128-.42.265-.903.51-1.447.503a2.46 2.46 0 0 1-1.896-.936c-.337-.427-.437-.96-.482-1.453C4 19.112 4 18.47 4 17.698v-7.615c0-1.056 0-1.903.056-2.588.057-.704.179-1.316.466-1.88a4.8 4.8 0 0 1 2.093-2.093c.564-.287 1.176-.408 1.88-.466C9.18 3 10.027 3 11.083 3" clip-rule="evenodd" /></symbol>',24,24,!1,void 0)},312048:(_,e,t)=>{t.d(e,{Icon24BookmarkCheckOutline:()=>i});var i=(0,t(28178).makeIcon)("Icon24BookmarkCheckOutline","bookmark_check_outline_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24" id="bookmark_check_outline_24"><path d="M8.641 4.85c.57-.047 1.293-.05 2.308-.05a.9.9 0 0 0 0-1.8c-.992 0-1.797.001-2.454.055-.704.058-1.316.179-1.88.466a4.8 4.8 0 0 0-2.093 2.093c-.287.564-.409 1.176-.466 1.88C4 8.179 4 9.027 4 10.082v7.616c0 .771 0 1.413.045 1.913.045.492.145 1.026.482 1.454A2.46 2.46 0 0 0 6.423 22c.545.007 1.029-.239 1.447-.503.424-.267.933-.658 1.546-1.128l1.617-1.24a13 13 0 0 1 .595-.44.7.7 0 0 1 .202-.109.66.66 0 0 1 .34 0c.042.012.09.033.202.108.113.076.291.208.595.44l1.618 1.241c.612.47 1.121.86 1.545 1.128.418.264.902.51 1.447.503a2.46 2.46 0 0 0 1.896-.935c.337-.428.437-.962.482-1.454.045-.5.045-1.142.045-1.914v-3.075a.9.9 0 0 0-1.8 0v3.075c0 .805-.002 1.352-.038 1.75a2.3 2.3 0 0 1-.067.411.4.4 0 0 1-.036.093.66.66 0 0 1-.506.249c.008 0-.017.003-.095-.027a2.3 2.3 0 0 1-.366-.198c-.339-.213-.774-.545-1.412-1.035l-1.618-1.24c-.302-.231-.52-.394-.684-.504a2.4 2.4 0 0 0-.743-.355 2.46 2.46 0 0 0-1.27 0 2.4 2.4 0 0 0-.743.355c-.164.11-.382.273-.684.504L8.32 18.94c-.638.49-1.073.822-1.412 1.035a2.3 2.3 0 0 1-.366.197.4.4 0 0 1-.096.028.66.66 0 0 1-.505-.25.4.4 0 0 1-.036-.092 2.3 2.3 0 0 1-.067-.41c-.036-.4-.038-.946-.038-1.751v-7.614c0-1.084.001-1.847.05-2.443.048-.592.14-.941.276-1.209a3 3 0 0 1 1.306-1.306c.268-.137.617-.228 1.21-.276Z" /><path fill-rule="evenodd" d="M18 1.999a5 5 0 1 0 0 10 5 5 0 0 0 0-10m2.78 3.22a.75.75 0 0 0-1.06 0l-2.47 2.47-.97-.97a.75.75 0 1 0-1.06 1.06l1.5 1.5a.75.75 0 0 0 1.06 0l3-3a.75.75 0 0 0 0-1.06" clip-rule="evenodd" /></symbol>',24,24,!1,void 0)},921774:(_,e,t)=>{t.d(e,{Icon24Broadcast:()=>i});var i=(0,t(28178).makeIcon)("Icon24Broadcast","broadcast_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" id="broadcast_24"><path fill="currentColor" d="M5.491 3.698a1 1 0 0 1-.033 1.414l-.033.03-.02.02A9.47 9.47 0 0 0 2.5 12a9.47 9.47 0 0 0 2.935 6.867 1 1 0 1 1-1.383 1.445A11.47 11.47 0 0 1 .5 12c0-3.163 1.284-6.123 3.516-8.276l.026-.025.035-.034a1 1 0 0 1 1.414.033m13.018 0a1 1 0 0 1 1.414-.033l.035.034.026.025A11.47 11.47 0 0 1 23.5 12c0 3.18-1.299 6.157-3.552 8.312a1 1 0 1 1-1.383-1.446A9.47 9.47 0 0 0 21.5 12a9.47 9.47 0 0 0-2.904-6.837l-.021-.02-.033-.031a1 1 0 0 1-.033-1.414M8.838 7.094a1 1 0 0 1-.057 1.413A4.73 4.73 0 0 0 7.25 12c0 1.345.56 2.598 1.53 3.492a1 1 0 0 1-1.356 1.47A6.73 6.73 0 0 1 5.25 12c0-1.91.799-3.694 2.175-4.963a1 1 0 0 1 1.413.057m6.324 0a1 1 0 0 1 1.413-.057A6.73 6.73 0 0 1 18.75 12c0 1.91-.798 3.693-2.174 4.962a1 1 0 1 1-1.356-1.47A4.73 4.73 0 0 0 16.75 12c0-1.345-.56-2.598-1.53-3.493a1 1 0 0 1-.058-1.413M12 9.75a2.25 2.25 0 1 1 0 4.5 2.25 2.25 0 0 1 0-4.5" /></symbol>',24,24,!1,void 0)},876625:(_,e,t)=>{t.d(e,{Icon24Repeat1Outline:()=>i});var i=(0,t(28178).makeIcon)("Icon24Repeat1Outline","repeat_1_outline_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" id="repeat_1_outline_24"><g fill="currentColor"><path fill-rule="evenodd" d="M12.475 9.132a.9.9 0 0 1 .429.766V14.1a.9.9 0 0 1-1.8 0v-2.74a.9.9 0 0 1-.807-1.609l1.3-.656a.9.9 0 0 1 .878.037" clip-rule="evenodd" /><path d="M2.005 12c0-3.258 2.642-5.9 5.902-5.9h10.026l-.564-.564a.9.9 0 1 1 1.273-1.272l2.1 2.1a.9.9 0 0 1 0 1.272l-2.1 2.1a.9.9 0 0 1-1.273-1.272l.564-.564H7.907A4.1 4.1 0 0 0 3.805 12v.097a.9.9 0 0 1-1.8 0zM21.104 11.003a.9.9 0 0 1 .9.9V12c0 3.259-2.642 5.9-5.902 5.9H6.074l.564.564a.9.9 0 1 1-1.273 1.272l-2.101-2.1a.9.9 0 0 1 0-1.272l2.1-2.1a.9.9 0 0 1 1.274 1.272l-.564.564h10.029a4.1 4.1 0 0 0 4.101-4.1v-.097a.9.9 0 0 1 .9-.9" /></g></symbol>',24,24,!1,void 0)},257405:(_,e,t)=>{t.d(e,{Icon24RepeatOutline:()=>i});var i=(0,t(28178).makeIcon)("Icon24RepeatOutline","repeat_outline_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" id="repeat_outline_24"><g fill="currentColor"><path d="M2.005 12c0-3.258 2.642-5.9 5.902-5.9h10.026l-.564-.564a.9.9 0 1 1 1.273-1.272l2.1 2.1a.9.9 0 0 1 0 1.272l-2.1 2.1a.9.9 0 0 1-1.273-1.272l.564-.564H7.907A4.1 4.1 0 0 0 3.805 12v.097a.9.9 0 0 1-1.8 0zM21.104 11.003a.9.9 0 0 1 .9.9V12c0 3.258-2.642 5.9-5.901 5.9H6.074l.564.564a.9.9 0 1 1-1.273 1.272l-2.101-2.1a.9.9 0 0 1 0-1.272l2.1-2.1a.9.9 0 0 1 1.274 1.272l-.564.564h10.029a4.1 4.1 0 0 0 4.101-4.1v-.097a.9.9 0 0 1 .9-.9" /></g></symbol>',24,24,!1,void 0)},912766:(_,e,t)=>{t.d(e,{Icon24ShuffleOutline:()=>i});var i=(0,t(28178).makeIcon)("Icon24ShuffleOutline","shuffle_outline_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" id="shuffle_outline_24"><g fill="currentColor"><path d="M2.896 6.1a.9.9 0 0 0 0 1.8c2.631 0 4.501 1.612 6.384 3.705-1.007 1.183-1.951 2.278-2.973 3.107C5.23 15.586 4.14 16.1 2.901 16.1a.9.9 0 0 0 0 1.8c1.791 0 3.27-.76 4.54-1.79 1.097-.89 2.094-2.03 3.035-3.133.952 1.11 1.951 2.264 3.049 3.158 1.248 1.017 2.7 1.765 4.475 1.765h.927l-.563.564a.9.9 0 1 0 1.272 1.272l2.1-2.1a.9.9 0 0 0 0-1.272l-2.1-2.1a.9.9 0 1 0-1.272 1.272l.563.564H18c-1.224 0-2.286-.502-3.338-1.36-.997-.812-1.917-1.883-2.92-3.052l-.237-.275C9.396 8.962 6.865 6.1 2.896 6.1" /><path d="M12.318 8.408C13.805 7.16 15.701 6.1 18 6.1h.927l-.563-.564a.9.9 0 1 1 1.272-1.272l2.1 2.1a.9.9 0 0 1 0 1.272l-2.1 2.1a.9.9 0 0 1-1.272-1.272l.563-.564H18c-1.717 0-3.215.787-4.524 1.886a.9.9 0 1 1-1.158-1.378" /></g></symbol>',24,24,!1,void 0)},96010:(_,e,t)=>{t.d(e,{Icon24StarsOutline:()=>i});var i=(0,t(28178).makeIcon)("Icon24StarsOutline","stars_outline_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" id="stars_outline_24"><g fill="currentColor"><path fill-rule="evenodd" d="M14.005 10.444c-.367.761-.836 1.532-1.432 2.128-.597.597-1.368 1.066-2.129 1.433.761.367 1.532.836 2.129 1.432.596.597 1.064 1.366 1.432 2.126.368-.76.836-1.53 1.433-2.126.596-.596 1.365-1.064 2.125-1.432-.76-.368-1.529-.836-2.125-1.433-.597-.596-1.065-1.367-1.433-2.128m-.946-2.463c-.434 1.28-1.02 2.579-1.76 3.319-.739.74-2.037 1.325-3.317 1.759a22 22 0 0 1-1.449.437l-.247.066c-.381.098-.381.788 0 .886l.247.066a25 25 0 0 1 1.449.437c1.28.434 2.578 1.02 3.318 1.76.74.739 1.325 2.033 1.759 3.31q.078.23.15.458a25 25 0 0 1 .353 1.233c.099.38.787.38.886 0a25 25 0 0 1 .504-1.692c.434-1.276 1.019-2.57 1.758-3.31s2.034-1.325 3.31-1.759q.231-.078.459-.15a25 25 0 0 1 1.233-.353c.381-.099.381-.787 0-.886a26 26 0 0 1-1.691-.503c-1.277-.435-2.571-1.02-3.31-1.76-.74-.739-1.326-2.037-1.76-3.317a25.117 25.117 0 0 1-.503-1.695c-.098-.382-.788-.382-.886 0a25 25 0 0 1-.503 1.694" clip-rule="evenodd" /><path d="M6.426 2.318a.47.47 0 0 0-.892 0l-.52 1.558a1.8 1.8 0 0 1-1.138 1.139l-1.558.52a.47.47 0 0 0 0 .89l1.554.519a1.8 1.8 0 0 1 1.14 1.145l.522 1.584a.47.47 0 0 0 .893 0l.52-1.58a1.8 1.8 0 0 1 1.146-1.147l1.58-.52a.47.47 0 0 0 0-.893l-1.584-.52a1.8 1.8 0 0 1-1.145-1.141z" /></g></symbol>',24,24,!1,void 0)},985721:(_,e,t)=>{t.d(e,{Icon24TextTtOutline:()=>i});var i=(0,t(28178).makeIcon)("Icon24TextTtOutline","text_tt_outline_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" id="text_tt_outline_24"><g fill="currentColor"><path d="M7.1 6.8h1.8v11.3a.9.9 0 1 1-1.8 0zM2 5.9a.9.9 0 0 1 .9-.9h10.2a.9.9 0 1 1 0 1.8H2.9a.9.9 0 0 1-.9-.9M12 9.9a.9.9 0 0 1 .9-.9h8.2a.9.9 0 1 1 0 1.8h-8.2a.9.9 0 0 1-.9-.9" /><path d="M16.1 10.796h1.8V18.1a.9.9 0 1 1-1.8 0z" /></g></symbol>',24,24,!1,void 0)},656252:(_,e,t)=>{t.d(e,{Icon24ThumbsDown:()=>i});var i=(0,t(28178).makeIcon)("Icon24ThumbsDown","thumbs_down_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24" id="thumbs_down_24"><path fill-rule="evenodd" d="M20.105 4a.896.896 0 0 0-.896.896v10.208a.896.896 0 1 0 1.791 0V4.896A.896.896 0 0 0 20.105 4m-3.496 11.818-1.954 4.089A1.922 1.922 0 0 1 11 19.078v-2.784a.294.294 0 0 0-.294-.294H6.002c-2.09 0-3.539-2.082-2.814-4.041l2.221-6A3 3 0 0 1 8.223 4H14a3 3 0 0 1 3 3v7.093a4 4 0 0 1-.39 1.725Z" clip-rule="evenodd" /></symbol>',24,24,!1,void 0)},697430:(_,e,t)=>{t.d(e,{Icon24ThumbsDownOutline:()=>i});var i=(0,t(28178).makeIcon)("Icon24ThumbsDownOutline","thumbs_down_outline_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24" id="thumbs_down_outline_24"><path d="M20.1 3a.9.9 0 0 0-.9.9v10.2a.9.9 0 1 0 1.8 0V3.9a.9.9 0 0 0-.9-.9m-7.233 19a2.87 2.87 0 0 0 2.58-1.618l2.064-4.265A4.9 4.9 0 0 0 18 13.983V6.9A3.9 3.9 0 0 0 14.1 3H8.19a3.9 3.9 0 0 0-3.658 2.55l-2.287 6.2c-.94 2.547.945 5.25 3.66 5.25H10v2.133A2.867 2.867 0 0 0 12.867 22m.96-2.402a1.067 1.067 0 0 1-2.027-.465v-2.739c0-.66-.535-1.194-1.194-1.194H5.904a2.1 2.1 0 0 1-1.97-2.827l2.287-6.2A2.1 2.1 0 0 1 8.19 4.8h5.91c1.16 0 2.1.94 2.1 2.1v7.083a3.1 3.1 0 0 1-.31 1.35z" clip-rule="evenodd" /></symbol>',24,24,!1,void 0)},257582:(_,e,t)=>{t.d(e,{default:()=>i});const i={link:"AudioRecomsIconLink-module__link--VU1O5"}},972520:(_,e,t)=>{t.d(e,{default:()=>i});const i={header:"styles-module__header--aAME2",content:"styles-module__content--xBzRu",actions:"styles-module__actions--jD0Ou"}},896669:(_,e,t)=>{function i(){return{icon:'<svg fill="none" height="8" viewBox="0 0 12 8" width="12" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M2.16 2.3a.75.75 0 0 1 1.05-.14L6 4.3l2.8-2.15a.75.75 0 1 1 .9 1.19l-3.24 2.5c-.27.2-.65.2-.92 0L2.3 3.35a.75.75 0 0 1-.13-1.05z" fill="currentColor" fill-rule="evenodd"/></svg>',name:"dropdown_12"}}t.d(e,{getIcon12Dropdown:()=>i})},984124:(_,e,t)=>{function i(){return{icon:'<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g id="playlist_24__Page-2" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="playlist_24__playlist_24"><path id="playlist_24__Shape" d="M0 0h24v24H0z"/><path d="M13 6.88c0-.48-.4-.88-.88-.88H2.88C2.4 6 2 6.4 2 6.88v.24c0 .48.4.88.88.88h9.24c.49 0 .88-.4.88-.88v-.24Zm0 4c0-.48-.4-.88-.88-.88H2.88c-.49 0-.88.4-.88.88v.24c0 .48.4.88.88.88h9.24c.49 0 .88-.4.88-.88v-.24ZM2 15.12v-.24c0-.48.4-.88.88-.88h4.23c.5 0 .89.4.89.88v.24c0 .48-.4.88-.89.88H2.88c-.49 0-.88-.4-.88-.88Zm15 .7c0 3.74-.99 4.64-3.77 5.13-1.48.26-3.23-.48-3.23-2.8 0-1.15.72-2.23 2.2-2.51 1.12-.22-.43.05 2.12-.42.62-.12.69-.34.69-.81L15 12.56V5.98c0-1.1.83-1.5 2.6-1.85 0 0 2.34-.34 3.82-.61.33-.06.58.06.58.44V7.4c0 .37-.15.54-.53.6-1.5.27-3.99.65-3.99.65-.33.08-.48.32-.48.65v6.51Z" id="playlist_24__Mask" fill="currentColor"/></g></g></svg>',name:"playlist_24"}}t.d(e,{getIcon24Playlist:()=>i})},364865:(_,e,t)=>{function i(){return{icon:'<svg width="56" height="56" viewBox="0 0 56 56" xmlns="http://www.w3.org/2000/svg"><g id="playlist_outline_56__Icons-56/playlist_outline_56" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="playlist_outline_56__playlist_outline_28"><path id="playlist_outline_56__playlist_outline_56" d="M0 0h56v56H0z"/><path d="M39 38.93c0 4.55-1.94 7.97-5.07 9.62-2.84 1.5-6.24 1.22-8.22-.76-2.04-2.04-2.3-5.5-.58-8.3C27 36.44 30.77 34.61 36 34.5V16.76a6.88 6.88 0 0 1 5.03-6.68c1.08-.36 3.24-.92 6.5-1.67l1.64-.37A1.5 1.5 0 0 1 51 9.5v4.2a6.7 6.7 0 0 1-4.97 6.48L39 22.05Zm-3-1.42h-.4c-4 .18-6.67 1.53-7.91 3.54-1.02 1.66-.88 3.6.14 4.62.98.98 2.96 1.14 4.7.22 2.12-1.11 3.47-3.5 3.47-6.96V37.5ZM27.5 22a1.5 1.5 0 0 1 0 3h-19a1.5 1.5 0 0 1 0-3h19ZM48 11.38a83.8 83.8 0 0 0-6.03 1.54l-.21.08c-1.93.71-2.8 2.05-2.76 4.33v1.62l6.25-1.67A3.7 3.7 0 0 0 48 13.71ZM30.5 10a1.5 1.5 0 0 1 0 3h-22a1.5 1.5 0 0 1 0-3h22Z" id="playlist_outline_56__Icon-Color" fill="currentColor" fill-rule="nonzero"/></g></g></svg>',name:"playlist_outline_56"}}t.d(e,{getIcon56PlaylistOutline:()=>i})},376710:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{AudioPage:()=>AudioPage,currentAudioPage:()=>currentAudioPage});var _shared_evbus__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(234173),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(15042),_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(30655),_web_lib_fx__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(97875),_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(802130),_shared_lib_date__WEBPACK_IMPORTED_MODULE_58__=__webpack_require__(41585),_shared_audio_formatters_formatAudioTime__WEBPACK_IMPORTED_MODULE_57__=__webpack_require__(266842),_web_lib_layout_utils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(330),_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(251087),_web_lib_scroll__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(255693),_web_lib_stats__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(762003),_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(93367),_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(847441),_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(463806),_web_audio_player_stat_onAdditionalEvent__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(860129),_web_auto_list_auto_list__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(591063),_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(324819),_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(902947),_web_legacy_ui_ui_scroll__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(190328),_web_legacy_ui_slider__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(673067),_web_lib_feature_boxes__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(128907),_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(70689),_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(159663),_web_indexer_indexer__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(274851),_web_lib_utils__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(43129),_web_grid_sorted__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(618030),_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(488844),_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(877926),_web_lib_feature_tooltips__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(401014),_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(585703),_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(954314),_shared_audio_enums__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(854942),_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(636322),_web_audio_catalog_CatalogController__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__(286450),_web_audio_components_FullscreenBanner__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__(716434),_icons_desktop__WEBPACK_IMPORTED_MODULE_51__=__webpack_require__(364865),_icons_desktop__WEBPACK_IMPORTED_MODULE_52__=__webpack_require__(84462),_icons_desktop__WEBPACK_IMPORTED_MODULE_53__=__webpack_require__(81069),_icons_desktop__WEBPACK_IMPORTED_MODULE_54__=__webpack_require__(410181),_icons_desktop__WEBPACK_IMPORTED_MODULE_55__=__webpack_require__(984124),_icons_desktop__WEBPACK_IMPORTED_MODULE_56__=__webpack_require__(256993),_icons_desktop__WEBPACK_IMPORTED_MODULE_59__=__webpack_require__(896669),_web_components_ui_gallery__WEBPACK_IMPORTED_MODULE_33__=__webpack_require__(612291),_vkontakte_vkjs__WEBPACK_IMPORTED_MODULE_34__=__webpack_require__(659397),_shared_audio_utils_isRadio__WEBPACK_IMPORTED_MODULE_35__=__webpack_require__(921085),_shared_audio_utils_getAudioExtra__WEBPACK_IMPORTED_MODULE_36__=__webpack_require__(104799),_player_radiostation_unfollowRadiostation__WEBPACK_IMPORTED_MODULE_37__=__webpack_require__(814938),_player_radiostation_followRadiostation__WEBPACK_IMPORTED_MODULE_38__=__webpack_require__(676693),_shared_audioplayer_AudioPlayerAdapter_audioTuple_audioTupleToAudioObject__WEBPACK_IMPORTED_MODULE_39__=__webpack_require__(26543),_web_audio_components_AutoplayBlock__WEBPACK_IMPORTED_MODULE_40__=__webpack_require__(444477),_web_audio_ui_AudioAdActionsModal_AudioAdActionsModalController__WEBPACK_IMPORTED_MODULE_41__=__webpack_require__(637381),_shared_ranges__WEBPACK_IMPORTED_MODULE_42__=__webpack_require__(184132),_shared_lib_js_logger__WEBPACK_IMPORTED_MODULE_43__=__webpack_require__(65718),_web_audio_player_playlist_addAudioPlaylistToMyAudioPlaylists__WEBPACK_IMPORTED_MODULE_44__=__webpack_require__(130075),_web_audio_services_AudioPage__WEBPACK_IMPORTED_MODULE_45__=__webpack_require__(424596),_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__=__webpack_require__(977053),_AudioCatalogVkMixBlockTq__WEBPACK_IMPORTED_MODULE_47__=__webpack_require__(139301),_web_audio_services_AudioLongtap_AudioLongtapTooltip__WEBPACK_IMPORTED_MODULE_48__=__webpack_require__(258334),_AudioPlayerBlockTq__WEBPACK_IMPORTED_MODULE_49__=__webpack_require__(587896),_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_50__=__webpack_require__(602842);const SLIDER_TIMEOUT=1e4;let sectionsToUpdate=[];function currentAudioPage(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.gpeByClass)("_audio_page_layout",_);return!!e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)(e,"audioPage")}function AudioPage(_,e){const t=_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_50__.AudioPageProxy.ensure();(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)(_,"audioPage",this),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.extend)(cur.lang||{},e.langs),(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().langs=e.langs,this._data=e,this._ownerId=e.ownerId,e.playlists&&e.playlists.length&&(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().addWithReplacePlaylists(e.playlists.filter(Boolean)),this.isLayer()||(cur.audioPage=this,(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("audio_longtap_web")&&_web_audio_services_AudioLongtap_AudioLongtapTooltip__WEBPACK_IMPORTED_MODULE_48__.AudioLongtapTooltip.ensure().getHints()),this.isLayer()&&uiSearch.init("audio_search_layer"),_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.toggleAudioHQBodyClass(),this._els={pageContainer:_,sections:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_sections",_),playerWrap:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_player_wrap",_),player:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_player",_),contentBlock:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_content_block",_),scrollWrap:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_content_block_wrap",_),searchSectionAudios:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_search__local_audios_list",_),searchSectionAudiosHeader:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_section_search__local_audios_header",_),searchSectionPlaylists:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_search__local_playlists_list",_),searchSectionPlaylistsHeader:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_search__local_playlists_header",_),searchNoLocalResults:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_local_no_results",_),searchGlobalBlocks:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_global_search__blocks",_),searchGlobalCommunitiesPlace:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_global_search__communities_place",_),searchGlobalPlaylistsPlace:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_global_search__playlists_place",_),searchGlobalArtistsPlace:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_global_search__artists_place",_),searchGlobalAudiosBlock:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_global_search__audios_block",_),searchGlobalAudiosBlockHeader:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_global_search__audios_header",_),searchGlobalAudiosList:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_global_search__audios_list",_),searchInput:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ui_search_field",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_search",_)),footer:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page__footer",_),footerNowPlayingInfo:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page__footer_now_playing",_),footerClearNowPlayingButton:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page__footer_clear_playlist",_)},this.isLayer()&&(this._scroll=new _web_legacy_ui_ui_scroll__WEBPACK_IMPORTED_MODULE_16__.default(this._els.scrollWrap,{global:!0,stopScrollPropagation:!0,stopScrollPropagationAlways:!0})),this._readyAudio=this._data.readyAudio;const i=this._data.readyPlaylist;i&&(this._pagePlaylist=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getPlaylist(i.type,i.ownerId,i.id),this._pagePlaylist.mergeWith(i)),!this._readyAudio&&this._pagePlaylist&&(this._readyAudio=this._pagePlaylist.getAudioAt(0)),this._data.playlistCoverUploadOptions&&(cur.audioCoverUploadOptions=cur.audioCoverUploadOptions||{},cur.audioCoverUploadOptions[this._ownerId]=this._data.playlistCoverUploadOptions),this.isLayer()||(cur.module=e.module||"audio",cur.oid=this._ownerId,+this._ownerId==+vk.id?cur.submodule="my":_shared_ranges__WEBPACK_IMPORTED_MODULE_42__.Ranges.isGroupId(this._ownerId)?cur.submodule="group_list":cur.submodule="user_list"),vk.id&&this._initPlayer(),this.initNavigation(),t.emitter.emit(_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_50__.AudioPageEventType.AudioRecomsOnboardingShowRequested,{reason:_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_50__.AudioRecomsOnboardingShowRequestedEventReason.AudioPageInit}),this.catalogController=new _web_audio_catalog_CatalogController__WEBPACK_IMPORTED_MODULE_31__.CatalogController(_),this.showSection(e.initSection,null,this._data.onlySkeleton),e.initSection||this.catalogController.initBlocksManually();const o=new URLSearchParams(location.search);this.defaultSection=!o.get("section")&&e.initSection||"general",this._initSearchParams(),this.promoAlbumSlideInit(),this._els.searchInput&&this._els.searchInput.focus(),this.isLayer()||this.isPodcastPage()||!nav.objLoc.q||"search_playlists"===nav.objLoc.section||this._els.searchInput&&(this._els.searchInput.value=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.winToUtf)(nav.objLoc.q),this._showSearchSection(nav.objLoc)),this.updateCurrentPlayingInfo(),(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().setStatusExportInfo(this._data.export),this.updateStatusExportControls(),this._initKeyEvents(),window.onAudioPageLoaded&&(window.onAudioPageLoaded.call(this),delete window.onAudioPageLoaded),this.updateShuffleButton(),this.loadMarketItemsCarousel(),t.emitter.emit(_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_50__.AudioPageEventType.Updated)}(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setStartupHandler("AudioPlayerBlock/init",_AudioPlayerBlockTq__WEBPACK_IMPORTED_MODULE_49__.AudioPlayerBlockTq),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setStartupHandler("AudioCatalogVkMixBlock/init",_AudioCatalogVkMixBlockTq__WEBPACK_IMPORTED_MODULE_47__.AudioCatalogVkMixBlockTq),AudioPage.address="audio",AudioPage.initedFromAudioTs=!1,AudioPage.updateSearchHighlight=function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_playlist",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.gpeByClass)("_audio_layout",this));(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(e,"audio_search_focused","focus"===_.type)},AudioPage.onSearchFocused=function(_){AudioPage.updateSearchHighlight(_)},AudioPage.prototype.updatePlaylistsCounter=function(_){if(cur.audioPage&&_===cur.audioPage.getOwnerId()){let _;if(_=cur.audioPage._els.pageContainer.querySelector(".CatalogBlock__own_only_playlists_header .CatalogBlock__title"),_){const e=cur.audioPage._data.playlists.length;_.innerHTML=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(e,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.curLang("audio_playlists_count_title")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.gpeByClass)("_audio_page_section_layout",_),"audio_section_empty",!e)}}},AudioPage.getCoverImage=function(_,e){let t="";if(_)t=`<img alt="${(0,_vkontakte_vkjs__WEBPACK_IMPORTED_MODULE_34__.escape)(e)}" width='143px' height='143px' src="${_}" loading='lazy' />`;else{const{icon:_}=(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_51__.getIcon56PlaylistOutline)();t=`<div class="audio_pl_cover_placeholder">${_}</div>`}return t},AudioPage.setCoverImageElem=function(_,e,t){if(e){const i=_.querySelector(".audio_pl_cover_placeholder"),o=_.querySelector("img");o&&_.removeChild(o),i&&_.removeChild(i);const s=new Image;s.src=e,s.setAttribute("alt",(0,_vkontakte_vkjs__WEBPACK_IMPORTED_MODULE_34__.escape)(t)),s.setAttribute("width","143px"),s.setAttribute("height","143px"),s.setAttribute("loading","lazy"),_.appendChild(s)}else{const e=_.querySelector("img");if(e){_.removeChild(e);const{icon:t}=(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_51__.getIcon56PlaylistOutline)(),i=document.createElement("div");i.classList.add("audio_pl_cover_placeholder"),i.innerHTML=t,_.appendChild(i)}}},AudioPage.deletePlaylist=function(_,e,t){const i=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_PLAYLIST,_,e);let o=AudioPlayer.getLang("audio_sure_delete_playlist_box_text");o=o.replace("{name}",i.getTitle()),o='<div style="overflow: hidden; text-overflow: ellipsis;">'+o+"</div>",(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.showFastBox)({title:AudioPlayer.getLang("audio_sure_delete_playlist_box_title")},o,AudioPlayer.getLang("audio_sure_delete_playlist_box_yes"),function(){ajax.post("al_audio.php?act=delete_playlist",{hash:t,playlist_owner_id:_,playlist_id:e,page_owner_id:cur.audioPage?cur.audioPage.getOwnerId():0},{onDone:function(_){if(cur.audioPage){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section__all",cur.audioPage.getPageContainer()),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_block__playlists_items",e);if(e&&t){const e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(t,"max-items"));if(_&&t.children.length<e){const{thumb:e,title:i}=_;_.cover_image=AudioPage.getCoverImage(e,i),t.appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.se)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.getTemplate)("audio_pl_item",_)))}t.children.length||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.addClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.gpeByClass)("_audio_page_section_layout",t),"no_playlists"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.re)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.gpeByClass)("_audio_page_titled_block",t)))}}},onFail:()=>!0});const i=(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.getBoxQueue)();if(i&&i.hideAll(!0),layers&&layers.fullhide&&layers.fullhide(),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass)("_audio_pl_"+_+"_"+e),(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.re)(this)})),window.location.pathname.includes(`/music/playlist/${window.vk.id}`))return window.history.length>2?void window.history.back():void document.location.replace(`https://${window.vk.apiConfigDomains.domain}/music?section=${cur.audioPage.defaultSection}`);if(cur.audioPage){if(cur.audioPage._data.playlists=cur.audioPage._data.playlists.filter((function(t){return!(t.id==e&&t.owner_id==_)})),!cur.audioPage._data.playlists.length)return void nav.reload();cur.audioPage.updatePlaylistsCounter&&cur.audioPage.updatePlaylistsCounter(_)}}.bind(this),_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_cancel"))},AudioPage.prototype.getCurrentSection=function(){return this._currentSection},AudioPage.prototype.getOwnerPlaylists=function(){return this._data.playlists},AudioPage.loadPlaylists=function(ownerId,totalCount,skipFirstChunk,forAttachBox,onDone){const chunkSize=50,chunks=[];(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.isFunction)(totalCount)&&(onDone=totalCount,totalCount=void 0,skipFirstChunk=!1),cur.playlistsCache=cur.playlistsCache||{};const cacheKey=ownerId+"_"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(skipFirstChunk);if(cur.playlistsCache[cacheKey])return onDone(cur.playlistsCache[cacheKey]);function onAllLoaded(){let _=[];(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)(chunks,(function(e,t){t&&(_=_.concat(t))})),cur.playlistsCache=cur.playlistsCache||{},cur.playlistsCache[cacheKey]=_,onDone&&onDone(_)}function _loadChunk(chunkIndex,_cb){const groupId=cur.group_id||(_shared_ranges__WEBPACK_IMPORTED_MODULE_42__.Ranges.isGroupId(cur.oid)?-cur.oid:0);ajax.post("al_audio.php?act=owner_playlists",{owner_id:ownerId,group_id:groupId,offset:chunkIndex*chunkSize,is_attach:forAttachBox?1:0},{onDone:function(playlists,totalCount,additionalData){additionalData.templates_script&&eval(additionalData.templates_script),additionalData.langs&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.extend)(cur.lang,additionalData.langs),additionalData.audio_playlist_cover_upload_options&&(cur.audioCoverUploadOptions=cur.audioCoverUploadOptions||{},cur.audioCoverUploadOptions[ownerId]=additionalData.audio_playlist_cover_upload_options),chunks[chunkIndex]=playlists,_cb(totalCount)},onFail:function(_){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(boxLoader),_)return(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.showFastBox)({title:_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_error")},_),!0}})}function _loadAllChunks(_,e,t){const i=Math.ceil(_/chunkSize);if(i&&i-e!=0){const _=new callHub(t,i-e);for(let t=e;t<i;t++)_loadChunk(t,(function(){_.done()}))}else t()}(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.isUndefined)(totalCount)?_loadChunk(0,(function(_){_loadAllChunks(_,1,onAllLoaded)})):_loadAllChunks(totalCount,skipFirstChunk?1:0,onAllLoaded)},AudioPage.prototype.getOwnerId=function(){return+this._ownerId},AudioPage.prototype.getPageContainer=function(){return this._els.pageContainer},AudioPage.prototype.getCurrentSectionEl=function(){return this.catalogController.currentSection&&this.catalogController.currentSection.getSectionElement()},AudioPage.prototype.reloadGeneralSectionData=function(_=null){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(boxLoader),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(boxLayerWrap),(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.boxRefreshCoords)(boxLoader),this.showSection("general",(()=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(boxLoader),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(boxLayerWrap),_?.()}),!1,!0)},AudioPage.prototype.canAddToGroup=function(){return this._data.canAudioAddToGroup},AudioPage.prototype.canEditGroup=function(){return this._data.canEdit},AudioPage.prototype.updateCurrentPlayingInfo=function(){if(!this.isLayer())return;const _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)(),e=_.getCurrentPlaylist();let t=e?e.getTitle():"";if(e&&null!==e.getTitleLang()&&window.langConfig&&window.langConfig.id!==e.getTitleLang()&&ajax.post("al_audio.php?act=get_playlist_info",{owner_id:e.getOwnerId(),playlist_id:e.getAlbumId(),access_hash:e.getAccessHash()},{onDone:t=>{e.updatePlaylist(t)&&(_.saveStateCurrentPlaylist(),this.updateCurrentPlayingInfo())},onFail:()=>{}}),t){let _=e.getOriginalPlaylistRawId();if(e.getBlockId()){t=`<a href="${`/audio?section=recoms_block&type=${e.getBlockId()}`}"\n                  class="audio_page__footer_now_playing_link">\n                  ${t}\n                </a>`}else if(_||e.getType()===_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_PLAYLIST&&0!==e.getAlbumId()){let i,o,s;_?(_=_.split("_"),i=_[0],o=_[1],s=_[2]||""):(i=e.getOwnerId(),o=e.getAlbumId(),s=e.getAccessHash()||"");t=`<a href="${nav.toStr((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.extend)({},nav.objLoc,{z:"audio_playlist"+i+"_"+o+(s?"/"+s:"")}))}"\n                  class="audio_page__footer_now_playing_link"\n                  onclick="if (checkEvent(event)) { return true } else { AudioUtils.showAudioPlaylist(${i}, ${o}, '${s}'); return cancelEvent(event) }">\n                  ${t}\n                </a>`}this._els.footerNowPlayingInfo.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_current_playing_from").replace("{playlist}",t)}else{const _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentAudio();if(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isPodcast(_)){const e=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_podcast_playing");this._els.footerNowPlayingInfo.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_current_playing_from").replace("{playlist}",e.replace("{name}",_[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_PERFORMER]))}else this._els.footerNowPlayingInfo.innerHTML=""}this._els.footerClearNowPlayingButton.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_clear_current_playlist"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggle)(this._els.footer,!!e)},AudioPage.prototype.onSearchFiltersChanged=function(_){const e=window.radioBtns["audio_search_type_"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(this.isLayer())],t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(this._searchSortFilter.selectedItems()[0][0]),i={performer:e.val?1:null,lyrics:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_fltr_with_lyrics",this._els.pageContainer),"on")?1:null,sort:t?1:null};this.syncParametersUI(i);let o=_&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.isObject)(_)?_:i;this.isLayer()&&(o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.extend)({},this._prevLoc,o)),nav.change(o,!1,{fromSearch:!0,filtersChanged:!0})},AudioPage.prototype._initSearchParams=function(){window.radioBtns["audio_search_type_"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(this.isLayer())]={els:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass)("_audio_search_type",this._els.pageContainer),keep:this.isLayer()};const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_fltr_sort",this._els.pageContainer);_&&(this._searchSortFilter=new window.Dropdown(_,this._data.sortFilters,{big:1,zeroPlaceholder:!0,onChange:this.onSearchFiltersChanged.bind(this)})),this.isLayer()||this.syncParametersUI(nav.objLoc)},AudioPage.prototype.syncParametersUI=function(_){const e="audio_search_type_"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(this.isLayer()),t=window.radioBtns[e];t&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.radiobtn)(t.els[_.performer?1:0],!!_.performer,e);const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_fltr_with_lyrics",this._els.pageContainer);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(i,"on",!!_.lyrics);const o={performer:AudioPlayer.getLang("audio_performers_only"),lyrics:AudioPlayer.getLang("audio_search_with_text"),sort:AudioPlayer.getLang("audio_search_by_length")},s=this._els.searchInput;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)(["performer","lyrics","sort"],(function(e,t){uiSearch.toggleFilter(s,t,o[t],!!_[t])}))},AudioPage.onFilterRemoved=function(_,e,t){const i=currentAudioPage(e);(function(){switch(_){case"performer":const _="audio_search_type_"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(this.isLayer()),e=window.radioBtns[_];(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.radiobtn)(e.els[0],0,_);break;case"sort":const t=this._searchSortFilter.options.defaultItems[0][0];this._searchSortFilter.selectItem(t,!1);break;case"lyrics":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_fltr_with_lyrics",this._els.pageContainer),"on")}t||this.onSearchFiltersChanged()}).apply(i)},AudioPage.prototype._showSearchSection=function(_){const e=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("audio_player_redesign_web_enabled")||(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("redesign_audio_player_tooltip_dislikes_web_enabled");this._toggleSearchProgress(!0);const t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_PLAYLIST,this.getOwnerId(),_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.DEFAULT_PLAYLIST_ID);if(e||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player2")){const e=_.globalQuery||_.q;this._sectionData={q:e,performer:_.performer};const t=void 0!==_.fromSuggestsAcceptId;t||(this._cur_qid=(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_8__.generateQID)()),this.showSection("search",function(){if(e){const i=this._data.sectionData.search?this._data.sectionData.search.qid:0;(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_8__.saveSearchAttemptStats)(_web_lib_stats__WEBPACK_IMPORTED_MODULE_8__.serviceAudio,0,!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.isVisible)(this._els.searchNoLocalResults),e,i,void 0,void 0,void 0,void 0,t&&_.fetchedQuery,void 0,void 0,_.fromSuggestsAcceptId)}this._toggleSearchProgress(!1)}.bind(this))}else t.loadAll(function(){this._toggleSearchProgress(!1),this._doShowSearchSection(_)}.bind(this))},AudioPage.prototype._toggleSearchProgress=function(_){this._els.searchInput&&!this._muteSearch&&(_?uiSearch.showProgress(this._els.searchInput):uiSearch.hideProgress(this._els.searchInput))},AudioPage.prototype._doShowSearchSection=function(_){const e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)();if(_&&(this._prevSearchParams=_),!(_=_||this._prevSearchParams))return;let t=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.replaceEntities)(_.q)+(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.replaceEntities)(_.globalQuery||"");(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)(["performer","lyrics","sort"],(function(e,i){t+=_[i]||0})),t+=this._ownerId,this._toggleSearchProgress(!0);const i=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_PLAYLIST,this._ownerId,_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.DEFAULT_PLAYLIST_ID);function o(){i.search(_,function(i){let o="";const s=this._data.playlistsIndex?this._data.playlistsIndex.search(_.q):[];if(this.showSection("search"),s.length){let _="";(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)(s,(function(e,t){t.cover_image=AudioPage.getCoverImage(t.thumb,t.title),_+=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.getTemplate)("audio_pl_item",t)})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(this._els.searchSectionPlaylistsHeader),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(this._els.searchSectionPlaylists),o=+this._ownerId===vk.id?e.langs.audio_found_your_local_playlists:_shared_ranges__WEBPACK_IMPORTED_MODULE_42__.Ranges.isUserId(this._ownerId)?e.langs.audio_found_user_local_playlists:e.langs.audio_found_group_local_playlists,this._els.searchSectionPlaylistsHeader.innerHTML=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(s.length,o),this._els.searchSectionPlaylists.innerHTML=_}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchSectionPlaylistsHeader),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchSectionPlaylists);const a=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_SEARCH,vk.id,(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_22__.hashCode)(t));a.mergeWith({list:i,searchParams:{globalQuery:_.globalQuery||_.q,performer:_.performer,lyrics:_.lyrics,sort:_.sort}}),a.setLocalFoundCount(i.length),i.length||s.length?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchNoLocalResults):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(this._els.searchNoLocalResults),o=vk.id===+this._ownerId?e.langs.audio_no_local_results:_shared_ranges__WEBPACK_IMPORTED_MODULE_42__.Ranges.isUserId(this._ownerId)?e.langs.audio_no_user_local_results:e.langs.audio_no_group_local_results,this._els.searchNoLocalResults.innerHTML=o.replace("{query}","<strong>"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.clean)(_.q)+"</strong>")),i.length||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchSectionAudiosHeader),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchSectionAudios)),this._pagePlaylist=a,this._toggleSearchProgress(!1)}.bind(this))}i.loadAll(function(){clearTimeout(this._onSilendLoadedTO),this._onSilendLoadedTO=setTimeout(function(){o.call(this)}.bind(this))}.bind(this))},AudioPage.prototype.showFriendMusic=function(_,e){return(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_4__.statlogsValueEvent)("audio_friends_block","click_friend"),this.isLayer()?nav.go({0:"/audios"+e},!1,{friendId:e}):nav.go("/audios"+e,_),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(_)},AudioPage.prototype._deinitNavigation=function(){cur.nav.pop(),this._navigationInited=!1},AudioPage.PageSections=["recoms_audio","recoms_block","search_block","recoms_personal","my"],AudioPage.followedRadioClassName="audio_page_player_follow_radiostation--followed";const layerSectionsToMainFrame=["search_block","search_playlists","recoms_block"];function isAdPlayingWithChoices(){const _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)();return _.ads.isActive&&!!_.ads.getCurrentAd()}function makeAudioAdMoreLink(){const _=document.createElement("a");return _.href="#",_.classList.add("audio_page_player_ad_more_link"),_.innerHTML=`${_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_audio_ad_more")} ${(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_59__.getIcon12Dropdown)().icon}`,_.addEventListener("click",(_=>{_.preventDefault();const{currentTarget:e}=_,t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)(),i=_web_audio_ui_AudioAdActionsModal_AudioAdActionsModalController__WEBPACK_IMPORTED_MODULE_41__.AudioAdActionsModalController.ensure();i.isOpen(e)?i.close(e):i.open(e,t.ads.getCurrentAd())})),_}function makeAudioDisableAdsLink(){const _=document.createElement("a");return _.href="/vk_music",_.classList.add("audio_page_player_ad_disable_link"),_.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_audio_ads_off"),AudioPage.initedFromAudioTs||(0,_shared_lib_js_logger__WEBPACK_IMPORTED_MODULE_43__.logError)(new Error("AudioPage inited bypassing entrypoint")),_.addEventListener("click",(_=>{_.preventDefault(),(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_4__.statlogsValueEvent)("audio_web_ad_link","click"),nav.go(_.currentTarget.href)})),_}function makeAudioAdPerformerDivider(){const _=document.createElement("span");return _.innerHTML=" · ",_.classList.add("audio_page_player_ad_performer_divider"),_}AudioPage.prototype.initNavigation=function(){this._navigationInited||this.isPodcastPage()||(this._navigationInited=!0,this._prevLoc={},!this.isLayer()&&nav.objLoc.popup&&"recoms_onboarding"===nav.objLoc.popup&&_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_50__.AudioPageProxy.ensure().emitter.emit(_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_50__.AudioPageEventType.AudioRecomsOnboardingShowRequested,{reason:_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_50__.AudioRecomsOnboardingShowRequestedEventReason.Navigation}),cur.nav.push(function(_,e,t,i){const o=this._ignoreResetedSearch;if(delete this._ignoreResetedSearch,o&&i.fromSearch)return!1;if(i.isLayer&&!this.isLayer())return!1;if(t.popup&&"recoms_onboarding"===t.popup)return _web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_50__.AudioPageProxy.ensure().emitter.emit(_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_50__.AudioPageEventType.AudioRecomsOnboardingShowRequested,{reason:_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_50__.AudioRecomsOnboardingShowRequestedEventReason.Navigation}),nav.setLoc(t),!1;if(t.screen)return;if(this.isLayer()&&!1!==this._prevLoc){e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.clone)(this._prevLoc),_=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.clone)(t);for(let i in e)e.hasOwnProperty(i)&&(e[i]&&void 0===t[i]?_[i]=!1:e[i]==t[i]&&delete _[i])}if(!_||!Object.keys(_).length)return;let s;if(this._deleteDeletedAudios(),this.isLayer()){s=!t.q&&!!e.q&&t.section===e.section?this.prevSection||this.defaultSection:t.section}else s=t.section||this.defaultSection;let a=!1;return 0===t[0].indexOf("podcasts")&&(s="podcast"),i.tab||i.fromSearch||!1===_.q&&1===Object.keys(_).length||i.searchPerformer?a=!1:i.friendId&&this.isLayer()?(s="friend",this.resetSection(s),this._sectionData={friend_id:i.friendId},a=!1):(2!==Object.keys(_).length||!1!==_.q||(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.isUndefined)(_[0]))&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.isUndefined)(_[0])?"signal"===t.section||"signal"===e.section?a=!0:((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.inArray)(_.section,AudioPage.PageSections)||_.hasOwnProperty("block")||(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.inArray)(e.section,AudioPage.PageSections)&&!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.inArray)(_.section,AudioPage.PageSections))&&(!this.isLayer()||layerSectionsToMainFrame.includes(t.section)||_.hasOwnProperty("block")?a=!0:(a=!1,this._sectionData={audio_id:_.audio_id},s="recoms",delete this._currentSection)):a=!0,a?(this.catalogController&&this.catalogController.destroy(),!0):(t.q?(this._els.searchInput&&!i.fromSearch&&(this._els.searchInput.value=t.q,(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.triggerEvent)(this._els.searchInput,"keyup",{},!0),this.lastQuery=t.q),this._showSearchSection((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.extend)({},t,i))):(this._ignoreResetedSearch=!1===_.q,this._els.searchInput&&uiSearch.reset(this._els.searchInput,!0),this.showSection(s),this._switchTab(s)),this.isLayer()?this._prevLoc=t:nav.setLoc(t),(i.back||i.hist||i.nav)&&this.syncParametersUI(t),!1)}.bind(this)))},AudioPage.prototype._deleteDeletedAudios=function(){_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.deleteDeletedAudios()},AudioPage.prototype._switchTab=function(_){if(this.isPodcastPage())return;const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_tab__"+_,this._els.pageContainer);e?uiTabs.switchTab((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domFC)(e)):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ui_tab_sel",this._els.pageContainer),"ui_tab_sel")},AudioPage.prototype.onLayerHide=function(){const _=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("audio_player_redesign_web_enabled")||(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("redesign_audio_player_tooltip_dislikes_web_enabled");this._deinitNavigation(),this._deinitKeyEvents(),this._onSectionOut(),delete this._currentSection,this._muteSearch=!0,(_||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player2"))&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchNoLocalResults),setTimeout((()=>uiSearch.reset(this._els.searchInput)),1e3)},AudioPage.prototype.updateLayerHeight=function(){let _=700;_=Math.min(_,window.innerHeight-150),_=Math.max(_,400),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.isVisible)(this._els.footer)&&(_-=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getSize)(this._els.footer)[1]),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(this._els.scrollWrap,{height:_}),this._els&&this._els.scrollWrap&&"function"==typeof this._els.scrollWrap.updateScroll&&this._els.scrollWrap.updateScroll()},AudioPage.prototype.scrollToCurrentTrack=function(){const _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentAudio(),e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getPlaylistQueue();if(this._audioRowsAutoList&&_&&e.indexOfAudio(_)>=0){let _=10;for(;_--;){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_CURRENT_CLS,this._audioRowsAutoList.getListEl());if(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getXY)(_)[1];this._scroll.scroller.scrollTop=e-(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_7__.scrollGetY)()-300,this._scroll.update(),this._layerStartInit=!1;break}this._audioRowsAutoList.drawMore(),(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().updateCurrentPlaying()}}},AudioPage.prototype.onLayerShow=function(_){this._layerStartInit=!0;const e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentPlaylist(),t=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isPodcast((0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentAudio());if(t)this.showSection("podcast");else if(e)this.showSection("current");else if(_){(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getPlaylistQueue().isEmpty()&&"current"===_?this.showSection("all"):this.showSection(_)}else this.showSection("all");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_tab__current",this._els.pageContainer),"unshown",!e||t),this.initNavigation(),this.updateCurrentPlayingInfo(),this._initKeyEvents(),this.updateLayerHeight(),this.updateShuffleButton(),this.scrollToCurrentTrack(),delete this._muteSearch},AudioPage.prototype.resetSection=function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section__"+_,this._els.sections);this.catalogController.deleteSection(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.re)(e)},AudioPage.prototype.isUpdateRequested=function(_){return Array.isArray(sectionsToUpdate)&&sectionsToUpdate.includes(_+this.getOwnerId())},AudioPage.prototype.requestUpdate=function(_,e=""){sectionsToUpdate=_.map((_=>_+e))},AudioPage.prototype.showSection=function(_,e,t,i){const o=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("audio_player_redesign_web_enabled")||(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("redesign_audio_player_tooltip_dislikes_web_enabled");!i&&this._currentSection&&this._currentSection!==this.prevSection&&(this.prevSection=this._currentSection),this.isPodcastPage()&&(_="podcast"),"search"!==this._currentSection||"all"!==_&&"current"!==_||uiSearch.reset(this._els.searchInput,!0),this._data.onlySkeleton||layers.fullhide&&layers.fullhide(),this._switchTab(_);const s=o||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player2")&&"search"===_||this.isUpdateRequested(_);if(!i&&this._currentSection===_&&"search"!==this._currentSection)return void((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.isFunction)(e)&&e());if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("search_audio_catalog_web")&&"search"===_&&!this.isLayer())return;this._currentSection=_;const a=this.findSectionElement(_),l=this._data.sectionData&&this._data.sectionData[_]||{};if(l.name=_,t||(this._data.onlySkeleton=!1),!i&&a&&(!s||!1===t)&&!this._data.onlySkeleton){if((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass)("_audio_section",this._els.pageContainer),(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this)})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchGlobalBlocks),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchGlobalCommunitiesPlace),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchGlobalPlaylistsPlace),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchGlobalArtistsPlace),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchGlobalAudiosBlock),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a),(o||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player2"))&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchNoLocalResults),"search"===_&&!a.innerHTML)){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(this._els.searchNoLocalResults);const _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)(),e=vk.id===+this._ownerId?_.langs.audio_no_local_results:_shared_ranges__WEBPACK_IMPORTED_MODULE_42__.Ranges.isUserId(this._ownerId)?_.langs.audio_no_user_local_results:_.langs.audio_no_group_local_results,t=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.winToUtf)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.clean)(l.searchParams?.globalQuery??""));this._els.searchNoLocalResults.innerHTML=e.replace("{query}","<strong>"+t+"</strong>")}if(this._onSectionOut(),delete cur._back,"podcast"!==_&&(this.catalogController.setSection(_,a,l||{}),!this.isLayer()&&_shared_ranges__WEBPACK_IMPORTED_MODULE_42__.Ranges.isUserId(window.vk.id)&&_web_audio_components_FullscreenBanner__WEBPACK_IMPORTED_MODULE_32__.FullscreenBanner.initiate(l.sectionId)),this._destroyAutoplayBlock(),this._onSectionOut((()=>{this.catalogController.disableSection(_)})),this.isLayer()||(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentPlaylist()||!l.title||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setDocumentTitle)(l.title),!["podcast","current"].includes(_))return(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.isFunction)(e)&&e(),void(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().updateCurrentPlaying();switch(_){case"current":this._initSection_current(a,l,!0);break;case"podcast":this._initSection_podcast(a,l)}return(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().updateCurrentPlaying(),void((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.isFunction)(e)&&e())}let n=this._ownerId,r=!1;if("podcast"===_&&!this.isPodcastPage()){const _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentAudio()||this._readyAudio;n=_[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID];(0,_shared_audio_utils_getAudioExtra__WEBPACK_IMPORTED_MODULE_36__.getAudioExtra)(_).voiceAssistant&&(r=!0)}if(this.isUpdateRequested(_)&&(sectionsToUpdate=null),r)return void setTimeout((()=>{const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.se)(`<div class="audio_section _audio_section _audio_section__${_} audio_section__${_} clear_fix audio_w_covers">\n        <div class="page_block audio_block">\n          <div class="audio_page__audio_rows _audio_page__audio_rows">\n            <div class="audio_page__audio_rows_list _audio_page__audio_rows_list audio_w_covers"></div>\n          </div>\n        </div>\n      </div>`);this._els.sections.appendChild(t),delete this._currentSection,this.showSection(_,e,!1)}));let d="",u={};if((i||this._data.onlySkeleton)&&l.sectionId)d="/audio?act=load_catalog_section",u.section_id=l.sectionId;else{d="al_audio.php";const e={act:"section",section:_,owner_id:n,is_layer:this.isLayer()?1:0,claim:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(nav.objLoc.claim)};"search"===_&&(e.query_id=this._cur_qid),u={...this._sectionData,...e}}ajax.post(d,u,{onDone:(t,i)=>{this._data.sectionData=this._data.sectionData||{};this.findSectionElement(_)&&t&&this.resetSection(_),this._data.sectionData[_]=i;const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.se)('<div class="audio_section _audio_section _audio_section__'+_+" audio_section__"+_+' clear_fix audio_w_covers">'+t+"</div>");this._els.sections.appendChild(o),delete this._currentSection,this.showSection(_,e,!1),this.scrollToAnchor()},onFail:()=>!0}),delete this._sectionData},AudioPage.prototype._onSectionOut=function(_){_?(this._onSectionOutCbs=this._onSectionOutCbs?this._onSectionOutCbs:[],this._onSectionOutCbs.push(_)):((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)(this._onSectionOutCbs||[],(function(_,e){e()})),this._onSectionOutCbs=[])},AudioPage.prototype.scrollToAnchor=function(){if(!(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("audio_page_anchor_scroll"))return;const _=window.location.hash;if(!_)return;const e=_.replace("#",""),t=document.getElementById(e),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getSize)("page_header")[1]||48,o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getSize)("playerWrap")[1]||56,s=window.innerWidth>999?o:0,a=t.getBoundingClientRect().top+window.scrollY-i-s;t&&setTimeout((()=>window.scrollTo({top:a,behavior:"smooth"})),50)},AudioPage.prototype.findSectionElement=function(_){const[e]=this._els.sections.getElementsByClassName("_audio_section__"+_);return e},AudioPage.prototype.onPlaylistsReorder=function(_,e,t){const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(_,"raw-id"),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(t,"raw-id");ajax.post("al_audio.php",{act:"reorder_playlist",owner_id:this.getOwnerId(),playlist_id:i.split("_")[1],prev_playlist_id:o?o.split("_")[1]:0,hash:this._data.reorderHash},{onFail:()=>!0})},AudioPage.prototype._initSection_current=function(_,e){(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.extend)(this._els,{audioRows:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page__audio_rows_list",_),audioRowsMore:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_more_rows",_),friendsBlock:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_friends_list_wrap",_),friendsBlockContent:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_friends_list_content",_)});const t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentPlaylist();if(!t&&!this.retriedCurrent)return this.retriedCurrent=!0,setTimeout((()=>this._initSection_current(_,e)));this.isLayer()&&(this._scroll=new _web_legacy_ui_ui_scroll__WEBPACK_IMPORTED_MODULE_16__.default(this._els.scrollWrap,{global:!0,stopScrollPropagation:!0,stopScrollPropagationAlways:!0})),t&&(this._pagePlaylist=t,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(this._els.audioRows,"playlist-id",t.getId()));const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_friends_search",_);i&&uiSearch.init(i),this._initAudioRowsAutoList(!0),setTimeout((()=>this._initFixedFriendsBlock(_)))},AudioPage.prototype.drawMore=function(){this._audioRowsAutoList&&this._audioRowsAutoList.drawMore()},AudioPage.prototype.scrollIntoView=function(_,e){this._scroll.scrollIntoView(_,e)},AudioPage.prototype._initSection_podcast=function(_,e){(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.extend)(this._els,{audioRows:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page__audio_rows_list",_),audioRowsMore:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("podcast_episodes_more",_)});let t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentPlaylist();if(!t){const _=e.playlistData;_&&(t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getPlaylist(_.type,_.ownerId,_.id),t.getAudiosCount()||(t.mergeWith(_),t.load()))}t&&(this._pagePlaylist=t,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(this._els.audioRows,"playlist-id",t.getId())),this._initAudioRowsAutoList(),this._data.reverse||this._enableAudioRowsSorter()},AudioPage.prototype.setPagePlaylist=function(_){this._pagePlaylist=_},AudioPage.prototype._initFixedFriendsBlock=function(){if(!this._els.friendsBlock)return;this._isFixed=!1,this._isDraggable=!1,this._initialPos=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getXY)(this._els.friendsBlock);const _=this.isLayer(),e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getSize)("page_header")[1],t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getSize)(this._els.playerWrap)[1],i=_?13:15;this._fixedThreshold=_?e+t+i:this._initialPos[1]-e-t-i;const o=_?this._scroll.scroller:window;if(this._fixedThreshold<0)return;(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(window,"resize",this._resizeHandler=()=>{this._initialPos=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getXY)(this._els.friendsBlock)}),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(o,"scroll",this._scrollHandler=()=>{this._moveFriendsBlock()});const s=this;AudioPage.onUpdateDraggablePosition=()=>{s._isDraggable=!0,s._moveFriendsBlock(),requestAnimationFrame((()=>s._isDraggable=!1))},AudioPage.forceFix=()=>{const _=s._els.friendsBlockContent.getBoundingClientRect();if(!(_.width>0&&_.height>0))return;const e=s.isLayer()?s._scroll.scroller.scrollTop:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_7__.scrollGetY)();s._els.friendsBlockContent.style.transform=`translate(0,${Math.max(0,e-s._fixedThreshold-9)}px)`,s._unfixedFriendsBlock()},this._onSectionOut((()=>{this._scrollHandler&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(o,"scroll",this._scrollHandler),this._resizeHandler&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(window,"resize",this._resizeHandler),this._fixedBlockScrollHandler&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(this._els.friendsBlockContent,"mousewheel",this._fixedBlockScrollHandler),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(this._els.friendsBlockContent,"audio_friends_fixed")}))},AudioPage.prototype._moveFriendsBlock=function(){const _=this.isLayer()?this._scroll.scroller.scrollTop:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_7__.scrollGetY)(),e=this._els.friendsBlockContent.getBoundingClientRect(),t=e.width>0&&e.height>0;this._isDraggable&&t?(this._els.friendsBlockContent.style.transform=`translate(0,${Math.max(0,_-this._fixedThreshold-9)}px)`,this._unfixedFriendsBlock()):(this._els.friendsBlockContent.style.transform="",_>this._fixedThreshold?this._fixedFriendsBlock():this._unfixedFriendsBlock())},AudioPage.prototype._fixedFriendsBlock=function(){this._isFixed||(this._initialPos=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getXY)(this._els.friendsBlock),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.addClass)(this._els.friendsBlock,"audio_friends_fixed"),this._isFixed=!0,this.isLayer()&&(this._fixedBlockScrollHandler=(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(this._els.friendsBlockContent,"mousewheel",(_=>(this._scroll.scroller.scrollTop=this._scroll.scroller.scrollTop+_.deltaY,(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(_))))))},AudioPage.prototype._unfixedFriendsBlock=function(){this._isFixed&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(this._els.friendsBlock,"audio_friends_fixed"),this._isFixed=!1,this._fixedBlockScrollHandler&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(this._els.friendsBlockContent,"mousewheel",this._fixedBlockScrollHandler))},AudioPage.prototype.playPlaylist=function(_,e,t,i){const o=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)(),s=o.getCurrentPlaylist(),a=o.getPlaylist(_,e,t);s&&s.equals(a)&&o.isPlaying()?o.pauseByButton():a.load(0,(function(){o.playList({audio:a.getAudiosList()[0],playlist:a,context:i})}))},AudioPage.prototype.playShuffledBlockPlaylist=function(_){const e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)(),t=e.getPlaylistByBlockId(_)||new _web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist({hasMore:!0,blockId:_});t.clean(),t.loadByBlockId("",(function(_){e.playShuffledList({audio:_.getAudiosList()[0],playlist:_,context:_.getContext()})}))},AudioPage.prototype.saveAsPlaylist=async function(_){const e=document.querySelector(".audio_page_save_as_playlist_button"),t=document.querySelector(".audio_page_save_as_playlist_button_text");e.disabled=!0;const i=document.querySelector("#audio_page_save_as_playlist_icon_create"),o=document.querySelector("#audio_page_save_as_playlist_icon_delete"),s=(0,_web_audio_services_AudioPage__WEBPACK_IMPORTED_MODULE_45__.ensureAudioPageMyAudioPlaylistsService)();s.setUserId(vk.id);const a=s.$myAudioPlaylistsIdentitiesMap.getState()[_];if(a){try{await s.deleteFx({blockId:_,id:a.id}),o.classList.add("audio_page_save_as_playlist_icon_hide"),i.classList.remove("audio_page_save_as_playlist_icon_hide"),t.textContent=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_save_as_playlist_button")}catch(_){console.error("[AudioPage saveAsPlaylist]",_)}finally{e.disabled=!1}return}const l=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getPlaylistByBlockId(_)||new _web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist({hasMore:!0,blockId:_});l.clean(),l.loadByBlockId("",(async function(a){try{await(0,_web_audio_player_playlist_addAudioPlaylistToMyAudioPlaylists__WEBPACK_IMPORTED_MODULE_44__.addAudioPlaylistToMyAudioPlaylists)(_,a,s),i.classList.add("audio_page_save_as_playlist_icon_hide"),o.classList.remove("audio_page_save_as_playlist_icon_hide"),t.textContent=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_save_as_playlist_delete_button")}catch(_){console.error("[AudioPage saveAsPlaylist]",_)}finally{e.disabled=!1}}))},AudioPage.prototype.playBlockPlaylist=function(_,e=null){const t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)(),i=t.getCurrentPlaylist(),o=t.getPlaylistByBlockId(_)||new _web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist({hasMore:!0,blockId:_});if(i&&i.equals(o)&&t.isPlaying())t.pauseByButton();else{const _=o.getContext()||e&&e.dataset.context||"";o.loadByBlockId("",(e=>{t.playList({audio:e.getAudiosList()[0],playlist:e,context:_})}))}},AudioPage.prototype.onAudioRowsReorder=function(_,e,t,i){const o=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)(),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(e,"full-id"),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(i,"full-id"),l=o.getPlaylistQueue(),n=this.getPageCurrentPlaylist();let r=(_?l:n).indexOfAudio(s),d=(_?l:n).indexOfAudio(a);a?d++:d=0,l.moveAudio(r,d),_&&o.saveStateCurrentPlaylist(),this.isPodcastPage()?ajax.post("al_podcasts.php",{act:"a_reorder_episodes",hash:this._data.audiosReorderHash,oid:this.getOwnerId(),episode_id:s?s.split("_")[1]:0,next_episode_id:a?a.split("_")[1]:0},{onFail:()=>!0}):_||ajax.post("al_audio.php",{act:"reorder_audios",hash:this._data.audiosReorderHash,owner_id:this.getOwnerId(),audio_id:s?s.split("_")[1]:0,next_audio_id:a?a.split("_")[1]:0},{onFail:()=>!0})},AudioPage.prototype._enableAudioRowsSorter=function(_){(this._data.audiosReorderHash||_)&&(this._audioRowsSorter&&this._audioRowsSorter.destroy(),this._audioRowsSorter=new _web_grid_sorted__WEBPACK_IMPORTED_MODULE_23__.default(this._els.audioRows,"",{wrapNode:this.isLayer()?this._scroll.scroller:void 0,onReorder:(e,t,i)=>this.onAudioRowsReorder(_,e,t,i)}),this._onSectionOut(function(){this._audioRowsSorter&&this._audioRowsSorter.destroy()}.bind(this)))},AudioPage.prototype._disableAudioRowsSorter=function(){this._audioRowsSorter&&this._audioRowsSorter.disable()},AudioPage.prototype._initAutoplayBlock=function(_,e){(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getPlaylistQueue().isAutoplaySupported&&(this._els.autoplayBlock||(this._els.autoplayBlock=new _web_audio_components_AutoplayBlock__WEBPACK_IMPORTED_MODULE_40__.AutoplayBlock),this._els.autoplayBlock.init(_,e))},AudioPage.prototype._destroyAutoplayBlock=function(){this._els.autoplayBlock?.destroy()},AudioPage.prototype._onCurrentSectionNeedRows=async function(_,e){const t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getPlaylistQueue();_(await t.getAudios(e,e+_shared_audio_enums__WEBPACK_IMPORTED_MODULE_29__.AUDIO_PLAYER_ENUMS.AUDIO_QUEUE_MAX_AUDIOS_COUNT))},AudioPage.prototype._initAudioRowsAutoList=function(_=!1){if(!this._els.audioRows)return;const e=this.isPodcastPage()||"podcast"===this._currentSection,t=this._pagePlaylist;this._els.audioRows.innerHTML="",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(this._els.audioRows,"audio_owner_list_canedit",!e&&!!this._data.canEdit),this._audioRowsAutoList&&this._audioRowsAutoList.destroy(),this._audioRowsAutoList=new _web_auto_list_auto_list__WEBPACK_IMPORTED_MODULE_13__.default(this._els.audioRows,{scrollNode:!!this._scroll&&this._scroll.scroller,onRendered:function(){(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().updateCurrentPlaying()},onNoMore:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.audioRowsMore),_&&this._initAutoplayBlock(this.getCurrentSectionEl(),this._scroll)}.bind(this),offset:0,onNeedRows:function(i,o,s,a,l){const n=[],r=(_=[])=>{_.forEach((_=>{n.push(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.drawAudio(_))})),i(n),0===o&&this._audioRowsSorter&&this._audioRowsSorter.update(),0===o&&1===n.length&&l.drawMore()};e?((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.lockButton)(this._els.audioRowsMore),this._loadPodcastEpisodes(o,function(_){r((_||[]).slice(o)),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.unlockButton)(this._els.audioRowsMore)}.bind(this))):_?this._onCurrentSectionNeedRows(r,o):t&&t.load(o,(()=>{const _=t.getAudiosList();r(_)}))}.bind(this)}),this._onSectionOut(function(){this._destroyAutoplayBlock(),this._audioRowsAutoList.destroy(),this._els.audioRows.innerHTML=""}.bind(this))},AudioPage.prototype._loadPodcastEpisodes=function(_,e){let t;const i=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentAudio()||this._readyAudio;let o={};try{o=JSON.parse(i[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_EXTRA])}catch(_){}if(o&&o.externalAudio){let _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentPlaylist();return void e(_._ref._list)}t=this.isPodcastPage()?this._ownerId:i[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID],cur._podcastsEpisodes=cur._podcastsEpisodes||{},cur._podcastsEpisodes[t]=cur._podcastsEpisodes[t]||[];const s=cur._podcastsEpisodes[t];s.length&&_<s.length?e(s):ajax.post("al_podcasts.php",{act:"a_episodes",oid:t,episode_full_id:i?i[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID]+"_"+i[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_ID]:"",offset:_,rev:this._data.reverse,claim:window.nav.objLoc.claim},{onDone:function(_){cur._podcastsEpisodes[t]=s.concat(_||[]),e(cur._podcastsEpisodes[t])},onFail:function(){return e(cur._podcastsEpisodes[t]),!0}})},AudioPage.prototype._destroyReadyAudio=function(){delete this._readyAudio},AudioPage.showAttachBox=function(_,e){(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)()&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_item_list",(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)().bodyNode),"offset")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_item_list",(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)().bodyNode),"offset",0),1===vk.widget?(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.showBox)("al_audio.php",{act:"choose_box",owner_id:_,options:JSON.stringify(e)}):AudioPage.editPlaylist(_,_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.DEFAULT_PLAYLIST_ID,"attach",e)},AudioPage.editPlaylist=function(_,e,t,i){if(vk.widget)for(let _ in i)i.hasOwnProperty(_)&&((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.isString)(i[_])?i[_]=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.clean)(i[_]):(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.isFunction)(i[_])?delete i[_]:i[_]=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(i[_]));let o,s;if("edit"===t&&i&&(i.audioAttachSwitchOwnerId=!1),i&&i.audioAttachSwitchOwnerId&&(cur.audioAttachSwitchOwnerId=i.audioAttachSwitchOwnerId),t=t||"edit",e)o=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_PLAYLIST,_,e);else if(cur.audioPage){const _=cur.audioPage._data.maxPlaylistsCount;if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.isArray)(cur.audioPage._data.playlists)&&cur.audioPage._data.playlists.length>=_){const e=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(_,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.curLang("audio_playlists_limit_error")).replace("{limit}",_);return void new _web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.MessageBox({title:_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_error")}).content(e).setButtons("Ok",(function(){(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)().hide()})).show()}}const a=(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.showBoxLoader)();(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_22__.parallel)((_=>{window.stManager.add(["audio.css",window.jsc("web/indexer.js"),window.jsc("web/auto_list.js"),window.jsc("web/grid_sorter.js"),"edit"===t&&window.jsc("web/upload.js")],_)}),(_=>{o?(o.setForceReload(!0),o.loadAll(_,t)):_()}),(e=>{if(cur.audioPage&&cur.audioPage.getOwnerId()===+_&&!i?.promotedAudios&&(s=cur.audioPage.getOwnerPlaylists()),i?.promotedAudios){const _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)();s=[],i.addAudio=[],i.promotedAudios.forEach(((t,o,s)=>{const a=_.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_PLAYLIST,t[0],t[1]);0===a.getAudiosCount()&&void 0===a.getTotalCount()?a.load((()=>{i.addAudio.push(...a.getAudiosList()),o===s.length-1&&e()})):(i.addAudio.push(...a.getAudiosList()),o===s.length-1&&e())}))}else s?e():AudioPage.loadPlaylists(_,void 0,!1,"attach"===t,(_=>{s=_,e()}))}),(()=>{(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.isBoxLoadingCancelled)(a)||AudioPage._openEditPlaylist(t,_,e,s,i)}))},AudioPage.initBoxEls=function(_){return{boxContent:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_pl_edit_box",_.bodyNode),playlistNameInput:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ape_pl_input",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ape_pl_title",_.bodyNode)),playlistDescriptionInput:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ape_pl_input",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ape_pl_description",_.bodyNode)),playlistDiscoverToggle:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ape_discover_checkbox",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ape_pl_discover",_.bodyNode)),playlistUpdateIdInput:_.bodyNode.querySelector("#ape_pl_to_update_id"),playlistUpdateTimeInput:_.bodyNode.querySelector("#ape_pl_to_update_time"),playlistUpdateCutInput:_.bodyNode.querySelector("#ape_pl_to_update_cut"),playlistUpdateFilterInput:_.bodyNode.querySelector("#ape_pl_to_update_filter"),stat:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_pl_stat",_.bodyNode),uploadCoverButtonWrapper:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_cover",_.bodyNode),uploadCoverInput:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_cover_upload",_.bodyNode),errorMsg:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_error_msg",_.bodyNode),header:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_header",_.bodyNode),search:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_search",_.bodyNode),searchInput:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_field",_.bodyNode),addAudiosButton:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ape_add_audios_btn",_.bodyNode),addAudiosFromPlaylistsButton:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ape_add_pl_audios_btn",_.bodyNode),listWrap:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_list_wrap",_.bodyNode),list:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_item_list",_.bodyNode),globalResults:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_item_global_results",_.bodyNode),globalResultsList:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_item_global_list",_.bodyNode),emptyPlaceholder:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_audios_empty_list",_.bodyNode),emptyPlaylistsPlaceholder:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_audios_empty_playlists_list",_.bodyNode),emptyGlobalPlaceholder:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_audios_empty_global_list",_.bodyNode)}},AudioPage._openEditPlaylist=function(_,e,t,i,o){let s,a,l,n,r,d,u;const c=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)(),E=c.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_TEMP,e,(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.irand)(0,999999));if((0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)()){r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_item_list",(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)().bodyNode),"offset"),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.val)("ape_edit_playlist_search");const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_item_list",(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)().bodyNode);_&&(u=_.scrollTop)}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(boxLoader),(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)()||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(boxLayerWrap),cur.apLayer&&(n=cur.apLayerPlaylistId,layers.fullhide()),o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.extend)({audioPickerButtonText:_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_add_media"),playlistPickerButtonText:_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_attach_playlist_button"),canPlaylistAttach:!1,onAudioChoose:_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.onAudioChoose,onPlaylistChoose:_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.onPlaylistChoose},o),cur.onChooseAudio=o.onAudioChoose,cur.onChoosePlaylist=o.onPlaylistChoose;const h=!t||t===_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.DEFAULT_PLAYLIST_ID,P="attach"===_,p=!!o?.promotedAudios;let b,g=!1,O=!1,D=!1,A=!1,M=0,C=null,y=!0,m=!1,w=0,I=0;i=i.filter((_=>_.id!==_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.DEFAULT_PLAYLIST_ID&&_.size>0));const B=new _web_indexer_indexer__WEBPACK_IMPORTED_MODULE_21__.vkIndexer(i,(_=>_.title)),T=i.length>0;let L=!1;h&&!P||p?o.addAudio&&E.pushAudio(o.addAudio):(L=c.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_PLAYLIST,e,t),E.pushAudio(L.getAudiosList()),E.mergeWith({title:L.getTitle(),description:L.getDescription(),rawDescription:L.getRawDescription(),coverUrl:L.getCoverUrl(),editHash:L.getEditHash(),noDiscover:L.getNoDiscover()}));const f=P?_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_choose_audio_title"):t?_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_edit_playlist_title"):_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_new_playlist_title");function R(_){if(_=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.trim)(_)){let e=" "+(_+"|")+((0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.parseLatin)(_)||"")+((0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.parseCyr)(_)||"");e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.trim)(e.replace(/\)/g,"").replace(/&/,"&amp;")),A=new RegExp("(\\s|^)("+e.replace(_web_indexer_indexer__WEBPACK_IMPORTED_MODULE_21__.vkIndexer.delimiter,"|").replace(/(^\||\|$|\?)/g,"")+")","gi")}else A=!1;N(O,"playlists"!==g,_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.emptyGlobalPlaceholder)}function v(){o.onClose&&o.onClose(),y||(E.clean(),c.deletePlaylist(E),n&&_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.showAudioPlaylist(n[0],n[1]))}function U(e){if(!m||e||"attach"===_)return!0;let i,o;return t?(i=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_edit_playlist_cancel_confirm_text"),o=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_edit_playlist_cancel_confirm_yes")):(i=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_new_playlist_remove_confirm_text"),o=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_new_playlist_remove_confirm_continue")),(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.showFastBox)(_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_warning"),i,o,(()=>{y=!1,(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)().hide(),s.hide(!0)}),_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_cancel")),!1}function W(){return(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.trim)(a.searchInput.value)}function K(e){const t=E.indexOfAudio(e)>=0?"ape_selected":"",i=e;A&&((e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.clone)(i))[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_TITLE]=e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_TITLE].replace(A,"$1<em>$2</em>"),e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_PERFORMER]=e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_PERFORMER].replace(A,"$1<em>$2</em>"));let s="";if("edit"===_){s=`<div class="ape_check">\n        <div class="ape_check--unchecked">${(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_52__.getIcon24CheckCircleOff)().icon}</div>\n        <div class="ape_check--checked">${(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_53__.getIcon24CheckCircleOn)().icon}</div>\n      </div>`}else{let _=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(i);if(o&&o.wiki){s='<div role="button" class="ape_attach" onclick="'+`editorChooseAudio(\n        '${(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.clean)(_.performer)}',\n        '${(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.clean)(_.title)}',\n        ${_.duration},\n        '${_.fullId}',\n        '${_.url}',\n        ${_.duration},\n        this)`+'">'+o.audioPickerButtonText+"</div>"}else{_=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.clean)(JSON.stringify(_));s=`<div role="button" class="ape_attach" onclick="cur.onChooseAudio(event, this, ${_}, ${(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.clean)(JSON.stringify(i))})">${o.audioPickerButtonText}</div>`}}return'<div class="ape_audio_item_wrap _ape_audio_item '+t+'">'+s+_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.drawAudio(e)+"</div>"}function S(){clearTimeout(w);const _=W();_&&(w=setTimeout((function(){w=!1,D=c.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_SEARCH,vk.id,(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_22__.hashCode)(_+"no conflict")),D.mergeWith({searchParams:{globalQuery:_},hasMore:!0});let e=0;l&&(e=l.getOffset(),l.destroy()),l=new _web_auto_list_auto_list__WEBPACK_IMPORTED_MODULE_13__.default(a.list,{scrollNode:a.list,onNeedRows:function(_,t){t-=e,D.load(t,(function(){const e=[],i=D.getAudiosList();if(0==+t&&i.length&&e.push('<div class="ape_list_header">'+_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_edit_playlist_global_results")+"<div>"),i.length){const _=Math.min(i.length,t+20);for(let o=t;o<_;o++)i[o]&&e.push(K(i[o]))}D.getAudiosCount()||l&&l._offset?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.emptyGlobalPlaceholder),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.list)):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.emptyGlobalPlaceholder),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.list)),_(e)}))}}),l.drawMore()}),300),C=null)}function k(){s.setOptions({title:'<div class="back _back"><span class="back__icon">'+(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_54__.getIcon24ChevronLeft)().icon+"</span>"+_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_back")+"</div>",bodyStyle:"padding: 0"})}function x(){let _="";cur.audioAttachSwitchOwnerId&&cur.audioAttachOriginalOwnerId&&(_='<span class="dvd"></span><a class="tab_link" onclick="cur.audioAttachSwitch()">',_+=_shared_ranges__WEBPACK_IMPORTED_MODULE_42__.Ranges.isGroupId(E.getOwnerId())?_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_choose_wall_to_my_audios"):_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_choose_wall_to_group_audios"),E.getOwnerId()===cur.audioAttachOriginalOwnerId?cur.audioAttachSwitch=function(){AudioPage.showAttachBox(cur.audioAttachSwitchOwnerId,o)}:cur.audioAttachSwitch=function(){AudioPage.showAttachBox(cur.audioAttachOriginalOwnerId,o)},_+="</a>"),s.setOptions({title:f+_,bodyStyle:"padding: 0"})}function H(){const _=a.boxContent.getBoundingClientRect();if(_.height&&_.width){const e=a.list.getBoundingClientRect();(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(a.list,{height:_.height-(e.y-_.y)})}}function N(_,e,t){O=_,e&&O?t?O.search({q:t},(function(_){F(!0,_)})):F(!0,O.getAudiosList(),_):F(!1,t?B.search(t):i),j("initial"===g&&!t)}function F(_,e,t){a.list.innerHTML="",l&&l.destroy(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.list),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.emptyPlaceholder),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.emptyGlobalPlaceholder),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.emptyPlaylistsPlaceholder),H();let i=0;l=new _web_auto_list_auto_list__WEBPACK_IMPORTED_MODULE_13__.default(a.list,{scrollNode:a.list,onNoMore:function(){0===i&&(W()?_||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.list),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.emptyPlaylistsPlaceholder)):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.list),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.emptyPlaceholder))),p?function(){clearTimeout(I);const _=W();_&&(I=setTimeout((function(){I=!1;let e=0;l&&(e=l.getOffset(),l.destroy()),l=new _web_auto_list_auto_list__WEBPACK_IMPORTED_MODULE_13__.default(a.list,{scrollNode:a.list,onNeedRows:function(t,i){i>e?t([]):(i-=e,ajax.post("/audio?act=load_catalog_section",{section_id:o.audioSectionId,search_query:_},{onDone:function(){const _=arguments[1]?.playlist?.list||[],e=[];0==+i&&_.length&&e.push('<div class="ape_list_header">'+_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_edit_playlist_global_results")+"<div>"),_.length&&_.forEach((_=>{e.push(K(_))})),_&&_.length?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.emptyGlobalPlaceholder),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.list)):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.list),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.emptyGlobalPlaceholder)),t(e)},onFail:function(_){return(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.showFastBox)({title:_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_error"),width:350},_),!0}}))}}),l.drawMore()}),100),C=null)}():_&&S()},onNeedRows:function(o,s){let a=r||20;const l=t&&t.hasMore()?s+a:Math.min(e.length,s+a);if(l>e.length&&t&&t.hasMore())t.load(s+a,(a=>{const n=q((e=t.getAudiosList()).slice(s,l),_);i+=n.length,o(n)}));else{const t=q(e.slice(s,l),_);i+=t.length,o(t)}},onRendered:_=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)(a.list,"offset",_),u&&r&&(a.list.scrollTop=u,r=0,u=0)}})}function q(_,e){const t=(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_55__.getIcon24Playlist)().icon,i=(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_56__.getIcon24ChevronRight)().icon;return _.map((_=>{if(e)return K(_);{const e='<div class="ape_pl_item_inner"><span class="ape_pl_title">'+(A?_.title.replace(A,"$1<em>$2</em>"):_.title)+'</span> <span class="ape_pl_size">'+(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(_.size,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.curLang("audio_playlist_audios_count"),!0).replace("{count}",_.size)+"</span></div>";return`<div class="ape_pl_item"\n                        data-playlist-access-hash="${_.access_hash}"\n                        data-playlist-owner-id="${_.owner_id}"\n                        data-playlist-id="${_.id}">\n                          <div class="ape_pl_item__icon_playlist">${t}</div>\n                          ${e}\n                          <div class="ape_pl_item__icon_chevron">${i}</div>\n                        </div>`}}))}function j(_){b||(b=new _web_grid_sorted__WEBPACK_IMPORTED_MODULE_23__.default(a.list,"ape_audio_item_wrap",{wrapNode:a.list,onReorder:function(_,e){let t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_row",_),"full-id");const i=E.indexOfAudio(t);let o;e?(t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_row",e),"full-id"),o=E.indexOfAudio(t)):o=E.getAudiosCount(),E.moveAudio(i,o)}})),_?b.enable():b.disable()}function G(t,l){if("default"===t&&cur.audioPage&&cur.audioPage._data.addBanned)(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.showFastBox)({title:_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_error")},cur.audioPage._data.addBannedText);else{switch(g=t,s.removeButtons(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(a.list,"view",t),t){case"initial":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.header),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.addAudiosFromPlaylistsButton),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.addAudiosButton),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.search),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.globalResults),N(E,!0),Y(),x();break;case"default":const t=c.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_PLAYLIST,e,_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.DEFAULT_PLAYLIST_ID);(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.disableEl)(a.addAudiosButton),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.showProgress)(a.addAudiosButton),t.load((function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.enableEl)(a.addAudiosButton),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.hideProgress)(a.addAudiosButton),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.header),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.search),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggle)(a.addAudiosFromPlaylistsButton,T),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.addAudiosButton),"edit"===_?k():x(),N(t,!0,d),H(),"edit"===_&&Y()}));break;case"playlists":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.header),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.search),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.addAudiosFromPlaylistsButton),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.addAudiosButton),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.globalResults),k(),N(i);break;case"playlist":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.header),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.search),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.addAudiosFromPlaylistsButton),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.addAudiosButton),k(),N(l,!0),P&&function(_){if(!o.canPlaylistAttach)return;function e(e){cur.onChoosePlaylist(e,_)}s.addButton(o.playlistPickerButtonText,e,"ok",!0)}(l),"edit"===_&&Y()}H(),a.searchInput.value="",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.elfocus)(a.searchInput),A=!1,C=null,clearTimeout(w),c&&c.updateCurrentPlaying&&c.updateCurrentPlaying()}}function Y(){s.addButton(_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_save_playlist_button"),z,"ok",!0)}function $(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domClosest)("ape_pl_item",_.target);if(e){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(e,"playlist-id"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(e,"playlist-owner-id"),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(e,"playlist-access-hash"),s=c.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_PLAYLIST,i,t,o);(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.showProgress)(e),s.load((function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.hideProgress)(e),G("playlist",s)}))}if(_.target.closest(".ape_check")){function l(_,e){if(cur.audioPage&&cur.audioPage._data.addBanned)return void(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.showFastBox)({title:_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_error")},cur.audioPage._data.addBannedText);const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(_,"ape_selected",e),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_row",_),o=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.getAudioFromEl(i);t?E.pushAudio(o,0):E.removeAudio(o)}const n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domClosest)("_ape_audio_item",_.target);if(_.shiftKey&&C){let r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domChildIndex)(C),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domChildIndex)(n);const u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domPN)(n);if(r>d){const p=d;d=r,r=p}const h=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hasClass)(C,"ape_selected");for(let b=r;b<=d;b++)l(u.children[b],h)}else l(n),C=n;V(),J()}if(P&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hasClass)(_.target,"artist_link")){if(_.metaKey&&_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.mac||_.ctrlKey)return;const g=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(_.target,"performer")||(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.trim)(_.target.innerText);g&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.val)(a.searchInput,g),uiSearch.onChanged(a.searchInput),R(g))}return(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(_)}function V(){const _=E.getAudiosCount(),e=E.getTotalDuration();let t;if(_){let i;t=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(_,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.curLang("audio_edit_playlist_audios_info")),t=t.replace("{count}",_);const o=e%60,s=Math.floor(e/60)%60,a=Math.floor(e/3600);e<60?i=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(e,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.curLang("audio_total_dur_seconds")):e<3600?(i=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(s,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.curLang("audio_total_dur_minutes")),o&&(i+=" "+(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(o,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.curLang("audio_total_dur_seconds")))):(i=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(a,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.curLang("audio_total_dur_hours")),s&&(i+=" "+(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(s,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.curLang("audio_total_dur_minutes")))),t+='<span class="dvd">'+i+"</span>"}else t=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_edit_playlist_no_audios");a.stat.innerHTML=t}function z(_){let t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.val)(a.playlistNameInput));t=t.replace(/[\u200B-\u200D\uFEFF]/g,"");const i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.val)(a.playlistDescriptionInput)),l=+(a.playlistDiscoverToggle&&a.playlistDiscoverToggle.classList.contains("on"));if(a.playlistUpdateIdInput&&(t=`${(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.trim)(a.playlistUpdateIdInput.value)}_${a.playlistUpdateTimeInput.valueAsNumber}_${a.playlistUpdateCutInput.valueAsNumber}`),!t)return G("initial"),void(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.notaBene)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.ge)("ape_pl_name"));const n=[];(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)(E.getAudiosList(),(function(_,e){n.push(e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID]+"_"+e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_ID]+"_"+e[_shared_audio_enums__WEBPACK_IMPORTED_MODULE_29__.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_ACCESS_KEY])}));const r=o.newPlaylistHash||cur.audioPage&&cur.audioPage._data.newPlaylistHash||"",d={hash:h?r:L.getEditHash(),owner_id:e,playlist_id:h?0:L.getPlaylistId(),title:t,description:i,Audios:n.join(","),cover:(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.isObject)(M)?JSON.stringify(M):M};a.playlistUpdateIdInput&&(d.update_id=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.trim)(a.playlistUpdateIdInput.value),d.update_time=(a.playlistUpdateTimeInput.valueAsNumber+6e4*(new Date).getTimezoneOffset())/1e3,d.update_cut=a.playlistUpdateCutInput.valueAsNumber,d.update_filter=a.playlistUpdateFilterInput.classList.contains("on")?1:0),null!==l&&(d.no_discover=l),ajax.post("al_audio.php?act=save_playlist",d,{showProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.lockButton)(_),onDone:(_,t)=>{o?.onSavePlaylistDone?.();h&&!document.querySelector(".CatalogSection ._audio_page__playlists")?nav.reload():((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass)("_audio_pl_"+_.ownerId+"_"+_.id),(function(){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_pl__cover",this);if(e){AudioPage.setCoverImageElem(e,_.coverUrl,_.title);const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_pl_grid_covers_wrap",this);t&&(t.innerHTML=_.coverUrl?"":_.gridCovers)}const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_pl__title",this);if(t){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_item__title",t);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.val)(e||t,_.title)}const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_pl__stats_count",this);i&&(i.innerHTML=_.totalCount)})),h&&cur.audioPage&&e==cur.audioPage.getOwnerId()&&["all","my_playlists"].includes(cur.audioPage._currentSection)&&((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)(cur.audioPage._els.pageContainer.querySelectorAll(".CatalogBlock__my_playlists ._audio_page_block__playlists_items"),(function(){const{thumb:_,title:e}=t,i={...t,cover_image:AudioPage.getCoverImage(_,e)},o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.se)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.getTemplate)("audio_pl_item",i));let s=this;if(s.classList.contains(_web_components_ui_gallery__WEBPACK_IMPORTED_MODULE_33__.UI_GALLERY_CLASSNAME)){const _=(0,_web_components_ui_gallery__WEBPACK_IMPORTED_MODULE_33__.uiGetGallery)(s);let e=document.createElement("div");e.classList.add("ui_gallery_item"),e.appendChild(o),_.addItems([e],0)}else{s.insertBefore(o,s.firstChild);const _=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(s,"max-items"));_&&s.children.length>_&&s.removeChild(s.lastChild)}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.gpeByClass)("_audio_page__playlists",s))})),cur.audioPage._data.playlists=cur.audioPage._data.playlists||[],cur.audioPage._data.playlists.unshift(t)),h&&cur.audioPage&&cur.audioPage.catalogController.updateSectionReorder(),cur.audioPage&&cur.audioPage.updatePlaylistsCounter&&cur.audioPage.updatePlaylistsCounter(e),L&&(L.clean(),L.mergeWith(_)),s.hide(!0),(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.isFunction)(o.onPlaylistSave)&&o.onPlaylistSave(L))},onFail:()=>(s.hide(!0),!0)})}function Q(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.coverThumb),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(a.coverThumb,"background-image","url("+_+")"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.addClass)(a.uploadCoverButtonWrapper,"ape_thumb_set"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.uploadCoverButton)}function X(_){return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(a.uploadCoverButtonWrapper,"ape_thumb_set"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_cover_thumb")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.uploadCoverButton),M=-1,(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(_)}function J(){m=!0}(2===vk.widget||3===vk.widget)&&window.box&&(!boxQueue.count()&&!(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)()||cur.audioChooseBox===(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)())?(s=window.box,s.setOptions({title:f,bodyStyle:"padding: 0",width:560,onBeforeHide:v,onHideAttempt:U,hideButtons:!0})):(cur.audioChooseBox&&cur.audioChooseBox===(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)()&&(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)().hide(),s=new _web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.MessageBox({title:f,bodyStyle:"padding: 0",width:560,onBeforeHide:v,onHideAttempt:U})),cur.audioChooseBox=s,s.content((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.getTemplate)("audio_edit_playlist")),s.show(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)(s,"ownerId",e),a=AudioPage.initBoxEls(s),function(){const t=window.innerHeight;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(a.boxContent,"height",Math.min(800,Math.max(t-200,500))),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(a.addAudiosFromPlaylistsButton,"click",G.bind(this,"playlists")),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(a.addAudiosButton,"click",G.bind(this,"default")),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(a.list,"click",$),P&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(a.list,"audio-context","attach");(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(s.titleWrap,"click",(function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hasClass)(_.target,"_back")&&function(){switch(g){case"initial":break;case"default":G("initial");break;case"playlists":G("default");break;case"playlist":G("playlists")}}()})),uiSearch.init("ape_edit_playlist_search",{onChange:R}),"edit"===_&&(G("initial"),V(),function(){if(!cur.audioCoverUploadOptions||!cur.audioCoverUploadOptions[e])return;const _=cur.audioCoverUploadOptions[e],t={file_name:"photo",file_size_limit:5242880,file_types_description:"Image files (*.jpg, *.jpeg, *.png, *.gif)",file_types:"*.jpg;*.JPG;*.jpeg;*.JPEG;*.png;*.PNG;*.gif;*.GIF;*.bmp;*.BMP",onUploadStart:function(_,e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_cover_progress"))},onUploadComplete:function(_,e){(e=JSON.parse(e)).error?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.errorMsg),H()):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.errorMsg),M=e,Q(M.url),J(),H()),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_cover_progress"))},onUploadProgress:function(_,e,t){},onUploadError:function(_,e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_cover_progress"))},clear:1,type:"photo",max_attempts:3,server:_.server,noCheck:!0,chooseBox:!0,uploadButton:!0,accept:".jpg,.jpeg,.png",filesize_hide_last:!0,label:_.button};function i(){(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.isObject)(M)&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.isVisible)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_cover_progress"))||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByTag1)("input",a.uploadCoverButtonWrapper).click()}Upload.init(a.uploadCoverButtonWrapper,_.url,_.vars,t),a.uploadCoverButton=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ape_cover_accessibility_upload_btn",s.bodyNode),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_cover_delete"),"click",X),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(a.uploadCoverButton,"click",(()=>i())),a.coverThumb=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_cover_thumb")}(),E.getCoverUrl()&&Q(E.getCoverUrl()),(0,_web_lib_layout_utils__WEBPACK_IMPORTED_MODULE_5__.autosizeSetup)(a.playlistDescriptionInput,{minHeight:30,maxHeight:150,onResize:H}),a.playlistNameInput.value=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.replaceEntities)(E.getTitle()),a.playlistDescriptionInput.value=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.replaceEntities)(E.getRawDescription().replace(/<br>/g,"\n")),a.playlistDiscoverToggle&&a.playlistDiscoverToggle.classList.toggle("on",E.getNoDiscover()),a.playlistNameInput.addEventListener("input",J),a.playlistDescriptionInput.addEventListener("input",J),a.playlistDiscoverToggle&&a.playlistDiscoverToggle.addEventListener("click",J),a.playlistUpdateIdInput&&cur.editorialPlaylistsParams&&(a.playlistUpdateIdInput.value=cur.editorialPlaylistsParams.target_playlist,a.playlistUpdateTimeInput.valueAsNumber=1e3*cur.editorialPlaylistsParams.update_time-6e4*(new Date).getTimezoneOffset(),a.playlistUpdateCutInput.valueAsNumber=cur.editorialPlaylistsParams.update_cut,a.playlistUpdateFilterInput.classList.toggle("on",1===cur.editorialPlaylistsParams.update_filter),a.playlistUpdateFilterInput.setAttribute("aria-checked",1===cur.editorialPlaylistsParams.update_filter),a.playlistUpdateIdInput.addEventListener("input",J),a.playlistUpdateTimeInput.addEventListener("input",J),a.playlistUpdateCutInput.addEventListener("input",J),a.playlistUpdateFilterInput.addEventListener("click",J)));p?G("playlist",E):P&&G("default");x(),L&&"attach"!==_&&s.setControlsText(`<a onclick="AudioPage.deletePlaylist(${L.getOwnerId()}, ${L.getPlaylistId()}, '${L.getEditHash()}')">\n                              ${_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_delete_playlist")}\n                            </a>`)}(s.bodyNode),d&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.val)(a.searchInput,d),S()},AudioPage.prototype._deinitKeyEvents=function(){this._audioHQKeyEventHandler1&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(window.document,"keydown",this._audioHQKeyEventHandler1),this._audioHQKeyEventHandler2&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(window.document,"keyup",this._audioHQKeyEventHandler2),this._audioHQKeyEventHandler3&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(window.document,"visibilitychange",this._audioHQKeyEventHandler3),this._audioHQKeyEventHandler4&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(window.document,"mousedown",this._audioHQKeyEventHandler4),this._audioSeekKeyEventHandler&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(window.document,"keydown",this._audioSeekKeyEventHandler)},AudioPage.prototype._initKeyEvents=function(){this._deinitKeyEvents();const _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)(),e=()=>!this.isLayer()&&_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.getLayer().isShown();(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(window.document,"mousedown",this._audioHQKeyEventHandler4=function(_){_.ctrlKey&&(cur.ctrlMouseDown=!0,cur.ctrlPressed=!1)},!0),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(window.document,"keydown",this._audioHQKeyEventHandler1=function(_){e()||(cur.ctrlPressed=_.keyCode===_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.KEY.CTRL)}),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(window.document,"keyup",this._audioHQKeyEventHandler2=function(_){e()||(_.keyCode!==_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.KEY.CTRL||cur.ctrlMouseDown)&&(delete cur.ctrlMouseDown,delete cur.ctrlPressed)}),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(window.document,"keydown",this._audioSeekKeyEventHandler=function(t){const i=t.target,o=i&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.inArray)(i.tagName.toLowerCase(),["input","textarea"])&&""!==(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.val)(i),s=i&&i.isContentEditable,a=cur&&cur.pvShown;o||s||a||e()||!_.isPlaying()||!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.inArray)(t.keyCode,[_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.KEY.RIGHT,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.KEY.LEFT])||cur.wallLayer||t.ctrlKey||_.seekCurrentAudio(t.keyCode===_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.KEY.RIGHT)}),cur.destroy.push((()=>this._deinitKeyEvents()))},AudioPage.prototype.editFeed=function(){const _=this;(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.showTabbedBox)("al_settings.php",{act:"a_edit_owners_list",list:"audio",height:lastWindowHeight},{stat:[window.jsc("web/privacy.js"),"privacy.css","ui_controls.js","ui_controls.css",window.jsc("web/indexer.js")]}),cur.onOListSave=function(e,t,i,o){const s=(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)(),a={act:"a_ignore_olist",hash:o.hash};return e.length<t.length?a.White=e.join(","):a.Black=t.join(","),ajax.post("al_audio.php",a,{onDone:function(){s.hide();_.getCurrentPlaylist().clean(),_.refreshCurrentPage()},onFail:()=>!0,showProgress:s.showProgress,hiderogress:s.hideProgress}),!1}},AudioPage.prototype.updateStatusExportControls=function(_){const e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)(),t=e.getStatusExportInfo();(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass)("_audio_export_status",this._els.pageContainer),(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(this,"on",t&&!!t[(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(this,"oid")])}));const i=e.hasStatusExport(),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_player_status",this._els.pageContainer);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(o,"audio_page_player_btn_enabled",i),!_)if(this.isLayer())cur.audioPage&&cur.audioPage.updateStatusExportControls(!0);else{const _=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.getLayer().getPageInstance();_&&_.updateStatusExportControls(!0)}return!1},AudioPage.prototype.updateStatusExport=function(_,e){_&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.checkbox)(_),e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(e);const t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)(),i=t.getStatusExportInfo()||{};let o,s,a;if(e)i[e]?(delete i[e],o=!1):(i[e]=1,o=!0);else if(t.hasStatusExport()){for(let _ in i)i.hasOwnProperty(_)&&delete i[_];o=!1}else i[e=vk.id]=1,o=!0;t.setStatusExportInfo(i),e!=vk.id&&e||(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.checkbox)("currinfo_audio",t.hasStatusExport()),this.updateStatusExportControls();const l=t.getCurrentAudio();l&&(s=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(l).fullId,a=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(l).accessKey);const n=null;t.stats.sendCurrentAudioEvent({type:_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_11__.TYPE_BROADCASTING,subtype:o?_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_11__.SUBTYPE_ON:_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_11__.SUBTYPE_OFF,targetOwnerId:e}),ajax.post("al_audio.php?act=toggle_status",{exp:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(o),oid:e,hash:vk.statusExportHash,id:s,top:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(n),access_key:a},{onFail:()=>!0})},AudioPage.prototype.playStatusAudio=function(_,e,t){const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.gpeByClass)("_audio_friend",t);(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().playLive(_,{showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.showProgress.pbind(i),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.hideProgress.pbind(i)}),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(e)},AudioPage.showActionTooltip=function(_,e){const t=[3,-8,0],i=currentAudioPage(_),o=i&&i.isLayer();(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hasClass)(_,"_audio_page_player_add")?(0,_web_lib_feature_tooltips__WEBPACK_IMPORTED_MODULE_26__.audioShowActionTooltip)(_,t,o):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hasClass)(_,"_audio_page_player_play_rate")&&(t[0]=-17),(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_27__.showTooltip)(_,{text:e,black:1,shift:t,appendParentCls:"_audio_page_player",forcetodown:o,needLeft:o}))},AudioPage.prototype.onHide=function(){const _=this;cur.nav=cur.nav.filter((function(e){return _._nav_func!=e})),this._deinitKeyEvents()},AudioPage.prototype.showRecoms=function(_,e){if(!e){const _=this._readyAudio?this._readyAudio:(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentAudio();if(!_)return;e=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(_).fullId}(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_4__.statlogsValueEvent)("audio_recoms_by_track_button_click",!0),nav.go({0:"audio",section:"recoms_audio",audio_id:e},null,{nocur:!0})},AudioPage.prototype.onAudioUploaded=function(_,e){if(!e)return;const t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)(),i=t.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_PLAYLIST,this.getOwnerId(),_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.DEFAULT_PLAYLIST_ID);i.pushAudio(e);const o=t.getCurrentPlaylist();o&&o.getSelf()==i&&o.pushAudio(e),"all"!==this._currentSection&&this.resetSection("all");let s=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(e);(0,_web_audio_player_stat_onAdditionalEvent__WEBPACK_IMPORTED_MODULE_12__.onAdditionalEvent)(null,s,{type:_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_11__.TYPE_ADDED,subtype:_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_11__.SUBTYPE_UPLOAD,context:"on_audio_uploaded",playlistId:i.getOwnerId()+"_"+i.getPlaylistId()});let a=5;const l=this;!function _(t){--a<0||setTimeout((function(){ajax.post("al_audio.php?act=check_audio_data",{audio_owner_id:s.ownerId,audio_id:s.id},{onDone:function(i){if(!i)return;let o=i[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_TITLE]!=e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_TITLE];o=o||i[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_PERFORMER]!=e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_PERFORMER],o=o||i[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_FLAGS]!=e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_FLAGS],o&&((0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().updateAudio(s.fullId,i),"all"===l._currentSection&&"audio"===cur.module&&l._initAudioRowsAutoList(),s=i),_(1.5*t)},onFail:()=>!0})}),t)}(1e3)},AudioPage.prototype.onAudioAllUploaded=function(){"all"===this._currentSection&&nav.reload()},AudioPage.prototype.uploadAudio=function(_){this._data.uploadBanned?(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.showFastBox)({title:_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_error")},this._data.uploadBannedText):(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.showBox)("al_audio.php",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.extend)(_||{},{act:"new_audio",gid:_shared_ranges__WEBPACK_IMPORTED_MODULE_42__.Ranges.isGroupId(this.getOwnerId())?-this.getOwnerId():0}),{params:{width:"450px",bodyStyle:"padding: 0px; position: relative;"}})},AudioPage.prototype.editAudio=function(_,e,t){return(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.showBox)("al_audio.php",{act:"edit_audio_box",aid:e},{params:{width:"456px",bodyStyle:"padding: 20px; background-color: #F7F7F7;",hideButtons:1}}),t&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(t),!1},AudioPage.prototype.restoreRecommendation=function(_){const e=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.getAudioFromEl(_,!0),t={act:"restore_recommendation",hash:(0,_shared_audio_utils_getAudioExtra__WEBPACK_IMPORTED_MODULE_36__.getAudioExtra)(e).recom.hash,audio_id:e.fullId};nav.objLoc.audio_id&&(t.recommendation_type="query"),nav.objLoc.album_id&&(t.recommendation_type="album"),ajax.post("al_audio.php",t,{onFail:()=>!0}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(_,"audio_row__deleted");const i=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.getAddRestoreInfo(),o=i[e.fullId].removedCurrentPos,s=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentPlaylist(),a=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getPlaylistQueue();o>=0&&s&&s.getType()==_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_RECOM&&a.addAudio(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.getAudioFromEl(_),o),delete i[e.fullId],_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.onRowOver(_,!1,!0)},AudioPage.isInRecentPlayed=function(_){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.gpeByClass)("_audio_playlist",_);return!(!e||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hasClass)(e,"audio_recent_rows"))&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)(e,"playlist")},AudioPage.prototype.chooseFromMyAudios=function(_){let e=!1;AudioPage.editPlaylist(vk.id,_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.DEFAULT_PLAYLIST_ID,"attach",{audioPickerButtonText:_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_add"),playlistPickerButtonText:_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_add"),onClose:()=>{e&&nav.reload()},onAudioChoose:(t,i,o)=>{const s=t.ctrlKey||t.metaKey;if(ajax.post("al_audio.php?act=add",{group_id:_,audio_owner_id:o.ownerId,audio_id:o.id,hash:o.addHash},{onDone:_=>{_&&(e=!0)},onFail:()=>!0}),s)i.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_choose_added"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.addClass)(i,"ape_added");else{e=!0;const _=window.__bq;if(_)for(;_.count();)_.hideLast()}}})},AudioPage.prototype.updateShuffleButton=function(){const _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getPlaylistQueue().shuffled;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_player_shuffle",this._els.pageContainer),"audio_page_player_btn_enabled",_),this.isLayer()&&cur.audioPage&&cur.audioPage.updateShuffleButton()},AudioPage.prototype.loadMarketItemsCarousel=function(){try{Boolean(document.querySelector(".EcommAudioMarketItemsCarousel__root"))&&(0,_vkontakte_vkjs__WEBPACK_IMPORTED_MODULE_34__.asyncImportLoader)((()=>__webpack_require__.e(34932).then(__webpack_require__.bind(__webpack_require__,718661))),3)}catch(_){}},AudioPage.prototype.updatePlayerClass=function(_){const e=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("audio_player_redesign_web_enabled")||(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("redesign_audio_player_tooltip_dislikes_web_enabled"),t=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isPodcast(_),i=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isRadio(_),o=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isArticleTts(_),s=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isMarusiaTale(_),a=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isMarusiaTrack(_);if(e||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(this._els.player,"audio_player_podcast",t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(this._els.player,"audio_player_radio_station",i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(this._els.player,"audio_player_article_tts",o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(this._els.player,"audio_player_radio_marusia",i&&a),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(this._els.player,"audio_player_external_stream_audio",i||o||s),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(this._els.player,"audio_player_marusia_tale",s),this._updatePlaybackRate()),!this.isPodcastPage()){this.isLayer()&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_tab__current",this._els.pageContainer),"unshown",t||!(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentPlaylist());const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_tab__podcast",this._els.pageContainer);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggle)(e,t),e&&t&&(_=_||(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentAudio(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.attr)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ui_tab",e),"href","podcasts"+_[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID]))}},AudioPage.prototype.updateRadioFollowBtn=function(){const _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentAudio(),e=this._els.player.querySelector(".audio_page_player_follow_radiostation");e&&(e.classList.toggle(AudioPage.followedRadioClassName,(0,_shared_audio_utils_getAudioExtra__WEBPACK_IMPORTED_MODULE_36__.getAudioExtra)(_)?.fave??!1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggle)(e,(0,_shared_audio_utils_isRadio__WEBPACK_IMPORTED_MODULE_35__.isRadio)(_)&&!_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isMarusiaTrack(_)))},AudioPage.prototype.updateFaveButton=function(){const _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentFaveStatus(),e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_fave",this._els.player);e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(e,"activated",_)},AudioPage.prototype.toggleRepeat=function(){if(this.isPodcastPage())return;const _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)();_.isRepeatAll()||_.isRepeatCurrentAudio()?_.toggleRepeatCurrentAudio():_.toggleRepeatAll(),this.updateRepeatButton()},AudioPage.prototype.updateRepeatButton=function(){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass)("_audio_page_player_repeat");if(_&&_.length){const e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)(),t=e.isRepeatAll(),i=e.isRepeatCurrentAudio();(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)(_,((_,e)=>{e.ariaLabel=e.ariaLabel&&AudioPage.getRepeatButtonText(),e.onmouseover=e.onmouseover&&AudioPage.showActionTooltip.bind(void 0,e,AudioPage.getRepeatButtonText),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(e,"audio_page_player_btn_enabled",t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(e,"audio_page_player_btn_repeat_one",i)}))}},AudioPage.getRepeatButtonText=function(){const _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)(),e=_.isRepeatAll(),t=_.isRepeatCurrentAudio();let i=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_repeat_tooltip");return e?i=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_repeat_track_tooltip"):t&&(i=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_dont_repeat_tooltip")),i},AudioPage.prototype.toggleShuffle=function(_){if(this.isPodcastPage())return;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(_,"audio_page_player_btn_enabled")&&(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_4__.statlogsValueEvent)("audio_sort_stat","audio_sort","shuffle_player",this.isLayer()?"layer":"page");const e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getPlaylistQueue();if(e.isEmpty())return;let t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentAudio();const i=()=>{e.shuffled?e.resetShuffle():e.shuffle(!0),"current"===this._currentSection&&this._initAudioRowsAutoList(!0),(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().playByButton(t),this.updateShuffleButton()};t?i():e.getAudioAt(0).then((_=>{t=_,i()}))},AudioPage.prototype.toggleFave=function(_){const e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentAudio()||this._readyAudio;_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isPodcast(e)&&AudioPlayer.podcastToggleFave(_,e)},AudioPage.prototype.changePlaybackRate=function(_,e){const t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentAudio()||this._readyAudio;(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isPodcast(t)||_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isArticleTts(t))&&((0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().podcastChangePlaybackRate(!!e.shiftKey),this._updatePlaybackRate())},AudioPage.prototype._updatePlaybackRate=function(){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_play_rate",this._els.player);_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_icon",_),AudioPlayer.podcastGetPlaybackRate()+"x")},AudioPage.prototype._getCurrentSearchParams=function(){const _=window.radioBtns["audio_search_type_"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(this.isLayer())],e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(this._searchSortFilter.selectedItems()[0][0]);return{performer:_&&_.val?1:null,lyrics:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_fltr_with_lyrics",this._container),"on")?1:null,sort:e?1:null}},AudioPage.searchAudios=function(_,e,t,i,o){currentAudioPage(this).searchAudios(_,e,t,i,o)},AudioPage.prototype.searchAudios=function(_,e,t,i,o){this.lastQuery!==_&&(this.lastQuery=_,this._muteSearch?delete this._muteSearch:(_=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.trim)(_),nav.change((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.extend)(this._getCurrentSearchParams(),{q:_||null}),!1,{fromSearch:!0,globalQuery:_,fromHistory:t,isLayer:this.isLayer(),fetchedQuery:i,fromSuggestsAcceptId:o})))},AudioPage.prototype.onUserAction=function(_,e){const t=e.indexOfAudio(_);if(-1!=+t&&e.getType()===_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_SEARCH){if(!(e.getOwnerId()===vk.id&&t>=0&&t<e.getLocalFoundCount())&&e.getSearchParams()){const t=e.getSearchParams();t.globalQuery&&uiSearch.saveHistorySearch(this.searchInputEl,t.globalQuery,_.ownerId,_.id,e.getTotalCount(),e.getTotalCountHash())}}},AudioPage.prototype._updateFriendsList=function(_,e,t){if(_=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.trim)(_),this._friendSearchInProgress=!1,!_)return;const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_friends_list",this._els.pageContainer),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.se)('<div class="audio_friends_list _audio_friends_list" style="">'+_+"</div>");t&&(this._shownFriends=[]),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domPN)(i).appendChild(o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.re)(i)},AudioPage.prototype.shareAudio=function(){const _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getCurrentAudio()||this._readyAudio;_&&_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.shareAudio(!1,_)},AudioPage.prototype.showStatusTooltip=function(_){this.statusTT||(this.statusTT=!0,ajax.post("al_audio.php?act=status_tt",{},{onDone:(e,t)=>{this.statusTT=new ElementTooltip(_,{content:t,width:250,offset:[1,14],elClassWhenShown:"audio_status_tt_shown",id:"audio_status_tt",onFirstTimeShow:function(_){this.sb=new _web_legacy_ui_ui_scroll__WEBPACK_IMPORTED_MODULE_16__.default((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_status_wrap",_),{global:!0})},onShow:function(){setTimeout(function(){this.statusTT.sb.update()}.bind(this),0)}.bind(this)}),cur._onStatusExportBtn&&(this.statusTT.show(),this.statusTT.sb.update())},onFail:()=>!0}))},AudioPage.prototype.isLayer=function(){return this._data.isLayer},AudioPage.prototype.isPodcastPage=function(){return!this.isLayer()&&!!this._data.podcastPage},AudioPage.prototype.destroy=function(){this._trackSlider&&this._trackSlider.destroy(),this._volumeSlider&&this._volumeSlider.destroy(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(window,"scroll",this._ev_onScroll)},AudioPage.prototype.getPageCurrentPlaylist=function(){return this._pagePlaylist},AudioPage.prototype.clearCurrentPlaylist=function(){const _=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("audio_player_redesign_web_enabled")||(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("redesign_audio_player_tooltip_dislikes_web_enabled");if(!this.isLayer())return;const e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)();e?.notify(_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.PLAYLIST_CLEAR_REQUESTED),e.deleteCurrentPlaylist(),this.updateCurrentPlayingInfo();const t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)().getPlaylistQueue();t.clean();const i=t.autoplayQueue;i&&(i.clean(),this._destroyAutoplayBlock());const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_tab__current",this._els.pageContainer);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.addClass)(o,"unshown"),"current"===this.getCurrentSection()&&(uiTabs.goTab((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domFC)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_tab__all",this._els.pageContainer)),null,!0),this.updateShuffleButton(),this.updateCurrentPlayingInfo(),this.updatePlayerClass(null)),this._initPlayer(!0);const s=e.getPlaylistsByType(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_MY).find((_=>_.getAudiosList().length)),a=s&&s.getAudiosList()[0];if(a&&(this._readyAudio=a,this._initPlayer(!0)),cur.audioPage){cur.audioPage._readyAudio=a,cur.audioPage._initPlayer(!0);try{const _=cur.audioPage._data.sectionData[cur.audioPage._currentSection].title;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setDocumentTitle)(_)}catch(_){}}_||this.updateStatusExport(),this.updateLayerHeight(),this._scroll.scrollTop(),e.notify(_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.PLAYLIST_CLEARED)},AudioPage.prototype.setTooltipTitle=function(_){if(_.titleSet)return;const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_title_performer",_),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_title_song",_);(e.scrollWidth>e.clientWidth||t.scrollWidth>t.clientWidth)&&_.setAttribute("title",_.innerText),_.titleSet=!0},AudioPage.prototype._initPlayer=function(_){const e=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("audio_player_redesign_web_enabled")||(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("redesign_audio_player_tooltip_dislikes_web_enabled"),t=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("audio_page_add_playlist_spinner"),i=this;if(e)return i._initPlayerRedesign();const o=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)(),s=this._els.pageContainer,a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_player",s),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_title",a),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_title_performer",a),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_title_song",a),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_title_song_title",a),u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_title_song_subtitle",a),c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_duration",a),E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_player__cover",a),h=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_player_play",a),P=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_play_blind_label",h),p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_btn_lyrics",a),b=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_player_add",a),g=a.querySelector(".audio_page_player_follow_radiostation");let O;function D(_){if(n)if(o.ads.isActive)d.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_audio_ad"),d.appendChild(makeAudioAdPerformerDivider()),d.appendChild(makeAudioDisableAdsLink()),n.innerHTML="",n.appendChild(makeAudioAdMoreLink()),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(a,"audio_song_is_explicit",!1);else{_web_audio_ui_AudioAdActionsModal_AudioAdActionsModalController__WEBPACK_IMPORTED_MODULE_41__.AudioAdActionsModalController.ensure().close();const e=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.getAudioPerformers(_);_=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(r,"display","block"),n.innerHTML=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player2")?e:_.performer,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isPodcast(_)?d.innerHTML=`<a href="/podcast${_.fullId}" onclick="return showPodcast(this, '${_.fullId}', event, 'player');" class="audio_player_podcast_title">${_.title}</a>`:d.innerHTML=_.hasTrackPage?`<a class="audio_page_player_title_link" href="/audio${_.trackPageId}">${_.title}</a>`:_.title,u.innerHTML=_.subTitle?_.subTitle:"";let t=null;(_.coverUrl_p||(0,_shared_audio_utils_isRadio__WEBPACK_IMPORTED_MODULE_35__.isRadio)(_))&&(t=_.coverUrl_p),t?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(E,"background-image","url("+t+")"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(E,"background-size","cover")):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(E,"background-image",null),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(E,"background-size","")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(a,"audio_title_long_performer",_.isLongPerformer),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(a,"audio_song_is_explicit",_.isExplicit);const s=(0,_shared_audioplayer_AudioPlayerAdapter_audioTuple_audioTupleToAudioObject__WEBPACK_IMPORTED_MODULE_39__.audioTupleToAudioObject)(o.getCurrentAudio());if(!i.isLayer()&&o.getCurrentAudio()&&s.fullId===_.fullId){const e=[_.performer,_.title].filter((_=>!!_)).join(" — ");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setDocumentTitle)((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.replaceEntities)((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.stripHTML)(e))),clearTimeout(window.pageSetTitleTimer)}r&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(r,"display","none"),n&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(n,"display","none"),requestAnimationFrame((()=>{const _=o.ads.isActive?"none":"block";r&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(r,"display",_),n&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(n,"display","block")}))}}function A(_,e){return(0,_shared_audio_formatters_formatAudioTime__WEBPACK_IMPORTED_MODULE_57__.formatAudioTime)({duration:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(e),progress:_,negative:AudioPlayer.getDurationType()})}function M(){if(!i._trackSlider)return;const _=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(o.getCurrentAudio()||i._readyAudio);if(!_)return;let e;p&&(p.disabled=!_.hasLyrics),e=_shared_ranges__WEBPACK_IMPORTED_MODULE_42__.Ranges.isGroupId(i.getOwnerId())&&i.canAddToGroup()?_.ownerId!=i.getOwnerId():_.ownerId!=vk.id,O!==e&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggle)(b,e),O=e);const t=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.getAddRestoreInfo();_&&t[_.fullId]&&"added"===t[_.fullId].state||_.ownerId===vk.id?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.addClass)(b,"audio_player_btn_added"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(b,"audio_player_btn_added"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.addClass)(b,"no_transition"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClassDelayed)(b,"no_transition"),i.updateRepeatButton()}if(!this._trackSlider){const _=o.ads?.isActive?o.ads.getCurrentProgress():o.getCurrentProgress(),e=o.ads?.isActive?0:o.getCurrentBuffered(),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_track_slider",a),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_volume_slider",a);i&&(this._trackSlider=new _web_legacy_ui_slider__WEBPACK_IMPORTED_MODULE_17__.default(i,{value:_,backValue:e,size:1,hintClass:"audio_player_hint",withBackLine:!0,formatHint:_=>{let e=o.getCurrentAudio()||this._readyAudio;return e=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(e),(0,_shared_lib_date__WEBPACK_IMPORTED_MODULE_58__.formatTime)(Math.round(_*(e?e.duration:0)))},onEndDragging:_=>{let e=o.getCurrentAudio()||this._readyAudio;e=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(e),e&&_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isPodcast(e)&&o.podcastSetActionRef(e,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.PodcastsLogs.ACTION_SEEK,"",a),o.seekBySlider(_)}}),o.ads.isActive&&(this._trackSlider.toggleAdState(!0),this.playerToggleAdsPlaying(!0))),s&&(this._volumeSlider=new _web_legacy_ui_slider__WEBPACK_IMPORTED_MODULE_17__.default(s,{value:o.getVolume(),size:1,hintClass:"audio_player_hint",log:!0,formatHint:_=>Math.round(100*_)+"%",onChange:_=>{o.setVolume(_)}})),[_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.MUSIC_AUDIOS_ADD,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.MUSIC_PLAYLISTS_ADD,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.MUSIC_OWNERS_FOLLOW,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.MUSIC_OWNERS_UNFOLLOW,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.CURATOR_FOLLOW,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.CURATOR_UNFOLLOW,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.PLACEHOLDER_REMOVE].forEach((_=>o.on(this,_,((e,t)=>{this.catalogController&&this.catalogController.emitEvent(_,t)})))),o.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.MUSIC_PLAYLISTS_ADD,((_,e)=>{const{playlists:t,playlistsIndex:i}=this._data;Array.isArray(t)&&t.find((_=>_.id===e.id&&_.owner_id===e.owner_id))||(t&&(t.unshift(e),i&&i.add(e)),this.updatePlaylistsCounter(vk.id))})),o.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.AD_STARTED,((_,e)=>{this.playerToggleAdsPlaying(!0),this._trackSlider&&(this._trackSlider.toggleAdState(!0),this._trackSlider.setBackValue(0))})),o.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.AD_COMPLETED,(()=>{this.playerToggleAdsPlaying(!1),this._trackSlider&&this._trackSlider.toggleAdState(!1)})),o.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.START_LOADING,(()=>{this._trackSlider&&this._trackSlider.toggleLoading(!0)})),o.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.CAN_PLAY,(()=>{this._trackSlider&&this._trackSlider.toggleLoading(!1)})),o.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.RADIOSTATION_FOLLOW,((_,e)=>{const t=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(_);(0,_shared_audio_utils_isRadio__WEBPACK_IMPORTED_MODULE_35__.isRadio)(t)&&t.id===e&&g.classList.add(AudioPage.followedRadioClassName);const i=this._els.pageContainer.querySelectorAll(`.AudioRadiostationItem[data-id='${e}']`);Array.from(i).forEach((_=>{_.classList.add("AudioRadiostationItem--followed")}))})),o.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.RADIOSTATION_UNFOLLOW,((_,e)=>{const t=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(_);(0,_shared_audio_utils_isRadio__WEBPACK_IMPORTED_MODULE_35__.isRadio)(t)&&t.id===e&&g.classList.remove(AudioPage.followedRadioClassName);const i=this._els.pageContainer.querySelectorAll(`.AudioRadiostationItem[data-id='${e}']`);Array.from(i).forEach((_=>{_.classList.remove("AudioRadiostationItem--followed")}))})),o.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.ADDED,((_,e)=>{(_=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(_))&&_.fullId==e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.addClass)(b,"audio_player_btn_added")})),o.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.REMOVED,((_,e)=>{(_=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(_))&&_.fullId==e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(b,"audio_player_btn_added")})),o.on(this,[_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.PLAY,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.PLAY_REQUESTED],((_,e,t)=>{this._destroyReadyAudio(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)(a,"audio",_),M(),_&&D(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.addClass)(h,"audio_playing"),e&&!cur.audioStartReadyAudio&&(this._trackSlider&&this._trackSlider.setBackValue(0),!o.ads.isActive&&c&&(c.innerHTML=A(0,_?_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(_).duration:0)),l&&(l.setAttribute("title",""),l.titleSet=!1)),P&&(P.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_audio_play")),this.updateCurrentPlayingInfo(),this.updateShuffleButton(),this.updateFaveButton(),this.updateRadioFollowBtn()})),o.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.PAUSE,(()=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(h,"audio_playing"),P&&(P.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_audio_play"))})),o.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.STOP,(()=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(h,"audio_playing"),P&&(P.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_audio_play"))})),o.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.BUFFERED,((_,e)=>{this._trackSlider&&this._trackSlider.setBackValue(e)})),o.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.VOLUME,((_,e)=>{this._volumeSlider&&this._volumeSlider.setValue(e,!0)})),o.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.ENDED,(()=>{this._trackSlider&&this._trackSlider.toggleLoading(!1)})),o.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.UPDATE,((_,e)=>{_&&(_&&D(_),this.updatePlayerClass(_),this.updateRadioFollowBtn()),o.ads.isActive||_&&e&&c&&(c.innerHTML=A(e,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(_).duration))})),o.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.PROGRESS,((_,e,t)=>{this._trackSlider&&(this._trackSlider.toggleLoading(!1),this._trackSlider.setValue(e)),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.isUndefined)(t)||isNaN(t)||!c||(c.innerHTML=A(e,t))})),o.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.FAILED,(()=>{this._trackSlider&&this._trackSlider.toggleLoading(!1)})),o.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.CURRENT_CHANGED,(()=>{const _=o.getCurrentAudio()||this._readyAudio;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(this._els.player,"audio",JSON.stringify(_)),D(_),this.updatePlayerClass(_),this._trackSlider&&this._trackSlider.setValue(0)})),t&&(o.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.PLAYLIST_START_LOADING,((_,e,t)=>{document.querySelector(`._audio_pl_${e}_${t}`).classList.add("audio_pl__loading")})),o.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.PLAYLIST_FINISH_LOADING,((_,e,t)=>{document.querySelector(`._audio_pl_${e}_${t}`).classList.remove("audio_pl__loading")})))}const C=o.getCurrentAudio()||this._readyAudio;C&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(a,"audio",JSON.stringify(C)),D(C),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(h,"audio_playing",o.isPlaying()),c&&(c.innerHTML=A(1,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(C).duration)),_&&this._trackSlider&&(this._trackSlider.setValue(0),this._trackSlider.setBackValue(0),this._trackSlider.toggleLoading(!1))),M();const y=o.getCurrentAudio()||this._readyAudio;this.updatePlayerClass(y),this.isLayer()||this._initFixedPlayer()},AudioPage.prototype._initPlayerRedesign=function(){if(!((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("audio_player_redesign_web_enabled")||(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("redesign_audio_player_tooltip_dislikes_web_enabled")))return;const _=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("dislikes_web_enabled")||(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("redesign_audio_player_tooltip_dislikes_web_enabled"),e=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("audio_page_add_playlist_spinner"),t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)();if(!t)return;[_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.MUSIC_AUDIOS_ADD,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.MUSIC_PLAYLISTS_ADD,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.MUSIC_OWNERS_FOLLOW,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.MUSIC_OWNERS_UNFOLLOW,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.CURATOR_FOLLOW,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.CURATOR_UNFOLLOW,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.PLACEHOLDER_REMOVE].forEach((_=>t.on(this,_,((e,t)=>{this.catalogController&&this.catalogController.emitEvent(_,t)})))),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.MUSIC_PLAYLISTS_ADD,((_,e)=>{const{playlists:t,playlistsIndex:i}=this._data;Array.isArray(t)&&t.find((_=>_.id===e.id&&_.owner_id===e.owner_id))||(t&&(t.unshift(e),i&&i.add(e)),this.updatePlaylistsCounter(vk.id))})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.RADIOSTATION_FOLLOW,((_,e)=>{const t=this._els.pageContainer.querySelectorAll(`.AudioRadiostationItem[data-id='${e}']`);Array.from(t).forEach((_=>{_.classList.add("AudioRadiostationItem--followed")}))})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.RADIOSTATION_UNFOLLOW,((_,e)=>{const t=this._els.pageContainer.querySelectorAll(`.AudioRadiostationItem[data-id='${e}']`);Array.from(t).forEach((_=>{_.classList.remove("AudioRadiostationItem--followed")}))})),t.on(this,[_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.PLAY,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.PLAY_REQUESTED],((_,e,t)=>{this._destroyReadyAudio(),this.updateCurrentPlayingInfo()})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.UPDATE,((_,e)=>{_&&this.updatePlayerClass(_)})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.CURRENT_CHANGED,(()=>{const _=t.getCurrentAudio()||this._readyAudio;this.updatePlayerClass(_)})),_&&(t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.AUDIO_RESTORE_BY_DISLIKE_ACTION,((_,e)=>{if(!e)return;const t=this._els.sections.querySelectorAll(`.audio_row[data-full-id='${e}']`);Array.from(t).forEach((_=>{_.closest(".CatalogBlock__my_audios_block")||_.closest(".CatalogBlock__my_audios")?_.classList.remove("audio_row__deleted"):_.classList.add("audio_row__added")}))})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.AUDIO_DELETE_BY_DISLIKE_ACTION,((_,e)=>{if(!e)return;const t=this._els.sections.querySelectorAll(`.audio_row[data-full-id='${e}']`);Array.from(t).forEach((_=>{(_.closest(".CatalogBlock__my_audios_block")||_.closest(".CatalogBlock__my_audios"))&&_.classList.add("audio_row__deleted"),_.classList.remove("audio_row__added")}))})),e&&(t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.PLAYLIST_START_LOADING,((_,e,t)=>{document.querySelector(`._audio_pl_${e}_${t}`).classList.add("audio_pl__loading")})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.PLAYLIST_FINISH_LOADING,((_,e,t)=>{document.querySelector(`._audio_pl_${e}_${t}`).classList.remove("audio_pl__loading")}))));const i=t.getCurrentAudio()||this._readyAudio;this.updatePlayerClass(i)},AudioPage.prototype.followRadioFromPlayer=function(_){const e=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.getAudioFromEl(_,!0);if(!(0,_shared_audio_utils_isRadio__WEBPACK_IMPORTED_MODULE_35__.isRadio)(e))return;const t=e.id,i=(0,_shared_audio_utils_getAudioExtra__WEBPACK_IMPORTED_MODULE_36__.getAudioExtra)(e).faveHash;_.classList.contains(AudioPage.followedRadioClassName)?(0,_player_radiostation_unfollowRadiostation__WEBPACK_IMPORTED_MODULE_37__.unfollowRadiostation)(t,i):(0,_player_radiostation_followRadiostation__WEBPACK_IMPORTED_MODULE_38__.followRadiostation)(t,i)},AudioPage.prototype._initFixedPlayer=function(){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getSize)(this._els.playerWrap);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(this._els.playerWrap,{width:_[0],height:_[1]});const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getSize)(this._els.player);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(this._els.player,{width:e[0],height:e[1]});const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getSize)("page_header_wrap")[1],i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getXY)(this._els.contentBlock)[1],o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getXY)(this._els.playerWrap)[1]+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getSize)(this._els.playerWrap)[1]-t;let s,a,l=!1;const n=()=>{const _=(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_7__.scrollGetY)(),e=_>i;if(_<o&&(s||l))return clearTimeout(s),clearTimeout(a),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(this._els.player,"audio_page_player_fixed_shown"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(this._els.player,"audio_page_player_fixed"),void(l=s=!1);e&&!l&&(clearTimeout(s),s=0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.addClass)(this._els.player,"audio_page_player_fixed"),a=setTimeout((()=>(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.addClass)(this._els.player,"audio_page_player_fixed_shown"))),l=!0),!e&&l&&(clearTimeout(s),s=0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(this._els.player,"audio_page_player_fixed_shown"),s=setTimeout((()=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(this._els.player,"audio_page_player_fixed"),s=!1}),250),l=!1)};(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(window,"scroll",n),cur.destroy.push((()=>{n&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(window,"scroll",n)}))},AudioPage.prototype.togglePlayerPlay=function(_){const e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)();if(e.isPlaying()){const t=e.getCurrentAudio();t&&e.podcastSetActionRef(t,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.PodcastsLogs.ACTION_PAUSE,"",_),e.pauseByButton()}else{const t=this.getPageCurrentPlaylist(),i=e.getCurrentPlaylist(),o=e.getCurrentAudio(),s=e.getPlaylistQueue();let a=o||this._readyAudio;const l=()=>{if(!a)return;if(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isClaimedAudio(a)){a=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(a);const _=(0,_shared_audio_utils_getAudioExtra__WEBPACK_IMPORTED_MODULE_36__.getAudioExtra)(a).claim;return void(0,_web_lib_feature_boxes__WEBPACK_IMPORTED_MODULE_18__.showAudioClaimWarning)(a,_)}let o;o=i&&-1!==s.indexOfAudio(a)?i:t&&-1!==t.indexOfAudio(a)?t:new _web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_TEMP,vk.id),this._destroyReadyAudio(),cur.audioStartReadyAudio=!0,e.podcastSetActionRef(a,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.PodcastsLogs.ACTION_PLAY,"",_),e.playByButton({audio:a,playlist:o})};!a&&t?s.getAudioAt(0).then((_=>{a=_,l()})):l()}},AudioPage.prototype.promoAlbumSlideInit=function(){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_promo");if(this.isLayer()||!_)return;const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_promo__items",_);if(!e||e.children.length<=1)return;this.promoAlbumSlideAutoStart(e);const t=()=>this.promoAlbumSlideAutoStop(),i=()=>this.promoAlbumSlideAutoStart(e);(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(_,"mouseenter",t),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(_,"mouseleave",i),window.cur&&cur.destroy.push((()=>{this.promoAlbumSlideAutoStop(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(_,"mouseenter",t),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(_,"mouseleave",i)}))},AudioPage.prototype.promoAlbumSlideAutoStart=function(_){window.cur&&(cur._promoAlbumSlideTO=setTimeout((()=>this.promoAlbumSlide(_,1)),SLIDER_TIMEOUT))},AudioPage.prototype.promoAlbumSlideAutoStop=function(){window.cur&&clearTimeout(cur._promoAlbumSlideTO)},AudioPage.prototype.promoAlbumSlide=function(_,e){const t=vk.rtl?e>0?-1:1:e<0?-1:1,i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.gpeByClass)("audio_promo",_);if(!i)return;const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_promo__items",i);if(!o||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)(o,"sliding"))return;this.promoAlbumSlideAutoStop();const s=o.scrollLeft,a=o.offsetWidth,l=o.children,n=l.length,r=_=>vk.rtl?o.scrollWidth-_*a-a:_*a;if(!(l.length>1))return;this.promoAlbumSlideAutoStart(_);let d=!1,u=null,c=!1,E=Math.round(s/a);E+=t,E>=n||E<0?(d=l[0].cloneNode(!0),o.appendChild(d),E>=n?(c=!0,u=r(E)):E<0&&(o.scrollLeft=r(n),E=n-1,u=r(E))):u=r(E),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)(o,"sliding",!0),(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_3__.animate)(o,{scrollLeft:u},{duration:500,transition:_web_lib_fx__WEBPACK_IMPORTED_MODULE_3__.Fx.Transitions.swiftOut,onComplete:()=>{c&&(o.scrollLeft=r(0)),d&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.re)(d),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)(o,"sliding",!1)}})},AudioPage.prototype.handleAudioAdMoreClick=function(_){console.log(_,_.currentTarget)},AudioPage.prototype.playerToggleAdsPlaying=function(_){const e=this._els.player.classList;isAdPlayingWithChoices()&&e.toggle("audio_page_player_with_ad_choices",_),e.toggle("audio_page_player_ads_playing",_)},AudioPage.setVisibilitySectionsContent=function(_){cur.audioPage&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggle)(cur.audioPage._els.sections,_)};try{(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("Audio/Player/LyricsButton/Click",(_=>{const{target:e}=_.payload;if(e.disabled)return;const t=currentAudioPage(_.payload.target),i=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)(),o=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayerUI)(),s=i.getCurrentAudio()||t._readyAudio;s&&o.lyrics.open({audio:s,playlist:null,context:s.context})}))}catch(_){console.error(_)}try{(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("Audio/Catalog/RecommendationsPlaylists/Playlist/OpenButton/Click",(_=>{const{target:e,dataAttrs:t}=_.payload;!e.disabled&&t.options&&_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_50__.AudioPageProxy.ensure().emitter.emit(_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_50__.AudioPageEventType.AudioRecomsOnboardingShowRequested,{reason:_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_50__.AudioRecomsOnboardingShowRequestedEventReason.RecommendationsPlaylistOpenButton,payload:JSON.parse(t.options)})}))}catch(_){console.error(_)}try{(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("Audio/Catalog/RecommendationsPlaylists/Playlist/PlayButton/Click",(_=>{const{target:e,dataAttrs:t}=_.payload;!e.disabled&&t.options&&_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_50__.AudioPageProxy.ensure().emitter.emit(_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_50__.AudioPageEventType.AudioRecomsOnboardingShowRequested,{reason:_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_50__.AudioRecomsOnboardingShowRequestedEventReason.RecommendationsPlaylistPlayButton,payload:JSON.parse(t.options)})}))}catch(_){console.error(_)}try{(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("Audio/Catalog/VibeRecommendationsPlaylists/Playlist/PlayButton/Click",(_=>{const{target:e,dataAttrs:t}=_.payload;!e.disabled&&t.options&&_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_50__.AudioPageProxy.ensure().emitter.emit(_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_50__.AudioPageEventType.AudioRecomsOnboardingShowRequested,{reason:_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_50__.AudioRecomsOnboardingShowRequestedEventReason.VibeRecommendationsPlaylistPlayButton,payload:JSON.parse(t.options)})}))}catch(_){console.error(_)}},618030:(_,e,t)=>{t.d(e,{default:()=>r});var i=t(255693),o=t(43129),s=t(70689),a=t(636322),l=t(93367);function n(_,e,t){if((0,a.isObject)(e)?t=e:this._dragElClass=e,this.options=(0,a.extend)({dragThreshold:n.DRAG_THRESHOLD_DIST},t),this._contEl=(0,s.ge)(_),this._contEl){this._excludedCount=0;for(let _=0;_<this._contEl.children.length;_++)this._contEl.children[_].getAttribute("nodrag")&&this._excludedCount++;(0,l.addEvent)(this._contEl,"mousedown",this._ev_mousedown_handler=this._onMouseDown.bind(this)),(0,s.setStyle)(this._contEl,"position","relative"),this._inited=!0,this._updateScrollbar=this._initUpdaterScrollbar()}}n.AUTO_SCROLL_DY=10,n.DRAG_THRESHOLD_DIST=0,n.AUTO_SCROLL_DISTANCE_THRESHOLD=300,n.AUTO_SCROLL_GAP=300,n.prototype.destroy=function(){this._inited&&(this._inited=!1,this._deinitEvents(!0))},n.prototype._getParentDragItemEl=function(_){let e,t=_;for(;t&&(e=(0,s.domPN)(t))!==this._contEl;)t=e;return t===this._curPlaceholderEl&&(t=null),t},n.prototype._onKey=function(_){_.keyCode===l.KEY.ESC&&this.isCurrentlyDragging()&&this._onMouseUp()},n.prototype.forceFinishDrag=function(_){this.isCurrentlyDragging()?(this.onDragFinish=_,this._onMouseUp(!0)):_()},n.prototype._onMouseDown=function(_){if(this._disabled||0!=_.button||this._curDragEl||(0,s.attr)(_.target,"nodrag")||this._dragElClass&&!(0,s.domClosest)(this._dragElClass,_.target))return;let e=_.target;for(;e&&e!==window.document;){if((0,a.intval)((0,s.domData)(e,"nodrag")))return;e=(0,s.domPN)(e)}const t=this._getParentDragItemEl(_.target);if(!t||(0,s.attr)(t,"nodrag"))return;if((0,s.re)((0,s.geByClass1)("ui_gridsorter_placeholder"),this._contEl),this._contInfo=this._contInfo||{prevSize:(0,s.getSize)(this._contEl)},this._ensureGridIsActual(),this._grid.length<=1)return;const i=window.getComputedStyle(t),o=(0,s.getXY)(t);this._initial={candidateEl:t,x:_.clientX,y:_.clientY,itemMargin:{x:parseInt(i.marginLeft),y:parseInt(i.marginTop)},shift:{x:_.pageX-o[0],y:_.pageY-o[1]}},(0,l.addEvent)(document,"mousemove",this._ev_mousemove_handler=this._onMouseMove.bind(this)),(0,l.addEvent)(document,"mouseup",this._ev_mouseup_handler=this._onMouseUp.bind(this)),(0,l.addEvent)(document,"keydown",this._ev_keydown_handler=this._onKey.bind(this)),cur.cancelClick=!1,(0,l.cancelEvent)(_)},n.prototype._dist=function(_){return Math.abs(_.clientX-this._initial.x)+Math.abs(_.clientY-this._initial.y)},n.prototype._onMouseUp=function(_){const e=this._curDragEl;let t=!_;if(!0===_&&(_=void 0),this._curDragEl){this._curDragEl=null,(0,s.removeClass)(e,"ui_gridsorter_moveable_notrans"),this._curOverCell||(this._curOverCell={el:this._curPlaceholderEl,pos:(0,s.getXY)(this._curPlaceholderEl),size:(0,s.getSize)(this._curPlaceholderEl)});const i=this._curOverCell.pos,o=this._curOverCell.el,a=this._grid[this._curDragCellIndex],n=a&&a.size;(0,s.gpeByClass)("_ape_item_list",e)&&(i[0]+=20,i[1]+=20),n&&this._isShiftToLeft&&(i[1]-=n[1]-this._curOverCell.size[1]),setTimeout((()=>{if(t){for(let _=0,e=this._grid.length;_<e;_++){const e=this._grid[_];e.dirty&&this._setPos(e.el,{left:0,top:0})}this._setPos(e,this._initialCurDragPos)}else this._setPos(e,{left:i[0],top:i[1]})})),setTimeout((()=>{if((0,s.re)(this._curPlaceholderEl),(0,s.removeClass)(this._contEl,"ui_gridsorter_cont"),this.options.dragCls&&(0,s.removeClass)(e,this.options.dragCls),!this._inited)return;let _;if(t){let _=this._grid.length;for(let e=0;e<_;e++){const _=this._grid[e];_.dirty&&this._setPos(_.el,{left:null,top:null})}this._setPos(e,{left:null,top:null,width:null,height:null})}else{let t;_=this._isShiftToLeft?(0,s.domNS)(o):o,this._contEl.insertBefore(e,_);let i=-1,a=this._initial.hasInlineSize;this._setPos(e,{left:null,top:null}),a||(0,s.setStyle)(e,{width:null,height:null});let l=this._grid.length;for(let _=0;_<l;_++){const l=this._grid[_];(l.dirty||l.el===e)&&(this._setPos(l.el,{left:null,top:null}),a||(0,s.setStyle)(l.el,{width:null,height:null}),l.pos=this._calcElementPos(l.el),l.dirty=!1),l.el===e?t=_:l.el===o&&(i=_)}if(i>=0){const _=this._grid.splice(t,1);this._grid.splice(i,0,_[0])}}(0,s.removeClass)(e,"ui_gridsorter_moveable"),this._curOverCell=this._curPlaceholderEl=null,t&&this.update(),this.options.onDragFinish&&this.options.onDragFinish(e),o!==e&&!t&&this.options.onReorder&&this.options.onReorder(e,_,(0,s.domPS)(e)),this.onDragFinish&&(this.onDragFinish(),this.onDragFinish=void 0)}),210),_&&this._dist(_)>5&&((0,l.cancelEvent)(_),cur.cancelClick=!0)}this._updateScrollbar(),this._deinitEvents(),e&&this._overEl&&this.options.onDragLeave&&this.options.onDragLeave(this._overEl,e),t||e&&this._overEl&&this.options.onDragDrop&&(t=this.options.onDragDrop(this._overEl,e)),this._overEl=null},n.prototype._deinitEvents=function(_){_&&(this._onMouseUp(),(0,l.removeEvent)(this._contEl,"mousedown",this._ev_mousedown_handler)),clearTimeout(this._autoScrollTO),this._autoScrollTO=!1,this._ev_mousemove_handler&&(0,l.removeEvent)(document,"mousemove",this._ev_mousemove_handler),this._ev_mouseup_handler&&(0,l.removeEvent)(document,"mouseup",this._ev_mouseup_handler),this._ev_keydown_handler&&(0,l.removeEvent)(document,"keydown",this._ev_keydown_handler)},n.prototype._setPos=function(_,e){this.options.noPosTransform||!this._hasTranslateFeauture&&!(this._hasTranslateFeauture=window.getComputedStyle(_).getPropertyValue("transform"))?(0,s.setStyle)(_,(0,a.extend)({transform:null},e)):null===e.left||null===e.top?(0,s.setStyle)(_,{transform:null,top:null,left:null}):(0,s.setStyle)(_,{transform:"translate("+e.left+"px, "+e.top+"px)",top:null,pos:null})},n.prototype._recalc=function(){const _=this._curDragEl,e=this._curOverCell.el;if(this._initGrid(),e===_){let e=this._grid.length;for(let t=0;t<e;t++){const e=this._grid[t];e.el!==_&&e.dirty&&(e.dirty=!1,this._setPos(e.el,{left:null,top:null}))}return}let t=0,i=!1,o=!1,s=this._grid.length;for(let t=0;t<s;t++){const o=this._grid[t];if(o.el===_){i=!0;break}if(o.el===e){i=!1;break}}this._isShiftToLeft=i;let a=i?0:this._grid.length-1,l=i?this._grid.length:-1,n=i?1:-1,r=[0,0];for(;a!==l;a+=n){const s=this._grid[a];if(2!==t)if(s.el!==_){if(s.el===e&&t++,1===t||2===t){let _=0,e=0;i?(_=o.pos[0]+r[0],e=o.pos[1]+r[1],r[0]+=s.size[0]-o.size[0],r[1]+=s.size[1]-o.size[1]):(r[0]+=o.size[0]-s.size[0],r[1]+=o.size[1]-s.size[1],_=o.pos[0]+r[0],e=o.pos[1]+r[1]),this._setPos(s.el,{left:_-s.pos[0],top:e-s.pos[1]}),s.dirty=!0}else s.dirty&&(this._setPos(s.el,{left:null,top:null}),s.dirty=!1);o=s}else t++,o=s;else s.dirty&&(this._setPos(s.el,{left:null,top:null}),s.dirty=!1),o=s}},n.prototype.disable=function(){this._disabled=!0},n.prototype.enable=function(){this._disabled=!1,this._initGrid(!0)},n.prototype.update=function(){this._disabled||this._initGrid(!0)},n.prototype._ensureGridIsActual=function(){this._initGrid()},n.prototype._needGridUpdate=function(){if(!this._grid)return 1;this._contInfo.prevSize=this._contInfo.prevSize||(0,s.getSize)(this._contEl);let _=0,e=this._contEl.children.length-this._excludedCount-(0,a.intval)(!!this._curPlaceholderEl);if(e!==this._grid.length)_=e>this._grid.length?2:1,this._contInfo.prevSize=(0,s.getSize)(this._contEl);else{let e=(0,s.getSize)(this._contEl),t=this._contInfo.prevSize;(Math.abs(t[0]-e[0])>5||Math.abs(t[1]-e[1])>5)&&(_=1),this._contInfo.prevSize=e}return _},n.prototype._initGrid=function(_){let e=_?1:this._needGridUpdate();if(!e)return;1===e&&(this._grid=[],this._contInfo&&(delete this._contInfo.pos,delete this._contInfo.size));let t=this._grid?this._grid[this._grid.length-1]:null;this._grid=this._grid||[];let i,o=!!t,a=this._contEl.children;if(!a.length)return;let l=this._getItemMargins();for(let _=this._curDragEl?this._grid.length:0,e=a.length;_<e;_++){let e=a[_];t&&e===t.el?o=!1:o||e===this._curPlaceholderEl||e.getAttribute("nodrag")||(i=(0,s.getSize)(e),i[0]+=l[0],i[1]+=l[1],this._grid.push({el:e,size:i,pos:this._calcElementPos(e)}))}},n.prototype._getRelativeMousePos=function(_){let e=this._getContPos(),t=this._getContShift();return{left:_.clientX-e[0]-t[0],top:_.clientY-e[1]-t[1]}},n.prototype._updateDraggablePosition=function(_){if(!this._curDragEl)return;let e=this._getRelativeMousePos(_),t=this._getItemShift(),i=this._getContShift(),o=this._getContSize(),a=e.top-this._initial.shift.y-t[1]+i[1];this.options.limitBottomMove&&(a=Math.min(a,o[1]+30)),(0,s.hasClass)(this._contEl,"_ape_item_list")&&(a+=this._contEl.scrollTop),this._setPos(this._curDragEl,{left:e.left-this._initial.shift.x-t[0]+i[0],top:a}),window.AudioPage&&window.AudioPage.onUpdateDraggablePosition&&window.AudioPage.onUpdateDraggablePosition()},n.prototype._getContShift=function(){if(this._contInfo=this._contInfo||{},!this._contInfo.shift){let _=window.getComputedStyle(this._contEl);this._contInfo.shift=[parseFloat(_.paddingLeft),parseFloat(_.paddingTop)]}return this._contInfo.shift},n.prototype._getContSize=function(){return this._contInfo=this._contInfo||{},this._contInfo.size=(0,s.getSize)(this._contEl),this._contInfo.size},n.prototype._getContPos=function(){return this._contInfo=this._contInfo||{},this._contInfo.pos=(0,s.getXY)(this._contEl),this._contInfo.pos[1]-=(0,i.scrollGetY)(),this._contInfo.pos},n.prototype._getItemShift=function(){if(this._contInfo=this._contInfo||{},!this._contInfo.itemShift){let _=window.getComputedStyle((0,s.domFC)(this._contEl));this._contInfo.itemShift=[parseFloat(_.marginLeft),parseFloat(_.marginTop)]}return this._contInfo.itemShift},n.prototype._getItemMargins=function(){if(this._contInfo=this._contInfo||{},!this._contInfo.itemMargins){let _=window.getComputedStyle((0,s.domFC)(this._contEl));this._contInfo.itemMargins=[parseFloat(_.marginLeft)+parseFloat(_.marginRight),parseFloat(_.marginTop)+parseFloat(_.marginBottom)]}return this._contInfo.itemMargins},n.prototype._calcElementPos=function(_){let e=this._getContShift(),t=this._getItemShift();return[_.offsetLeft-e[0]-t[0],_.offsetTop-e[1]-t[1]]},n.prototype.isCurrentlyDragging=function(){return!!this._curDragEl},n.prototype._initUpdaterScrollbar=function(){return(0,o.throttle)((_=>{const e=this.options.wrapNode||_;let t=(0,s.data)(e,"sb");t&&t.update(!1,!0)}),500)},n.prototype._onMouseMove=function(_){const e=()=>this.options.wrapNode?this.options.wrapNode.scrollTop:(0,i.scrollGetY)(),t=_=>{this.options.wrapNode?this.options.wrapNode.scrollTop=_:(0,i.scrollToY)(_,0,!1,!0)};if(this._curDragEl){this._ensureGridIsActual(),!_&&(_={clientX:this._lastMousePos.x,clientY:this._lastMousePos.y}),this._lastMousePos={x:_.clientX,y:_.clientY},this._updateDraggablePosition(_);let o=this._getContSize(),a=this._getRelativeMousePos(_),l=!1;if((0,s.hasClass)(this._contEl,"_ape_item_list")&&(a.top+=this._contEl.scrollTop),a.left>0&&a.left<o[0]&&a.top>0&&a.top<o[1]){let _=0,e=this._grid.length-1,t=50;for(;t;){let i=_+Math.floor((e-_)/2);const o=this._grid[i];if(a.left>o.pos[0]&&a.top>o.pos[1]&&a.left<o.pos[0]+o.size[0]&&a.top<o.pos[1]+o.size[1]){l=o;break}if(_===e)break;a.top<o.pos[1]||a.left<o.pos[0]&&a.top<o.pos[1]+o.size[1]?e=e===i?e-1:i:_=_===i?_+1:i,t--}}else{let _,e,t,i=this._grid.length,o=999999;for(let s=0;s<i;s++){const i=this._grid[s];e=a.left-(i.pos[0]+i.size[0]/2),t=a.top-(i.pos[1]+i.size[1]/2);const l=e*e+t*t;o>l&&(o=l,_=i)}l=_}!l||this._curOverCell&&this._curOverCell.el===l.el||(this._curOverCell=l,this._recalc());{let o,a,l,n,r=0;if(this.options.wrapNode)o=n=this.options.wrapNode,a=(0,s.getSize)(o),l=(0,s.getXY)(o),l[1]-=(0,i.scrollGetY)(),r=_.clientY;else{let e=window,t=document.documentElement,i=document.body,o=e.innerWidth||t.clientWidth||i.clientWidth,s=e.innerHeight||t.clientHeight||i.clientHeight;n=e.bodyNode,a=[o,s],l=[0,0],r=_.clientY}let d=Math.max(20,a[1]/10),u=l[1]+d-r,c=d-(l[1]+a[1]-r);if(c>0||u>0){let _=Math.min(1,u/d),i=Math.min(1,c/d);this._autoScrollTO||(this._autoScrollTO=setTimeout((()=>{this._autoScrollTO=!1;let o=e();t(o+16*(_>0?-_:i)),o!==n.scrollTop&&(this._updateScrollbar(n),this._onMouseMove())}),20))}}if(this.options.onDragOverElClass){let e=_.target;(0,s.hasClass)(e,this.options.onDragOverElClass)||(e=(0,s.gpeByClass)(this.options.onDragOverElClass,e))?this._overEl!==e&&(this._overEl&&this.options.onDragLeave&&this.options.onDragLeave(this._overEl,this._curDragEl),this.options.onDragEnter&&this.options.onDragEnter(e,this._curDragEl),this._overEl=e):(this._overEl&&this.options.onDragLeave&&this.options.onDragLeave(this._overEl,this._curDragEl),this._overEl=null)}}else if(this._dist(_)>this.options.dragThreshold){this._curDragEl=this._initial.candidateEl;let e=this._grid.length;for(let _=0;_<e;_++)if(this._grid[_].el===this._curDragEl){this._curDragCellIndex=_;break}this.options.dragCls&&(0,s.addClass)(this._curDragEl,this.options.dragCls);const t=(0,s.getSize)(this._curDragEl),i=(0,s.getXY)(this._curDragEl),o=window.getComputedStyle(this._curDragEl),a=this._getContPos();this._initial.hasInlineSize=!(!this._curDragEl.style.width&&!this._curDragEl.style.height),(0,s.setStyle)(this._curDragEl,{width:t[0],height:t[1]}),this._initialCurDragPos={left:i[0]-a[0],top:i[1]-a[1]-document.body.scrollTop},this._curPlaceholderEl=(0,s.ce)("div",{className:"ui_gridsorter_placeholder"}),(0,s.setStyle)(this._curPlaceholderEl,{width:t[0]+parseFloat(o.marginLeft)+parseFloat(o.marginRight),height:t[1]+parseFloat(o.marginTop)+parseFloat(o.marginBottom)}),this._contEl.insertBefore(this._curPlaceholderEl,this._curDragEl),(0,s.addClass)(this._curDragEl,"ui_gridsorter_moveable"),(0,s.addClass)(this._curDragEl,"ui_gridsorter_moveable_notrans"),(0,s.addClass)(this._contEl,"ui_gridsorter_cont"),this._onMouseMove(_),this._updateDraggablePosition(_),this.options.onDragStart&&this.options.onDragStart(this._curDragEl)}(0,l.cancelEvent)(_)};const r=n},516787:(_,e,t)=>{t.d(e,{ON_BOARDING_BG_RECT_ID:()=>n,default:()=>u});var i=t(70689),o=t(93367),s=t(255693),a=t(765353),l=t(977070);const n="onboarding_bg_rect",r="page_header_cont",d="onboarding";class u{initOnboardingBG(){if(!window.onboardingBG){let _='\n<div id="onboarding_layout">\n  <svg id="onboarding_bg_header" width="100%" height="49px">\n    <rect id="onboarding_bg_rect" class="GroupOnboardingBg" x="0" y="0" width="100%" height="100%" fill-opacity="0.8" fill="#000"></rect>\n  </svg>\n  <svg id="onboarding_bg" width="100%" height="100%">\n  <defs>\n    <mask id="mask" x="0" y="0" width="100%" height="100%">\n      <rect x="0" y="0" width="100%" height="100%" fill="#fff"></rect>\n      <rect id="onboarding_bg_clip" class="GroupOnboardingBgClip" x="0" y="0" width="0" height="0" fill="#000" rx="8" ry="8"></rect>\n    </mask>\n  </defs>\n  <rect id="onboarding_bg_rect" class="GroupOnboardingBg" x="0" y="42" width="100%" height="100%" mask="url(#mask)" fill-opacity="0.8"></rect>\n  </svg>\n</div>\n      ',e=(0,i.se)(_);(0,i.domInsertBefore)(e,window.layerBG),window.onboardingBGHeader=(0,i.ge)("onboarding_bg_header"),window.onboardingBG=(0,i.ge)("onboarding_bg"),window.onboardingBGRect=(0,i.ge)(n),window.onboardingBGClip=(0,i.ge)("onboarding_bg_clip"),window.cur.destroy.push((()=>{(0,i.hide)(window.onboardingBG),(0,i.hide)(window.onboardingBGHeader),(0,i.removeClass)((0,i.ge)(r),d),this.hideDarkness=!0,this.hideTT(),delete window.onboardingBG,delete window.onboardingBGHeader,delete window.onboardingBGRect,delete window.onboardingBGClip,this.opts.onBGClick&&(0,o.removeEvent)(window.onboardingBG,"click",this.opts.onBGClick)}))}this.opts.onBGClick&&(0,o.addEvent)(window.onboardingBG,"click",this.opts.onBGClick)}showTT(){const[,_]=(0,i.getXY)(this.el);this.tt=new l.ElementTooltip(this.el,this.ttParams),this.opts.highlight&&(this.addDarkness(),this.addHighlight()),this.tt.show();const e=this.tt.getContent();(0,a.isElementInViewport)(this.el)&&(0,a.isElementInViewport)(e)||(0,s.scrollToY)(_-42-this.ttParams.scrollOffset)}hideTT(){this.tt&&(this.tt.destroy(),this.removeDarkens(),this.hideDarkness&&((0,o.removeEvent)(window,"scroll"),(0,o.removeEvent)(window,"resize")),this.opts.onBGClick&&window.onboardingBG&&(0,o.removeEvent)(window.onboardingBG,"click",this.opts.onBGClick),this.opts.onHide&&this.opts.onHide())}addHighlight(){window.onboardingBGClip&&(this.highlightElement(),(0,o.addEvent)(window,"scroll",this.onScrollTT.bind(this)),(0,o.addEvent)(window,"resize",this.onResizeTT.bind(this)))}highlightElement(){let _=this.el.offsetWidth,e=this.el.offsetHeight,t=(0,i.getXY)(this.el);(0,i.attr)(window.onboardingBGClip,"width",_+this.border[1]+this.border[3]),(0,i.attr)(window.onboardingBGClip,"height",e+this.border[0]+this.border[2]),(0,i.attr)(window.onboardingBGClip,"x",t[0]-this.border[1]),(0,i.attr)(window.onboardingBGClip,"y",t[1]-this.border[0])}onResizeTT(){this.setDartToFullWidth(),this.highlightElement()}onScrollTT(){let _=this.getPageHeight();window.onboardingBG.height!=_&&this.setDartToFullHeight()}setDartToFullHeight(){(0,i.attr)(window.onboardingBG,"height",this.getPageHeight())}setDartToFullWidth(){(0,i.attr)(window.onboardingBG,"width",this.getPageWidth()),(0,i.attr)(window.onboardingBGHeader,"width",this.getPageWidth())}addDarkness(){(0,i.isVisible)(window.onboardingBG)||(this.setDartToFullHeight(),this.setDartToFullWidth(),(0,i.show)(window.onboardingBG),(0,i.isVisible)(window.onboardingBGHeader)||((0,i.show)(window.onboardingBGHeader),(0,i.addClass)((0,i.ge)(r),d)))}removeDarkens(){this.hideDarkness&&((0,i.hide)(window.onboardingBG),(0,i.hide)(window.onboardingBGHeader),(0,i.removeClass)((0,i.ge)(r),d))}ttOnHide(){this.hideTT()}show(){setTimeout(this.showTT.bind(this),1e3)}getPageWidth(){const _=document.documentElement,e=document.body;return Math.max(e.scrollWidth,_.scrollWidth,e.offsetWidth,_.offsetWidth,e.clientWidth,_.clientWidth)}getPageHeight(){const _=document.documentElement,e=document.body;return Math.max(e.scrollHeight,_.scrollHeight,e.offsetHeight,_.offsetHeight,e.clientHeight,_.clientHeight)}constructor(_,e,t={}){this.el=_,this.text=e,this.hideDarkness=!0,this.oldColor=!1;let i={autoShow:!1,noAutoHideOnWindowClick:t.noAutoHideOnWindowClick??!0,content:e instanceof HTMLElement?e:`${e}`,cls:`feature_intro_tt tutorial_tip_tt ${(()=>{const _=t.class??"";return t.tooltipWhite?_:_+" feature_intro_blue_tt"})()}`,appendToParent:!0,onHide:this.ttOnHide.bind(this),scrollOffset:t.scrollOffset||0,align:t.align||l.ElementTooltip.ALIGN_CENTER};t.side&&(i.forceSide=t.side),t.offset&&(i.offset=t.offset),t.width&&(i.width=t.width),t.shift&&(i.centerShift=t.shift),t.border?this.border=t.border:this.border=[10,10,10,10],t.ttOnHide&&(i.onHide=t.ttOnHide),t.withCloseButton&&(i.withCloseButton=t.withCloseButton,i.onCloseButtonClick=t.onCloseButtonClick),t.align&&(i.align=t.align),this.ttParams=i,this.opts=t,this.initOnboardingBG()}}},765353:(_,e,t)=>{function i(_){const e=_.getBoundingClientRect();return e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)}function o(_,e){return`<b>${_}</b><br/>${e}`}t.d(e,{buildTooltipeContent:()=>o,isElementInViewport:()=>i})},673067:(_,e,t)=>{t.d(e,{default:()=>r});var i=t(70689),o=t(471828),s=t(636322),a=t(93367),l=t(198448);function n(_,e){if(this.constructor!=n)throw new Error("Slider was called without 'new' operator");if(!_)throw new Error("No element was provided for Slider");_=(0,i.ge)(_),this.options=e||{size:1},this.options.backValue=this.options.backValue||0;const t=100*this.options.backValue,o=`<div class="slider_slide"><div class="slider_loading_bar" style="opacity: 0; display: none;"></div> ${this.options.withBackLine?'<div class="slider_back" style="width:'+t+'%"></div>':""} <div class="slider_amount"></div> <div class="slider_handler"></div> </div>`;this._el=(0,i.ce)("div",{innerHTML:o,className:"slider",id:_.getAttribute("id")||""});const r=_.classList||[],d=this;for(let _=0,e=r.length;_<e;_++)(0,i.addClass)(this._el,r[_]);(0,s.each)(this._el.attributes,(function(_,e){"id"==e.name&&"class"==e.name||d._el.setAttribute(e.name,e.value)})),_.parentNode.replaceChild(this._el,_),(0,i.data)(this._el,"slider",this),this._amountEl=(0,i.geByClass1)("slider_amount",this._el),this._handlerEl=(0,i.geByClass1)("slider_handler",this._el),this._slideEl=(0,i.geByClass1)("slider_slide",this._el),this._backEl=(0,i.geByClass1)("slider_back",this._el),this._progressEl=(0,i.geByClass1)("slider_loading_bar",this._el),this.options.color&&((0,i.setStyle)(this._amountEl,{backgroundColor:this.options.color}),(0,i.setStyle)(this._handlerEl,{backgroundColor:this.options.color})),this.options.handlerColor&&(0,i.setStyle)(this._handlerEl,{backgroundColor:this.options.handlerColor}),this.options.backColor&&(0,i.setStyle)(this._slideEl,{backgroundColor:this.options.backColor}),(0,i.addClass)(this._el,"slider_size_"+this.options.size),this.options.debounce&&(this._onValueChangeDebounced=(0,l.debounce)(this._onValueChange,this.options.debounce)),e.formatHint&&((0,a.addEvent)(this._el,"mousemove",this._ev_onMouseOver=this._onMouseOver.bind(this)),(0,a.addEvent)(this._el,"mouseleave",this._ev_onMouseLeave=this._onMouseLeave.bind(this))),(0,a.addEvent)(this._el,"mousedown",this._ev_onMouseDown=this._onMouseDown.bind(this)),this.setValue(this.options.value||0,!this.options.fireChangeEventOnInit,!1),this.setBackValue(this.options.backValue)}n.prototype.toggleAdState=function(_){this._adState=!!_,(0,i.toggleClass)(this._el,"slider_ad_mode",!!_)},n.prototype.toggleAdMarker=function(_){_=!!_;let e=(0,i.geByClass1)("slider_ad_marker",this._el);if(_){if(!e){const _="onmouseover=\"showTooltip(this, {text: '"+o.getLang("global_audio_ad")+"', black: 1, shift: [16, 9, 10]})\"";e=(0,i.se)('<div class="slider_ad_marker_wrap" '+_+'><div class="slider_ad_marker"></div></div>'),(0,i.domPN)(this._slideEl).insertBefore(e,this._slideEl),delete this._width,(0,i.addClass)(this._el,"slider_ad_marker_shown")}}else(0,i.re)(e),delete this._width,(0,i.removeClass)(this._el,"slider_ad_marker_shown")},n.prototype.showAdMarker=function(_){const e=(0,i.se)('<div class="slider_ad_marker"></div>');(0,i.domPN)(this._slideEl).insertBefore(e,this._slideEl),delete this._width,(0,i.addClass)(this._el,"slider_ad_marker_shown")},n.prototype.isAdMode=function(){return(0,i.hasClass)(this._el,"slider_ad_mode")},n.prototype.setBlocked=function(_){this.blocked=_,(0,i.toggleClass)(this._el,"slider_blocked",_)},n.prototype.getBlocked=function(){return this.blocked},n.prototype.isBlocked=function(){return this.isAdMode()||this.getBlocked()},n.prototype.toggleLoading=function(_){_=!!_,(0,i.toggle)(this._progressEl,_),(0,i.setStyle)(this._progressEl,"opacity",_?1:0)},n.prototype.destroy=function(_){this.options.formatHint&&((0,a.removeEvent)(this._el,"mousemove",this._ev_onMouseOver),(0,a.removeEvent)(this._el,"mouseleave",this._ev_onMouseLeave),(0,a.removeEvent)(this._el,"mousedown",this._ev_onMouseDown)),(0,i.re)(this._el),(0,i.re)(this._currHintEl)},n.prototype._updateHint=function(_,e){this._currHintEl||(this._currHintEl=(0,i.se)('<div class="slider_hint" id="slider_hint"></div>'),this.options.hintClass&&(0,i.addClass)(this._currHintEl,this.options.hintClass),this._el.appendChild(this._currHintEl)),this._width=this._width||(0,i.getSize)(this._slideEl)[0];const t=this._getPos();let o=Math.round(_.pageX-t[0]);const s=this._width;if(o=e?Math.min(Math.max(0,o),s):o,o>=0&&o<=s){const _=o/s;this._currHintEl.innerHTML=this.options.formatHint?this.options.formatHint.call(this,_):_;const t=(0,i.getSize)(this._currHintEl);(0,i.setStyle)(this._currHintEl,{left:this._slideEl.offsetLeft+o-t[0]/2,top:this._slideEl.offsetTop-t[1]-10}),!e&&this._toggleHint(!0)}else!e&&this._toggleHint(!1);this.options.formatHint||this._toggleHint(!1)},n.prototype._toggleHint=function(_){this.isAdMode()&&(_=!1),(0,i.toggleClass)(this._currHintEl,"visible",_)},n.prototype._onMouseOver=function(_){n._currenSliderDrag||(0,i.hasClass)(this._el,"active")||this._updateHint(_)},n.prototype._onMouseLeave=function(_){(0,i.hasClass)(this._el,"active")||this._toggleHint(!1)},n.prototype._onMouseDown=function(_){0==_.button&&(delete cur._sliderMouseUpNowEl,this._adState||this.getBlocked()||((0,a.addEvent)(window,"mousemove",this._ev_onMouseMove=this._onMouseMove.bind(this)),(0,a.addEvent)(window,"mouseup",this._ev_onMouseUp=this._onMouseUp.bind(this)),this._width=(0,i.getSize)(this._slideEl)[0],this._onMouseMove(_),n._currenSliderDrag=this,(0,i.addClass)(this._el,"active"),(0,a.cancelEvent)(_)))},n.prototype._onMouseUp=function(_){cur._sliderMouseUpNowEl=this._el,(0,a.removeEvent)(window,"mousemove",this._ev_onMouseMove),(0,a.removeEvent)(window,"mouseup",this._ev_onMouseUp),clearTimeout(this._debounceto),this._onValueChange(),(0,i.removeClass)(this._el,"active"),n._currenSliderDrag=!1,this._toggleHint(!1),this.options.onEndDragging&&this.options.onEndDragging(this._currValue)},n.prototype._onMouseMove=function(_){const e=this._getPos();let t=Math.max(_.pageX,e[0]);t=Math.min(t,e[0]+this._width),t-=e[0],this.setValue(t/this._width,!0,!0),this._onValueChangeDebounced?this._onValueChangeDebounced():this._onValueChange(),this._toggleHint(!0),this._updateHint(_,!0),(0,a.cancelEvent)(_)},n.prototype._getPos=function(){return this._slidePos=(0,i.getXY)(this._slideEl)},n.LOGFBASE=35,n.prototype._logf=function(_){if(!this.options.log)return _;const e=n.LOGFBASE;return(Math.pow(e,_)-1)/(e-1)},n.prototype._unlogf=function(_){if(!this.options.log)return _;const e=n.LOGFBASE;return t=e,i=1+_*(e-1),Math.log(i)/Math.log(t);var t,i},n.prototype.setValue=function(_,e,t){if((0,i.hasClass)(this._el,"active")&&!t)return;const o=t?this._logf(_):_;if(this._currValue==o)return;this._currValue=o;let s=t?_:this._unlogf(_);s=100*s+"%",(0,i.setStyle)(this._amountEl,{width:s}),(0,i.setStyle)(this._handlerEl,{left:s}),!e&&this._onValueChange()},n.prototype.setBackValue=function(_){(0,i.toggleClass)(this._backEl,"slider_back_transition",_>this._backValue),this._backValue=_;const e=100*_+"%";(0,i.setStyle)(this._backEl,{width:e})},n.prototype._onValueChange=function(){this._lastValue=this._lastValue||0,this._lastValue!=this._currValue&&(this._lastValue=this._currValue,this.options.onChange&&this.options.onChange(this._currValue))};const r=n},754879:(_,e,t)=>{t.d(e,{InlineDropdown:()=>d});var i=t(70689),o=t(15042),s=t(279489),a=t(93367),l=t(896669),n=t(902947),r=t(636322);function d(_,e){if(this.constructor!==d)throw new Error("InlineDropdown was called without 'new' operator");if(!(_=(0,i.ge)(_)))return;if(!_.nodeType)throw new Error("First argument not a DOM element");if((0,i.hasClass)(_,"idd_wrap"))return;if(this._opts=e||{},this._items=e.items?(0,r.clone)(e.items):JSON.parse(_.getAttribute("data-items")),!this._items)throw new Error("No items provided");this._title=e.keepTitle?e.title||_.innerHTML:"",this._selectable=!e.keepTitle||e.keepSelected,this._disableCancelClickEvent=!!e.disableCancelClickEvent&&!!e.disableCancelClickEvent;const{icon:t}=(0,l.getIcon12Dropdown)();this._iddEl=(0,i.se)(`<div class="idd_wrap" id="${_.id}">\n    <div class="idd_selected_value" tabindex="0" role="button">\n      ${_.innerHTML}\n    </div>\n    ${e.withArrow?`<div class="idd_chevron">${t}</div>`:""}\n    <input type="hidden" id="${_.id}_input" name="${_.getAttribute("name")||_.id}" />\n  </div>`);let o=this;if((0,n.each)(_.className.split(" "),(function(_,e){(0,i.addClass)(o._iddEl,e)})),(0,n.each)(_.attributes,(function(_,e){0==e.name.indexOf("data-")&&o._iddEl.setAttribute(e.name,e.value)})),_.parentNode.replaceChild(this._iddEl,_),this._els={valueEl:(0,i.geByClass1)("idd_selected_value",this._iddEl),itemsContentEl:(0,i.geByClass1)("idd_items_content",this._iddEl),hiddenInputEl:(0,i.geByTag1)("input",this._iddEl)},this._opts.autoShow){let _=!1;const e=function(){_=!0,clearTimeout(o._autoShowTimeout),o._autoShowTimeout=setTimeout((function(){_&&o._onClick()}),100)},t=function(){clearTimeout(o._autoShowTimeout),_=!1};(0,a.addEvent)(this._iddEl,"mouseenter",e),(0,a.addEvent)(this._iddEl,"mouseleave",t),(0,a.addEvent)(this._iddEl,"keydown",(_=>"Enter"===_.key&&_.target.getAttribute("class").includes("idd_selected_value")?e():null))}else(0,a.addEvent)(this._iddEl,"click",this._onClick.bind(this)),(0,a.addEvent)(this._iddEl,"keydown",(_=>"Enter"===_.key&&_.target.getAttribute("class").includes("idd_selected_value")?this._onClick.call(this):null));this._rebuildDropdown();let s=!1;void 0!==e.selected?s=e.selected:_.hasAttribute("data-value")&&(s=_.getAttribute("data-value")),!1!==s&&this.select(s,!0)}d.IDD_HEADER_CORRECTION_LEFT=-10,d.IDD_HEADER_CORRECTION_TOP=-8,d.prototype._rebuildDropdown=function(){let _=this._opts.withIcon?"idd_with_icon":"",e=this._opts.idPrefix?this._opts.idPrefix:"",t=this._opts.idItemPrefix?this._opts.idItemPrefix:"",s=this,r=this._opts.ariaLabel||"";const{icon:u}=(0,l.getIcon12Dropdown)();let c=`<div class="idd_header_wrap ${_}">\n    <div class="idd_header" id="${e}${this._items[0][0]}"></div>\n      ${this._opts.withArrow?`<div class="idd_chevron">${u}</div>`:""}\n    </div>`,E=`<div class="idd_items_wrap"><div class="idd_items_content" role="list" aria-label="${r}">`;(0,n.each)(this._items,(function(e,i){E+="separator"===i?'<div class="idd_separator"></div>':function(e,i){i=i||"";let o=s._opts.sublists&&s._opts.sublists[e[0]]?"idd_sublist":"";return`<div class="idd_item ${i} ${_} ${o}" id="${t}idd_item_${e[0]}" data-id="${e[0]}" tabindex="0" role="button">\n      ${s._opts.withIcon?'<div class="idd_item_icon" id="'+e[0]+'"></div>':""}\n      <div class="idd_item_name">${s._opts.html?s._opts.html(e):e[1]}</div>\n    </div>`}(i)})),E+="</div></div>",this._els.popupItems=(0,i.se)(E),this._els.popupHeader=(0,i.se)(c),(0,a.addEvent)(this._els.popupItems,"click",(function(_){let e=_.target;if("a"!=e.tagName.toLowerCase()){for(;e&&!(0,i.hasClass)(e,"idd_item");)e=e.parentNode;e&&(s.select(e.getAttribute("data-id"))?s._hide():s._hoverItem(e)),(0,a.cancelEvent)(_)}else setTimeout((function(){s._hide()}))})),(0,n.each)((0,i.geByClass)("idd_item",this._els.popupItems),(function(_,e){(0,a.addEvent)(e,"mouseenter",(function(_){d._preventMouseHover||s._hoverItem(_.currentTarget)})),(0,a.addEvent)(e,"mouseleave",(function(_){d._preventMouseHover||s._unhoverItem(_.currentTarget,_)}))})),(0,a.addEvent)(this._els.popupItems,"mouseenter",function(){(0,a.addEvent)(this._els.popupItems,o.browserFeatures.wheelEvent,this._onWheel.bind(this))}.bind(this)),(0,a.addEvent)(this._els.popupItems,"mouseleave",function(){(0,a.removeEvent)(this._els.popupItems,o.browserFeatures.wheelEvent,this._onWheel.bind(this))}.bind(this))},d.prototype._onClick=function(_){if((0,i.isVisible)(this._els.popupEl))return void this._hide();d._currIDD&&d._currIDD._hide(),d._currIDD=this,window.tooltips&&tooltips.hideAll();let e=this;let t=this._els.popupEl=(0,i.se)('<div class="idd_popup"></div>');this._opts.alignLeft&&(0,i.addClass)(t,"idd_align_left"),this._opts.popupClass&&(0,i.addClass)(t,this._opts.popupClass),this.openToUp=1==this._opts.forceDir||"up"==this._opts.forceDir||-1!=this._opts.forceDir&&"down"!=this._opts.forceDir&&(0,i.getXY)(e._iddEl)[1]-((window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0))+200>window.innerHeight,this.openToUp?(t.appendChild(this._els.popupItems),t.appendChild(this._els.popupHeader)):(t.appendChild(this._els.popupHeader),t.appendChild(this._els.popupItems));let o=(0,i.geByClass1)("idd_header",this._els.popupHeader);this._opts.keepTitle?o.innerHTML=this._title:o.innerHTML=this._selected?this._selected[1]:"",t.id="idd_"+this._iddEl.id,this._iddEl.appendChild(t);let s=(0,i.getSize)(t),l=(0,i.getSize)(this._els.valueEl),n=0;this.openToUp&&(n=-(0,i.getSize)(this._els.popupItems)[1]);let r={marginTop:(this._opts.headerTop||d.IDD_HEADER_CORRECTION_TOP)+n,width:s[0]+8,opacity:1};this._opts.alignLeft?r[vk.rtl?"marginRight":"marginLeft"]=l[0]-d.IDD_HEADER_CORRECTION_LEFT:r.marginLeft=(this._opts.headerLeft||d.IDD_HEADER_CORRECTION_LEFT)-(this._opts.withIcon?20:0),(0,i.setStyle)(t,r),this._unhoverItem(),this._highlightItem(),this._initOutEvent(),this._initKeypressEvent(),this._opts.onShow&&this._opts.onShow(this.ddEl),this._disableCancelClickEvent||(0,a.cancelEvent)(_)},d.prototype._hide=function(){(0,i.re)(this._els.popupEl),this._els.popupEl=null,(0,i.removeClass)(this._hoveredItem,"idd_hover"),this._hoveredItem=null,this._deinitEvents(),this._hideSubmenu(),clearTimeout(this._hideSubmenuTimeout),this._opts.onHide&&this._opts.onHide()},d.prototype._highlightItem=function(_){if(!this._selectable)return;if(!this._els.popupEl)return;if(void 0===_){if(!this._selected)return;_=this._selected[0]}let e=(0,i.geByClass1)("idd_hl",this._els.popupEl);e&&(0,i.removeClass)(e,"idd_hl");let t=(0,i.ge)("idd_item_"+_);(0,i.addClass)(t,"idd_hl");let o=this;(0,n.each)((0,i.geByClass)("idd_item",this._els.popupItems),(function(_,e){if(e==t)return o._els.popupItems.scrollTop=(_+1)*(0,i.getSize)(e)[1]-(0,i.getSize)(o._els.popupItems)[1]/2,!1}))},d.prototype._onWheel=function(_){let e=(0,i.getSize)((0,i.geByClass1)("idd_items_content",this._els.popupItems))[1],t=(0,i.getSize)(this._els.popupItems)[1];e!=t&&(0==this._els.popupItems.scrollTop&&_.deltaY<0||this._els.popupItems.scrollTop==e-t&&_.deltaY>0)&&(0,a.cancelEvent)(_)},d.prototype._onKeyDown=function(_){switch(_.keyCode){case 9:case 38:case 40:case 13:case 27:this._onKey(_.keyCode,_)}},d.prototype._onKeyPress=function(_){this._onKey(_.which,_)},d.prototype._hideSubmenu=function(){(0,i.removeClass)(this._currSubmenuItem,"idd_hover_sublist_parent"),(0,i.re)(this._els.currCascade),delete this._currSubmenuItem,this._hoveredItem&&this._showSubmenu(this._hoveredItem)},d.prototype._showSubmenu=function(_){if(clearTimeout(this._hideSubmenuTimeout),!_)return;let e=this,t=_.getAttribute("data-id");if(this._opts.sublists&&this._opts.sublists[t]){if((0,i.addClass)(_,"idd_hover_sublist_parent"),this._currSubmenuItem==_)return void clearTimeout(this._submenuHideTimeout);let o=this._opts.sublists[t],l='<div class="idd_popup"><div class="idd_items_wrap"><div class="idd_items_content">',r=o.withIcon?"idd_with_icon":"";function u(_,e){return'<div class="idd_item '+(e=e||"")+" "+r+'" id="idd_item_'+_[0]+'" data-id="'+_[0]+'" role="button" tabindex="0">'+(o.withIcon?'<div class="idd_item_icon" id="'+_[0]+'"></div>':"")+'<div class="idd_item_name">'+(o.html?o.html(_):_[1])+"</div></div>"}(0,n.each)(o.items,(function(_,e){l+=u(e)})),l+="</div></div></div>",this._els.currCascade=(0,i.se)(l),this._iddEl.appendChild(this._els.currCascade);{let c=(0,i.getSize)(this._els.popupEl),E=(0,i.getSize)(_),h=(0,i.getSize)(this._els.currCascade),P=0,p=_;for(;null!=(p=p.previousSibling);)P++;let b=c[0]+(this._opts.headerLeft||d.IDD_HEADER_CORRECTION_LEFT)-1;(0,i.setStyle)(this._els.currCascade,{marginLeft:b-3,marginTop:E[1]*P+6-(this.openToUp?c[1]:0),"z-index":200,width:h[0]+30}),setTimeout((function(){(0,s.cssAnim)(e._els.currCascade,{marginLeft:b,opacity:1},{duration:140})}),10)}(0,n.each)((0,i.geByClass)("idd_item",this._els.currCascade),(function(_,t){(0,a.addEvent)(t,"mouseenter",(function(_){e._isInSubmenu=!0,d._preventMouseHover||e._hoverItem(_.currentTarget,null,!0)})),(0,a.addEvent)(t,"mouseleave",(function(_){e._isInSubmenu=!1,d._preventMouseHover||e._unhoverItem()}))})),(0,a.addEvent)(this._els.currCascade,"click",(function(_){let t=_.target;if("a"!=t.tagName.toLowerCase()){for(;t&&!(0,i.hasClass)(t,"idd_item");)t=t.parentNode;if(t){let _=!0,s=t.getAttribute("data-id"),a=(0,i.geByClass1)("idd_item_name",t).innerHTML;o.onSelect?_=o.onSelect(s,a):e._opts.onSelect&&(_=e._opts.onSelect(s,a)),_&&e._hide()}(0,a.cancelEvent)(_)}else setTimeout((function(){e._hide()}))})),this._currSubmenuItem=_}},d.prototype._hoverItem=function(_,e,t){let o=this;if(this._unhoverItem(),(0,i.addClass)(_,"idd_hover"),this._hoveredItem=_,e&&_){let e=_.getAttribute("id"),t=this;(0,n.each)((0,i.geByClass)("idd_item"),(function(o,s){if(s.getAttribute("id")==e)return t._els.popupItems.scrollTop=(0,i.getSize)(_)[1]*(o+1)-(0,i.getSize)(t._els.popupItems)[1]/2,clearTimeout(d._preventMouseHover),d._preventMouseHover=setTimeout((function(){d._preventMouseHover=null}),100),!1}))}if(clearTimeout(this._hideSubmenuTimeout),t)(0,i.addClass)(this._currSubmenuItem,"idd_hover_sublist_parent");else{let e=this._currSubmenuItem==_;this._currSubmenuItem&&!e&&(this._hideSubmenuTimeout=setTimeout((function(){o._hideSubmenu()}),200)),this._currSubmenuItem||this._showSubmenu(_),(0,i.removeClass)(this._currSubmenuItem,"idd_hover_sublist_parent")}},d.prototype._unhoverItem=function(_,e){this._hoveredItem&&(0,i.removeClass)(this._hoveredItem,"idd_hover"),this._hoveredParentItem&&(0,i.removeClass)(this._hoveredParentItem,"idd_hover"),clearTimeout(d._preventMouseHover)},d.prototype._onKey=function(_,e){if(38==_||40==_){let t=this,o=this._hoveredItem||(0,i.geByClass1)("idd_hl",this._els.popupItems)||(0,i.geByClass1)("idd_item",this._els.popupItems);return o=38==_?o.previousSibling:o.nextSibling,t._hoverItem(o,!0),(0,a.cancelEvent)(e),!1}if(9==_){let _=this,t=(0,i.geByClass1)("idd_items_content",this._els.popupItems),o=e.target;return o=e.target.getAttribute("class").includes("idd_item")?e.shiftKey?o.previousSibling:o.nextSibling:e.shiftKey?t.lastChild:t.firstChild,_._hoverItem(o,!0),!1}13==_?this._hoveredItem&&this.select(this._hoveredItem.getAttribute("data-id"))&&this._hide():27==_?this._hide():this._quickSearch(_)},d.prototype._quickSearch=function(_){let e=this;if(void 0!==_){let t=String.fromCharCode(_).toLowerCase();if(!t)return;setTimeout((function(){e._currSearchStr=""}),600),this._currSearchStr=this._currSearchStr||"",this._currQuickSearchIndex=this._currQuickSearchIndex||0,1==this._currSearchStr.length&&this._currSearchStr[0]==t||(this._currSearchStr+=t)}let t=this._items;for(let e=this._currQuickSearchIndex;e<t.length;e++){let o=t[e][1].toLowerCase();if(1==this._currSearchStr.length&&this._currSearchStr==o[0]||this._currSearchStr.length>1&&o.indexOf(this._currSearchStr)>=0){this._currQuickSearchIndex=e+1,this._hoverItem((0,i.ge)("idd_item_"+t[e][0]),!0),e==t.length-1&&(this._currQuickSearchIndex=0);break}e==t.length-1&&(this._currQuickSearchIndex=0,_&&this._quickSearch())}},d.prototype._deinitEvents=function(){(0,a.removeEvent)(window,"click",d._window_onOuterClick),(0,a.removeEvent)(window,"keypress",d._window_onKeyPress),(0,a.removeEvent)(window,"keydown",d._window_onKeyDown)},d.prototype._initKeypressEvent=function(){(0,a.addEvent)(window,"keypress",d._window_onKeyPress=this._onKeyPress.bind(this)),(0,a.addEvent)(window,"keydown",d._window_onKeyDown=this._onKeyDown.bind(this))},d.prototype._onOuterClick=function(_){let e=_.target,t=!0;for(;e&&e!=document;){if((0,i.hasClass)(e,"idd_popup")){t=!1;break}e=e.parentNode}t&&this._hide()},d.prototype._initOutEvent=function(){let _=this;setTimeout((function(){(0,a.addEvent)(window,"click",d._window_onOuterClick=_._onOuterClick.bind(_))})),this._opts.autoHide>0&&((0,a.addEvent)(this._iddEl,"mouseleave",(function(){clearTimeout(_._leaveTimeout),_._leaveTimeout=setTimeout((function(){_._isInSubmenu||_._hide()}),_._opts.autoHide)})),(0,a.addEvent)(this._iddEl,"mouseenter",(function(){clearTimeout(_._leaveTimeout)})))},d.prototype.deinit=function(){this._deinitEvents()},d.prototype.setItems=function(_){this._items=(0,r.clone)(_),this.select(_[0][0],!0),this._rebuildDropdown()},d.prototype.getElement=function(){return this._iddEl},d.prototype.getSelected=function(){return this._selected},d.prototype.select=function(_,e){if(this._opts.sublists&&this._opts.sublists[_])return;let t=!1;if((0,n.each)(this._items,(function(e,i){if(i[0]==_)return t=i,!1})),!1===t)throw new Error("No item found for selection");this._selected=t,this._opts.keepTitle||(this._els.valueEl.innerHTML=t[1]),(0,i.val)(this._els.hiddenInputEl,_);let o=!0;if(!e&&this._opts.onSelect)try{o=!this._opts.onSelect(t[0],t)}catch(_){console.error(_)}return o},d.prototype.val=function(_,e){return void 0!==_?this.select(_,e):this.getSelected()?this.getSelected()[0]:""}},572967:(_,e,t)=>{function i(_){switch(_.type){case"action":return _;case"link":{const{href:e,...t}=_;return{...t,type:"action",action:()=>{window.open(e,"_blank")?.focus()}}}}}t.d(e,{mapChoiceToActionChoice:()=>i})},799553:(_,e,t)=>{t.d(e,{CatalogBannerStatCollector:()=>s});var i=t(324153),o=t(322695);class s{destroy(){this.observer.disconnect(),this.observed_items.forEach(((_,e)=>this.sendViewStat(e))),this.elements.forEach((_=>_.removeEventListener("mousedown",this.clickHandler)))}addHandlers(){this.clickHandler=this.onClick.bind(this),this.elements.forEach((_=>_.addEventListener("mousedown",this.clickHandler))),this.elements.forEach((_=>this.observer.observe(_)))}onClick(_){if(_.currentTarget&&_.currentTarget instanceof HTMLElement&&_.currentTarget.parentElement&&_.currentTarget.dataset.id){const e=parseInt(_.currentTarget.dataset.id),t={type:i.ClickProductionStatEventTypes.TYPE_CATALOG_BANNER_ITEM,position:[..._.currentTarget.parentElement.children].indexOf(_.currentTarget)+1},o={type:i.EventItemType.CATALOG_BANNER,id:e,track_code:this.blockId};this.clickCollector.logEvent(t,o)}}sendViewStat(_){if(void 0!==this.observed_items[_]){const e={...this.observed_items[_],end_view:this.productCollector.getCurrentTime()},t={type:i.EventItemType.CATALOG_BANNER,id:_,track_code:this.blockId};this.viewCollector.logEvent(e,t),delete this.observed_items[_]}}onView(_){_.forEach((_=>{const e=_.target;if(e instanceof HTMLElement&&e.parentElement&&e.dataset.id){const t=parseInt(e.dataset.id);_.isIntersecting?void 0===this.observed_items[t]&&(this.observed_items[t]={type:i.ViewProductionStatEventTypes.TYPE_CATALOG_BANNER_ITEM,start_view:this.productCollector.getCurrentTime(),end_view:"0",position:[...e.parentElement.children].indexOf(e)+1}):this.sendViewStat(t)}}))}constructor(_,e){this.blockId=e;this.observed_items=[],this.observer=new IntersectionObserver((_=>this.onView(_)),{root:null,rootMargin:"0px",threshold:.5}),this.productCollector=new o.ProductionStatCollector,this.viewCollector=new o.ViewStatCollector(this.productCollector),this.clickCollector=new o.ClickStatCollector(this.productCollector),this.elements=_,this.addHandlers()}}},842989:(_,e,t)=>{t.d(e,{BannersController:()=>s,ConsumeReason:()=>i});var i,o=t(799553);!function(_){_.Click="click",_.Close="close"}(i||(i={}));class s{getBanners(){return Array.from(this.blockContent.querySelectorAll(".BannerItem"))}setBannersEvents(){this.getBanners().forEach((_=>{if(_.dataset.id){const e=parseInt(_.dataset.id);this.addConsumableClick(_,e),this.addConsumableCloseClick(_,e)}}))}checkItems(){this.getBanners().length||this.blockContent&&this.blockContent.remove()}destroy(){this.bannerStatCollector.destroy()}onDataLoad(){}constructor(_,e){this.blockContent=_,this.blockId=e;const t=this.getBanners();this.bannerStatCollector=new o.CatalogBannerStatCollector(t,e)}}},756537:(_,e,t)=>{t.d(e,{AudioPlayerVolumeSlider:()=>n});var i=t(785893),o=t(602381),s=t(868558),a=t(773735),l=t(409362);function n({scale:_=s.AudioPlayerVolumeSliderScale.Normal,volume:e,onVolumeChange:t,...n}){const r=_===s.AudioPlayerVolumeSliderScale.Logarithmic?(0,l.normalizeVolume)(e):e;return(0,i.jsx)(o.AudioPlayerVolumeSlider,{volume:r,...n,onVolumeChange:e=>{const i=_===s.AudioPlayerVolumeSliderScale.Logarithmic?(0,a.logarithmizeVolume)(e):e;t?.(i)}})}},868558:(_,e,t)=>{var i;t.d(e,{AudioPlayerVolumeSliderScale:()=>i}),function(_){_.Normal="normal",_.Logarithmic="logarithmic"}(i||(i={}))},402650:(_,e,t)=>{t.d(e,{AudioPlayerVolumeSlider:()=>i.AudioPlayerVolumeSlider,AudioPlayerVolumeSliderScale:()=>o.AudioPlayerVolumeSliderScale});var i=t(756537),o=t(868558)},901806:(_,e,t)=>{t.d(e,{LOGARITHMIC_SCALE_FUNCTION_BASE:()=>i});const i=35},773735:(_,e,t)=>{t.d(e,{logarithmizeVolume:()=>o});var i=t(901806);function o(_){return(Math.pow(i.LOGARITHMIC_SCALE_FUNCTION_BASE,_)-1)/(i.LOGARITHMIC_SCALE_FUNCTION_BASE-1)}},409362:(_,e,t)=>{t.d(e,{normalizeVolume:()=>o});var i=t(901806);function o(_){return e=i.LOGARITHMIC_SCALE_FUNCTION_BASE,t=1+_*(i.LOGARITHMIC_SCALE_FUNCTION_BASE-1),Math.log(t)/Math.log(e);var e,t}},417197:(_,e,t)=>{t(785893),t(312048),t(359251),t(441430)},170129:(_,e,t)=>{t(417197)},450321:(_,e,t)=>{t(785893),t(888188),t(300993),t(441430)},184697:(_,e,t)=>{t(450321)},709504:(_,e,t)=>{t(170129),t(184697)},808141:(_,e,t)=>{t.d(e,{AudioBroadcastIconButton:()=>l});var i=t(785893),o=t(921774),s=t(981284),a=t(130593);const l=({active:_,...e})=>(0,i.jsx)(s.IconButton,{draggable:!1,...e,children:(0,i.jsx)(o.Icon24Broadcast,{className:(0,a.getColorClass)(_?"color_icon_accent":"color_icon_secondary")})})},751938:(_,e,t)=>{t.d(e,{AudioBroadcastIconButton:()=>i.AudioBroadcastIconButton});var i=t(808141)},228523:(_,e,t)=>{t.d(e,{AudioDislikeIconButton:()=>n});var i=t(785893),o=t(656252),s=t(697430),a=t(981284),l=t(130593);const n=({added:_,...e})=>{const t=_?o.Icon24ThumbsDown:s.Icon24ThumbsDownOutline;return(0,i.jsx)(a.IconButton,{draggable:!1,...e,children:(0,i.jsx)(t,{className:(0,l.getColorClass)("color_icon_secondary")})})}},749162:(_,e,t)=>{t.d(e,{AudioDislikeIconButton:()=>i.AudioDislikeIconButton});var i=t(228523)},961264:(_,e,t)=>{t.d(e,{AudioFavoritesIconButton:()=>n});var i=t(785893),o=t(81483),s=t(359251),a=t(981284),l=t(130593);const n=({added:_,...e})=>{const t=_?o.Icon24Bookmark:s.Icon24BookmarkOutline;return(0,i.jsx)(a.IconButton,{...e,draggable:!1,children:(0,i.jsx)(t,{className:(0,l.getColorClass)("color_icon_secondary")})})}},339916:(_,e,t)=>{t.d(e,{AudioFavoritesIconButton:()=>i.AudioFavoritesIconButton});var i=t(961264)},30223:(_,e,t)=>{t.d(e,{AudioLyricsIconButton:()=>l});var i=t(785893),o=t(985721),s=t(981284),a=t(130593);const l=_=>(0,i.jsx)(s.IconButton,{draggable:!1,..._,children:(0,i.jsx)(o.Icon24TextTtOutline,{className:(0,a.getColorClass)("color_icon_secondary")})})},163190:(_,e,t)=>{t.d(e,{AudioLyricsIconButton:()=>i.AudioLyricsIconButton});var i=t(30223)},897784:(_,e,t)=>{t.d(e,{AudioRecomsIconButton:()=>l});var i=t(785893),o=t(96010),s=t(981284),a=t(130593);const l=_=>(0,i.jsx)(s.IconButton,{draggable:!1,..._,children:(0,i.jsx)(o.Icon24StarsOutline,{className:(0,a.getColorClass)("color_icon_secondary")})})},50206:(_,e,t)=>{t.d(e,{AudioRecomsIconButton:()=>i.AudioRecomsIconButton});var i=t(897784)},966307:(_,e,t)=>{t.d(e,{AudioRepeatIconButton:()=>r});var i=t(785893),o=t(257405),s=t(876625),a=t(130593),l=t(981284);const n={"not-repeat":(0,i.jsx)(o.Icon24RepeatOutline,{className:(0,a.getColorClass)("color_icon_secondary")}),repeat:(0,i.jsx)(o.Icon24RepeatOutline,{className:(0,a.getColorClass)("color_icon_accent")}),"repeat-one":(0,i.jsx)(s.Icon24Repeat1Outline,{className:(0,a.getColorClass)("color_icon_accent")})},r=({state:_,...e})=>(0,i.jsx)(l.IconButton,{draggable:!1,...e,children:n[_]})},894096:(_,e,t)=>{t.d(e,{AudioRepeatIconButton:()=>i.AudioRepeatIconButton});var i=t(966307)},584231:(_,e,t)=>{t.d(e,{AudioShareIconButton:()=>l});var i=t(785893),o=t(898366),s=t(981284),a=t(130593);const l=_=>(0,i.jsx)(s.IconButton,{draggable:!1,..._,children:(0,i.jsx)(o.Icon24ShareOutline,{className:(0,a.getColorClass)("color_icon_secondary")})})},128444:(_,e,t)=>{t.d(e,{AudioShareIconButton:()=>i.AudioShareIconButton});var i=t(584231)},866828:(_,e,t)=>{t.d(e,{AudioShuffleIconButton:()=>l});var i=t(785893),o=t(912766),s=t(981284),a=t(130593);const l=({active:_,...e})=>(0,i.jsx)(s.IconButton,{...e,draggable:!1,children:(0,i.jsx)(o.Icon24ShuffleOutline,{className:(0,a.getColorClass)(_?"color_icon_accent":"color_icon_secondary")})})},608437:(_,e,t)=>{t.d(e,{AudioShuffleIconButton:()=>i.AudioShuffleIconButton});var i=t(866828)},183208:(_,e,t)=>{t.d(e,{AudioBroadcastIconButton:()=>d.AudioBroadcastIconButton,AudioDislikeIconButton:()=>i.AudioDislikeIconButton,AudioFavoritesIconButton:()=>o.AudioFavoritesIconButton,AudioLyricsIconButton:()=>s.AudioLyricsIconButton,AudioRecomsIconButton:()=>a.AudioRecomsIconButton,AudioRepeatIconButton:()=>l.AudioRepeatIconButton,AudioShareIconButton:()=>r.AudioShareIconButton,AudioShuffleIconButton:()=>n.AudioShuffleIconButton});var i=t(749162),o=t(339916),s=t(163190),a=t(50206),l=t(894096),n=t(608437),r=t(128444),d=t(751938)},299898:(_,e,t)=>{t.d(e,{AudioRecomsIconLink:()=>l});var i=t(785893),o=t(800856),s=t(183208),a=t(257582);function l({href:_,target:e,onClick:t,...l}){return _?(0,i.jsx)(o.Link,{href:_,target:e,className:a.default.link,children:(0,i.jsx)(s.AudioRecomsIconButton,{hoverMode:"opacity",activeMode:"opacity",noPadding:!0,...l})}):t?(0,i.jsx)(s.AudioRecomsIconButton,{hoverMode:"opacity",activeMode:"opacity",noPadding:!0,...l}):function(_){throw new TypeError(`Unexpected props ${_} for component AudioRecomsIconLink`)}(l)}},338350:(_,e,t)=>{t.d(e,{AudioRecomsIconLink:()=>i.AudioRecomsIconLink});var i=t(299898)},415870:(_,e,t)=>{t.d(e,{AudioRecomsIconLink:()=>i.AudioRecomsIconLink});var i=t(338350)},845350:(_,e,t)=>{t.d(e,{AudioBroadcastIconButton:()=>i.AudioBroadcastIconButton,AudioDislikeIconButton:()=>i.AudioDislikeIconButton,AudioFavoritesIconButton:()=>i.AudioFavoritesIconButton,AudioLyricsIconButton:()=>i.AudioLyricsIconButton,AudioPlayerVolumeSlider:()=>s.AudioPlayerVolumeSlider,AudioPlayerVolumeSliderScale:()=>s.AudioPlayerVolumeSliderScale,AudioRecomsIconLink:()=>o.AudioRecomsIconLink,AudioRepeatIconButton:()=>i.AudioRepeatIconButton,AudioShareIconButton:()=>i.AudioShareIconButton,AudioShuffleIconButton:()=>i.AudioShuffleIconButton});var i=t(183208),o=t(415870),s=(t(709504),t(402650))},266842:(_,e,t)=>{t.d(e,{formatAudioTime:()=>o});var i=t(41585);function o({duration:_,progress:e,negative:t}){return t&&e<1?"-"+(0,i.formatTime)(Math.round(_-e*_)):(0,i.formatTime)(Math.round(e*_))}},841508:(_,e,t)=>{function i(_){let e=_.split(" ");e=e.slice(0,e.length-1);let t=e.join(" ");return t&&(t+="..."),t}function o(_,e=0){if(_.scrollHeight/_.clientHeight>1.1){let t=_.clientHeight,o=_.innerText;for(;o&&_.scrollHeight/t>1.1&&_.innerText.split(" ").length>e;)o=i(o),_.innerHTML=o}}t.d(e,{truncateMultilineText:()=>o})},651851:(_,e,t)=>{t.d(e,{useUpdateEffect:()=>o,useUpdateLayoutEffect:()=>s});var i=t(667294);const o=a(i.useEffect),s=a(i.useLayoutEffect);function a(_){return function(e,t){const o=(0,i.useRef)();_((()=>{if(o.current)return e();o.current=!0}),t)}}},305174:(_,e,t)=>{t.d(e,{initReactApp:()=>o});var i=t(973935);function o(_,e,t){_&&(i.render(e,_),t||window.cur.destroy?.push((()=>{_&&i.unmountComponentAtNode(_)})))}},139301:(_,e,t)=>{t.d(e,{AudioCatalogVkMixBlockTq:()=>l});var i=t(785893),o=t(305174),s=t(117233),a=t(116647);const l=({payload:{target:_,data:e}})=>{if(!_)throw new Error("AudioCatalogVkMixBlock: Missing target");const{items:t,block:l,needShowOnboarding:n}=e;(0,o.initReactApp)(_,(0,i.jsx)(a.AudioCatalogMusicMixBlockApplication,{id:t[0].id,backgroundAnimationUrl:t[0].background_animation_url,description:(0,s.decodeHTML)(t[0].description),header:(0,s.decodeHTML)(t[0].title),title:(0,s.decodeHTML)(t[0].stream_mix.title),style:l.layout.style||"default",needShowOnboarding:n}))}},587896:(_,e,t)=>{t.d(e,{AudioPlayerBlockTq:()=>s});var i=t(308730),o=t(4139);const s=({payload:{target:_,data:e}})=>{if(!_)throw new Error("AudioPlayerBlock: Missing target");(0,o.createReactInitiator)(i.AudioPlayerBlockApplication,_,{destroyAfterNavigation:!1}).render({initData:e})}},612600:(_,e,t)=>{t.d(e,{BannersController:()=>s});var i=t(842989),o=t(851782);class s extends i.BannersController{consumeBanner(_,e){o.ajax.post("/al_audio.php?act=consume_banner",{id:_,ref:this.blockId,reason:e},{onFail:()=>!0})}addConsumableClick(_,e){_.classList.contains("BannerItem--consumable")&&_.dataset.id&&_.addEventListener("click",(()=>this.consumeBanner(e,i.ConsumeReason.Click)))}addConsumableCloseClick(_,e){const t=_.querySelector(".BannerItem__close");t instanceof HTMLElement&&(t.onclick=t=>{this.consumeBanner(e,i.ConsumeReason.Close),_.remove(),this.checkItems(),t.stopPropagation(),t.preventDefault()})}checkItems(){const _=this.getBanners();if(_.length){if(1===_.length){const _=this.blockContent.querySelectorAll(".audio_promo__control");_&&_.forEach((_=>_.remove()))}}else{const _=this.blockContent.parentElement;this.blockContent&&this.blockContent.remove(),_&&!_.childElementCount&&_.remove()}}constructor(_,e){super(_,e),this.setBannersEvents()}}},518314:(_,e,t)=>{t.d(e,{BaseController:()=>a});var i=t(443503),o=t(912501),s=t(926234);class a{fetchNext(){return this.fetchSection(this.id,this.nextFrom)}fetchSection(_,e,t={}){return this.fetchInProgress=!0,new Promise(((i,o)=>{const s={section_id:_,start_from:e,...t};window.nav.objLoc.claim&&(s.claim=window.nav.objLoc.claim),window.ajax.post("al_audio.php?act=load_catalog_section",s,{onDone:(_,e,t)=>{this.fetchInProgress=!1,i({blocks:_,data:e,blockItems:t})},onFail:()=>(o(),this.fetchInProgress=!1,!0)})}))}getId(){return this.id}static getHint(_,e){switch(e.type){case i.HintType.Tooltip:return new o.TooltipHint(e,_);case i.HintType.Highlight:return new s.HighlightHint(e,_)}return null}}},498147:(_,e,t)=>{t.d(e,{BlockController:()=>g});var i=t(591063),o=t(30655),s=t(540745),a=t(518314),l=t(127545),n=t(618030),r=t(612291),d=t(791377),u=t(612600),c=t(70689),E=t(722755),h=t(185498),P=t(851782),p=t(173988),b=t(847441);class g extends a.BaseController{initSpecificBlockController(){if(this.blockContent)switch(this.blockContent.dataset.type){case"catalog_banners":this.specificController=new u.BannersController(this.blockContent,this.getId());break;case"artist":case"curator":this.specificController=new p.MusicAuthorController(this.blockContent)}}enable(){this.reorderer&&this.reorderer.enable()}disable(){this.blockAutoList&&this.blockAutoList.destroy(),this.reorderer&&this.reorderer.disable()}emitEvent(_){if(this.listenEvents.includes(_))if(_===b.events.PLACEHOLDER_REMOVE)this.removeBlock();else this.reloadData()}initSearch(){const _=this.block.getElementsByClassName("ui_search");_.length&&Array.prototype.forEach.call(_,(_=>d.default.init(_)))}initListenEvents(){if(this.blockContent?.dataset.listenEvents)try{this.listenEvents=JSON.parse(this.blockContent?.dataset.listenEvents)}catch(_){}}onSectionInit(){this.blockItemsContainer&&this.blockItemsContainer.classList.contains(s.BLOCK_ITEMS_REORDERABLE)&&this.initListReorder("current"!==this.section.name)}hasBlockName(_){return this.blockContent&&this.blockContent.classList.contains(`${s.BLOCK_ELEMENT}__${_}`)}reloadData(){this.fetchSection(this.id,"").then((({blockItems:_,data:e})=>{if(this.setItems(g.createNodesFromItems(_)),e.playlists&&e.playlists.length){const _=(0,o.getAudioPlayer)();_&&_.addWithReplacePlaylists(e.playlists.filter(Boolean))}})).catch((()=>!0))}setFromBlockContent(){if(this.blockContent=this.block.classList.contains(s.BLOCK_CONTENT)?this.block:this.block.querySelector(`.${s.BLOCK_CONTENT}`),this.blockContent){this.id=this.blockContent.dataset.id||"",this.nextFrom=this.blockContent.dataset.next||"",this.dataType=this.blockContent.dataset.type||null;const _=this.blockContent.classList.toString().match(/CatalogBlock__layout--(.*)/);this.layoutName=_&&_[1]}}removeBlock(){this.destroy();const _=this.block.closest(`.${s.BLOCK_ELEMENT}`);let e=this.block;_ instanceof HTMLElement&&1===_.childElementCount&&(e=_),e.remove()}clearList(){this.blockItemsContainer&&(this.blockItemsContainer.innerHTML="")}destroy(){this.blockAutoList&&this.blockAutoList.destroy(),this.reorderer&&this.reorderer.destroy(),this.specificController&&this.specificController.destroy()}hideLoader(){this.loader&&(this.loader.style.display="none")}showLoader(){this.loader&&(this.loader.style.display="")}setNextFrom(_){this.nextFrom=_,this.blockContent&&(this.blockContent.dataset.next=this.nextFrom)}setId(_){this.id=_,this.blockContent&&(this.blockContent.dataset.id=this.id),this.blockItemsContainer&&this.blockItemsContainer.dataset.playlistId&&(this.blockItemsContainer.dataset.playlistId=this.id)}setItems(_){if(this.blockItemsContainer&&this.dataType&&this.layoutName){new E.BlockItemsReplacer(this.blockItemsContainer,this.dataType,this.layoutName).replaceItems(_)}}resetItems(){this.blockItemsContainer&&(this.clearItems(),this.blockItemsContainer.append(...this.initialItems))}clearItems(){this.blockItemsContainer&&(this.blockItemsContainer.innerHTML="")}initAutoList(_=[]){let e=_;this.blockItemsContainer&&(this.blockAutoList&&this.blockAutoList.destroy(),this.blockAutoList=new i.default(this.blockItemsContainer,{scrollNode:!1,onRendered:()=>{(0,o.getAudioPlayer)().updateCurrentPlaying(),this.specificController&&this.specificController.onDataLoad()},onNoMore:()=>this.hideLoader(),onNeedRows:_=>{if(this.showLoader(),e.length){const t=e;return e=[],void _(t)}this.nextFrom?this.fetchNext().then((({blockItems:e,data:t})=>{this.setNextFrom(t.nextFrom),this.dataType===h.DataType.RadioStations&&t.playlist&&g.mergePlaylistFromPaginatedResponse(t.playlist),_(e)})).catch((()=>{})):_(null)}}))}updateListReorder(){this.reorderer&&this.reorderer.update()}initListReorder(_=!0){let e;switch(this.dataType){case h.DataType.MusicAudios:e=(e,t,i)=>this.onAudioBlockReorder(e,t,i,_);break;case h.DataType.MusicPlaylists:e=this.onPlaylistsBlockReorder.bind(this);break;default:e=()=>{}}this.reorderer=new n.default(this.blockItemsContainer,"",{onReorder:e.bind(this)})}onAudioBlockReorder(_,e,t,i){window.currentAudioPage(this.block).onAudioRowsReorder(!i,_,e,t)}onPlaylistsBlockReorder(_,e,t){window.currentAudioPage(this.block).onPlaylistsReorder(_,e,t)}static mergePlaylistFromPaginatedResponse(_){const e=(0,o.getAudioPlayer)(),t=e.getPlaylist(_.type,_.ownerId,_.id);e.mergePlaylistData(t,_)}initSortSelector(){const _=this.block.querySelector(`.${s.SORTER_ACTION}`);_&&(this.sortSelector=new l.BlockSorter(_,(_=>{P.ajax.post("/al_audio.php?act=replace_blocks",{replacement_ids:_},{onDone:_=>this.section.replaceBlocks(_.replacements,_.nextFrom,_.playlists)})})))}initGallery(){this.blockItemsContainer&&this.blockItemsContainer.classList.contains(s.GALLERY)&&(this.gallery=new r.UIGallery(this.blockItemsContainer,{scrollY:!1}))}static search(_,e,t,i){const o=g.findBlockById(_,i.target);o&&!o.fetchInProgress&&(t?o.fetchSection(e,"",{search_query:t}).then((({blockItems:_})=>{o.setItems(g.createNodesFromItems(_))})).catch((()=>!0)):o.resetItems())}static showMore(_,e){const t=g.findBlockById(_,e);t&&!t.fetchInProgress&&t.fetchNext().then((({blockItems:_,data:e})=>{t.setItems(g.createNodesFromItems(_)),t.nextFrom=e.nextFrom})).catch((()=>!0))}static findBlockById(_,e){const t=window.currentAudioPage(e).catalogController.currentSection;return t?t.getBlockById(_):null}static findBlockByElement(_){const e=(0,c.gpeByClass)("CatalogBlock__content",_),t=e?.dataset.id;return t||null}static createNodesFromItems(_){return _.map((_=>{const e=document.createElement("template");return e.innerHTML=_,e.content.firstElementChild})).filter((_=>!!_))}initHints(){if(this.block.dataset.catalogHintId){const _=this.section.getHintById(this.block.dataset.catalogHintId);if(_){const e=a.BaseController.getHint(this.block,_);if(e){const t=this.section.hintsToShow.findIndex((_=>e.id===_.id&&_.initialElement.parentElement===e.initialElement.parentElement));if(t>-1){const e=this.section.hintsToShow[t],i=e.initialElement.parentElement||e.initialElement,o=a.BaseController.getHint(i,_);o&&(this.section.hintsToShow[t]=o)}else this.section.hintsToShow.push(e)}delete this.block.dataset.catalogHintId}}const _=this.block.querySelectorAll("[data-catalog-hint-id]");if(_.length){const e={};_.forEach((_=>{_.dataset.catalogHintId&&(Array.isArray(e[_.dataset.catalogHintId])?e[_.dataset.catalogHintId].push(_):e[_.dataset.catalogHintId]=[_],delete _.dataset.catalogHintId)})),Object.entries(e).forEach((([_,e])=>{const t=this.section.getHintById(_);if(!t)return;let i;i=1===e.length?e[0]:this.block;const o=a.BaseController.getHint(i,t);o&&this.section.hintsToShow.push(o)}))}}constructor(_,e){super(),this.section=_,this.block=e,this.listenEvents=[],this.setFromBlockContent(),this.blockItemsContainer=e.querySelector(`.${s.BLOCK_ITEMS_CONTAINER}`),this.blockItemsContainer&&(this.initialItems=[...this.blockItemsContainer.children]),this.initSpecificBlockController(),this.initGallery(),this.loader=e.getElementsByClassName(s.AUTO_LIST_LOADER)[0],this.initSearch(),this.initSortSelector(),this.initHints(),this.initListenEvents()}}},722755:(_,e,t)=>{t.d(e,{BlockItemsReplacer:()=>s});var i=t(185498),o=t(179937);class s{replaceItems(_){switch(this.dataType){case i.DataType.MusicAudios:this.replaceItemsBase(_);break;case i.DataType.MusicPlaylists:this.replaceMusicPlaylists(_);break;case i.DataType.MusicOwners:this.replaceMusicOwners(_);break;default:this.replaceItemsBase(_)}}replaceMusicPlaylists(_){let e=_;this.layoutName===o.LayoutName.LargeSlider&&(e=_.slice(0,5)),this.replaceItemsBase(e)}replaceItemsBase(_){this.container.innerHTML="",this.container.append(..._)}replaceMusicOwners(_){const e=_[0];if(e){const _=e.querySelector(".MusicOwnerCell__actions");if(_){const e=this.container.querySelector(".MusicOwnerCell__actions");if(e)e.innerHTML=_.innerHTML;else{const e=this.container.querySelector(".MusicOwnerCell__after");e&&e.appendChild(_)}}}}constructor(_,e,t){this.container=_,this.dataType=e,this.layoutName=t}}},127545:(_,e,t)=>{t.d(e,{BlockSorter:()=>s});var i=t(540745),o=t(754879);class s{getConfig(){const _=this.element.querySelector(`.${i.SORTER_ACTION_DATA}`);if(!_)return null;const e=Array.from(_.querySelectorAll("li"));if(0===e.length)return null;const t={};return t.items=e.map((_=>{const e=_.dataset.id||"";return _.dataset.selected&&(t.selected=e),[e,_.innerText]})),t.withArrow=!0,_.remove(),t}constructor(_,e){this.element=_;const t=this.getConfig();this.dropdown=new o.InlineDropdown(_,{onSelect:e,...t})}}},286450:(_,e,t)=>{t.d(e,{CatalogController:()=>o});var i=t(344243);class o{setSection(_,e,t){this.sections[_]&&this.sections[_].getId()===t.sectionId?(this.currentSection=this.sections[_],this.enableSection(_)):(this.currentSection=new i.SectionController(e,t,this),this.sections[_]=this.currentSection)}disableSection(_){this.sections[_]&&this.sections[_].disable()}enableSection(_){this.sections[_]&&this.sections[_].enable()}emitEvent(_,e){Object.values(this.sections).forEach((t=>t.emitEvent(_,e)))}deleteSection(_){const e=this.sections[_];e&&(e.destroy(),delete this.sections[_])}destroy(){Object.entries(this.sections).forEach((([,_])=>{_.destroy()})),this.headerSection&&this.headerSection.destroy()}updateSectionReorder(){this.currentSection&&this.currentSection.updateReorder()}initBlocksManually(){this.currentSection=new i.SectionController(this.root,{nextFrom:"",isBlockPagination:!1,sectionId:"",name:""},this),this.currentSection.initBlocksManually()}constructor(_){this.sections={},this.root=_;const e=this.root.querySelector(".CatalogSection--header_section");e instanceof HTMLElement&&(this.headerSection=new i.SectionController(e,{})),this.tabs=Array.from(this.root.querySelectorAll("._audio_section_tab .ui_tab"))}}},926234:(_,e,t)=>{t.d(e,{HighlightHint:()=>l});var i=t(443503),o=t(121260),s=t(516787),a=t(255693);class l extends o.Hint{show(){this.highlight=new s.default(this.initialElement,this.generateContent(),this.options),(0,a.disableBodyScroll)(),this.highlight.showTT()}hide(){this.highlight.hideTT(),(0,a.enableBodyScroll)(),super.hide()}constructor(_,e){super(i.HintType.Highlight,_),this.initialElement=e,this.options={highlight:!0,width:280,offset:[0,-17],scrollOffset:40,side:"bottom"},_.unskipable?this.options.ttOnHide=()=>{}:this.options.onBGClick=()=>this.hide()}}},121260:(_,e,t)=>{t.d(e,{Hint:()=>a});var i=t(877926),o=t(93367),s=t(851782);class a{hide(){this.onHide&&this.onHide(),s.ajax.post("al_index.php",{act:"help_hints_hide",hint_id:this.hintId,hash:this.hideHash})}generateContent(){let _=document.createElement("div");if(this.title&&(_.innerHTML+=`<div class="CatalogHint__title">${this.title}</div>`),this.text&&(_.innerHTML+=`<div class="CatalogHint__text">${this.text}</div>`),this.actions){const e=document.createElement("div");e.classList.add("CatalogHint__actions");let t=this.actions.map((_=>{const e=document.createElement("a");switch(e.classList.add("flat_button"),_.type){case"open_url":e.href=_.url,e.onclick=e=>{window.nav.go(_.url),this.hide(),(0,o.cancelEvent)(e)};break;case"switch_section":e.onclick=t=>{(0,o.cancelEvent)(t);window.currentAudioPage(e).catalogController.currentSection.switchSection(_.targetSectionId),this.hide()}}return e.innerHTML=_.label,e}));if(e.append(...t),this.tutorialSteps){const _=document.createElement("div");_.classList.add("CatalogHint__tutorialSteps"),_.innerHTML=(0,i.langStr)(i.getLang("audio_onboarding_tutorial_progress"),"step",this.tutorialSteps.current,"total_steps",this.tutorialSteps.total),e.append(_)}_.append(e)}return _}constructor(_,e){this.type=_,this.id=e.id,this.title=e.title,this.text=e.text,this.hintId=e.hintId,this.hideHash=e.hideHash,this.actions=e.actions,e.currentStep&&e.totalSteps&&(this.tutorialSteps={current:e.currentStep,total:e.totalSteps})}}},443503:(_,e,t)=>{var i;t.d(e,{HintType:()=>i}),function(_){_.Tooltip="tooltip",_.Highlight="highlight"}(i||(i={}))},912501:(_,e,t)=>{t.d(e,{TooltipHint:()=>a});var i=t(443503),o=t(121260),s=t(977070);class a extends o.Hint{show(){this.tooltip.show()}constructor(_,e){let t=e,o="center",a="top";(e.classList.contains("CatalogBlock__layout--header")||e.classList.contains("CatalogBlock__layout--header_extended"))&&(t=e.querySelector(".CatalogBlock__title")||e,o="left"),e.classList.contains("MusicAuthor__follow_btn")&&(o="right",a="bottom"),super(i.HintType.Tooltip,_),this.initialElement=e;const l={force_side:a,align:o,offset_left:0,offset_top:0,width:"250px",..._};this.tooltip=new s.ElementTooltip(t,{content:this.title||this.text||"",cls:`feature_intro_tt ${this.id} CatalogTooltip`,forceSide:l.force_side,align:l.align,width:l.width,offset:[l.offset_left,l.offset_top],autoShow:!1,onHide:()=>this.hide()})}}},173988:(_,e,t)=>{t.d(e,{MusicAuthorController:()=>o});var i=t(841508);class o{truncateName(){const _=this.blockContent.querySelector(".MusicAuthor_block__title");if(_ instanceof HTMLElement){(0,i.truncateMultilineText)(_);parseInt(getComputedStyle(_).lineHeight)===_.clientHeight&&_.classList.add("MusicAuthor_block__title--singleLine"),_.classList.remove("MusicAuthor_block__title--hidden")}}destroy(){}onDataLoad(){}constructor(_){this.blockContent=_,this.truncateName()}}},344243:(_,e,t)=>{t.d(e,{SectionController:()=>d});var i=t(324819),o=t(30655),s=t(591063),a=t(498147),l=t(540745),n=t(518314),r=t(926234);class d extends n.BaseController{showHints(){if(this.hintsToShow.length){let _;const e=this.hintsToShow.filter((_=>_ instanceof r.HighlightHint));e.length?(_=e[0],this.hintsToShow.splice(this.hintsToShow.indexOf(_),1),_.onHide=()=>this.showHints(),_.show()):this.hintsToShow.forEach((_=>_.show()))}}initBlocksManually(){this.initBlocks()}getSectionElement(){return this.sectionEl}enable(){this.initSectionAutoList(),this.blocks.forEach((_=>_.enable()))}disable(){this.sectionAutoList&&this.sectionAutoList.destroy(),this.blocks.forEach((_=>_.disable()))}emitEvent(_,e){this.blocks.forEach((t=>{e&&e!==t.getId()||t.emitEvent(_)}))}switchSection(_){const e=this.catalogController?.tabs;e&&e.forEach((e=>{e.dataset.sectionId===_&&e.click()}))}replaceBlocks(_,e,t){let i=!1;t&&this.addPlaylists(t),_.forEach((_=>{const e=_.fromIds.map((_=>this.getBlockById(_))).filter((_=>null!==_));let t=null;if(e.length&&e[e.length-1]?.block&&(t=e[e.length-1].block),!t)return;const o=a.BlockController.createNodesFromItems(_.toBlocks);o.forEach((_=>t?.insertAdjacentElement("beforebegin",_))),i=i||e.some((_=>_===this.paginatedBlockController)),e.forEach((_=>{_.block.remove(),_.destroy(),this.blocks=this.blocks.filter((e=>e!==_))}));const s=o.map((_=>new a.BlockController(this,_)));this.blocks.push(...s),this.hideShowMoreLoaders()})),"string"==typeof e&&this.setNextFrom(e),i&&(this.initPaginatedBlock(),e&&(this.isBlockPagination?this.initBlockAutoList([],this.nextFrom):this.sectionAutoList.isDone()&&this.initSectionAutoList()))}sectionInited(){this.blocks.forEach((_=>_.onSectionInit()))}initTabsHints(){const _=this.catalogController?.tabs;_&&_.forEach((_=>{if(_.dataset.catalogHintId){const e=this.getHintById(_.dataset.catalogHintId);if(e){const t=n.BaseController.getHint(_,e);t&&this.hintsToShow.push(t),delete _.dataset.catalogHintId}}}))}getHintById(_){return this.sectionData.hints&&this.sectionData.hints[_]||null}destroy(){this.sectionAutoList&&this.sectionAutoList.destroy(),this.blocks&&this.blocks.forEach((_=>_.destroy()))}getBlockById(_){return this.blocks&&this.blocks.find((e=>e.getId()===_))||null}reloadBlock(_){const e=this.findBlockByBlockName(_);e&&e.reloadData()}updateReorder(){this.blocks&&this.blocks.forEach((_=>{_.updateListReorder()}))}hideShowMoreLoaders(){this.blocks.forEach((_=>_.hideLoader()))}addPlaylists(_){_.forEach((_=>{_&&new i.AudioPlaylist(_)}))}setPagePlaylist(_){const e=window.currentAudioPage(this.sectionEl);let t=(0,o.getAudioPlayer)().getPlaylist(_.type,_.ownerId,_.id,"",_.blockId);t.mergeWith(_),t.getAudiosCount()||t.load(),e.setPagePlaylist(t)}setNextFrom(_){this.nextFrom=_,this.sectionEl&&(this.sectionEl.dataset.next=_)}initSectionAutoList(){this.sectionAutoList&&this.sectionAutoList.destroy(),this.sectionAutoList=new s.default(this.sectionEl,{fetchImmediate:!1,onNeedRows:_=>{if(this.isBlockPagination)return this.initBlockAutoList(),void _(null);this.nextFrom?(this.paginatedBlockController?.showLoader(),this.fetchNext().then((({blocks:e,data:t,blockItems:i})=>{if(this.setNextFrom(t.nextFrom),t.isBlockPagination||t.blockIds&&1===t.blockIds.length&&this.getBlockById(t.blockIds[0])){if(_(null),this.isBlockPagination=this.isBlockPagination||t.isBlockPagination,this.initBlockAutoList(i,this.nextFrom),t.playlist&&"search"===t.playlist.type){(0,o.getAudioPlayer)().getPlaylist().sendSearchStats("search_view")}}else t.playlists&&this.addPlaylists(t.playlists),_(e||null),this.initBlocks()})).catch((()=>{}))):_(null)}})}initBlocks(){this.blocks=[];const _=[];[...this.sectionEl.getElementsByClassName(l.BLOCK_ELEMENT)].forEach((e=>{e.classList.contains(l.BLOCK_DIVIDED)?e.querySelectorAll(`.${l.BLOCK_CONTENT}`).forEach((e=>_.push(e))):_.push(e)})),this.blocks=_.map((_=>new a.BlockController(this,_))),this.initPaginatedBlock()}initPaginatedBlock(){const _=this.sectionEl.querySelector(`.${l.PAGINATED_BLOCKS_CONTAINER}`);if(_){const e=[..._.getElementsByClassName(l.BLOCK_CONTENT)],t=e[e.length-1].dataset.id;t&&(this.paginatedBlockController=this.getBlockById(t))}else this.paginatedBlockController=this.blocks[this.blocks.length-1]}initBlockAutoList(_=[],e){this.paginatedBlockController&&(void 0!==e&&this.paginatedBlockController.setNextFrom(e),this.paginatedBlockController.initAutoList(_))}findBlockByBlockName(_){return this.blocks.find((e=>e.hasBlockName(_)))}constructor(_,e,t){super(),this.sectionData=e,this.catalogController=t,this.blocks=[],this.hintsToShow=[];const i=_.classList.contains(l.SECTION)?_:_.querySelector(`.${l.SECTION}`);i?(this.sectionEl=i,this.name=e.name,this.initTabsHints(),this.initBlocks(),this.nextFrom=void 0===this.sectionEl.dataset.next?e.nextFrom:this.sectionEl.dataset.next,this.id=e.sectionId,e.playlists&&e.playlists.length&&this.addPlaylists(e.playlists),e.playlist&&this.setPagePlaylist(e.playlist),this.isBlockPagination=this.sectionData.isBlockPagination,this.initSectionAutoList(),this.hideShowMoreLoaders(),this.sectionInited(),this.showHints()):this.sectionEl=_}}},185498:(_,e,t)=>{var i;t.d(e,{DataType:()=>i}),function(_){_.MusicAudios="music_audios",_.MusicPlaylists="music_playlists",_.MusicOwners="music_owners",_.RadioStations="radiostations"}(i||(i={}))},179937:(_,e,t)=>{var i;t.d(e,{LayoutName:()=>i}),function(_){_.LargeSlider="large_slider",_.List="list"}(i||(i={}))},540745:(_,e,t)=>{t.d(e,{AUTOPLAY_CONTAINER:()=>g,AUTOPLAY_DISABLED:()=>P,AUTOPLAY_HEADER:()=>b,AUTOPLAY_HEADER_WRAPPER:()=>p,AUTO_LIST_LOADER:()=>d,BLOCK_CONTENT:()=>u,BLOCK_DIVIDED:()=>r,BLOCK_ELEMENT:()=>l,BLOCK_ITEMS_CONTAINER:()=>s,BLOCK_ITEMS_REORDERABLE:()=>a,BLOCK_SEPARATOR:()=>n,GALLERY:()=>h,PAGINATED_BLOCKS_CONTAINER:()=>o,SECTION:()=>i,SORTER_ACTION:()=>c,SORTER_ACTION_DATA:()=>E});const i="CatalogSection",o="CatalogSection__paginatedBlocks",s="CatalogBlock__itemsContainer",a="CatalogBlock__itemsContainer--reorderable",l="CatalogBlock",n="CatalogBlock--separator",r="CatalogBlock--divided",d="CatalogBlock__autoListLoader",u="CatalogBlock__content",c="CatalogBlock__sorter",E="CatalogBlock__sortingData",h="ui_gallery",P="Autoplay--disabled",p="Autoplay--header__wrapper",b="Autoplay--header",g="Autoplay--container"},444477:(_,e,t)=>{t.d(e,{AutoplayBlock:()=>u});var i=t(847441),o=t(26543),s=t(954314),a=t(30655),l=t(540745),n=t(70689),r=t(67005),d=t(281700);class u{onNoMore(){this.uiScroll&&this.uiScroll.emitter.removeListener("more",this.onNeedRows)}init(_,e){if(this.container)throw new Error("AutoplayBlock already initialized");if(!this.autoplayQueue.hasMore&&0===this.autoplayQueue.list.length)return;this.container=_,this.uiScroll=e,this.offset=0,this.isPending=!1;const t=document.createElement("div");t.classList.add(l.BLOCK_ELEMENT,l.AUTOPLAY_CONTAINER),t.innerHTML=`<div class="${l.AUTOPLAY_HEADER_WRAPPER}">\n        <div>\n              <div class="${l.BLOCK_SEPARATOR}">\n                <div class="${l.BLOCK_CONTENT} CatalogBlock__layout--in_block_separator"></div>\n            </div>\n        </div>\n    </div>`,this.audioListContainer=t,t.querySelector(`.${l.AUTOPLAY_HEADER_WRAPPER}`)?.append(this.headerElement),this.renderHeader(),this.container.append(t);const i=this.autoplayQueue.service.$enabled.watch((_=>{_?this.enable():this.disable()}));this.onDestroyCallbacks.push(i)}destroy(){this.disable(),this.headerInitiator.isMounted()&&this.headerInitiator.unmount(),this.container&&(this.container=null,this.audioListContainer?.remove(),this.onDestroyCallbacks.forEach((_=>_())),this.onDestroyCallbacks=[],this.uiScroll?.emitter.removeAllListeners(),this.uiScroll=null)}enable(){if(this.enabled)return;this.audioListContainer?.classList.remove(l.AUTOPLAY_DISABLED),this.uiScroll?.emitter.addListener("more",this.onNeedRows),this.onDisableCallbacks.push((()=>{this.uiScroll?.emitter.removeListener("more",this.onNeedRows)}));const _=this.eventBus.subscribe(i.AudioPlayerEventType.PLAY_TRACK_FROM_AUTOPLAY,this.onAutoplayTrackStart);this.onDisableCallbacks.push(_.unsubscribe),this.enabled=!0,this.offset||this.onNeedRows()}disable(){this.onDisableCallbacks.forEach((_=>_())),this.onDisableCallbacks=[],this.audioListContainer?.classList.add(l.AUTOPLAY_DISABLED),this.enabled=!1}renderHeader(){this.headerInitiator.render({autoplayService:this.autoplayQueue.service})}constructor(){this.autoplayQueue=(0,a.getAudioPlayer)().getPlaylistQueue().autoplayQueue,this.eventBus=(0,a.getAudioPlayer)().getPlaylistQueue().eventBus,this.enabled=!1,this.onDisableCallbacks=[],this.onDestroyCallbacks=[],this.isPending=!1,this.offset=0,this.uiScroll=null,this.container=null,this.audioListContainer=null,this.onAutoplayTrackStart=_=>{const{autoplayQueue:e,container:t,audioListContainer:i}=this;if(!t||!i)return;const s=t.querySelector(".audio_page__audio_rows_list"),a=i.querySelector(`.${l.AUTOPLAY_HEADER_WRAPPER}`),r=(0,o.audioTupleToAudioObject)(_),d=i.querySelector(`[data-full-id="${r?.fullId}"]`);if(!(s&&a&&d&&d.parentNode))return;let u=Array.from(d.parentNode.childNodes);if(!e.hasMore&&0===e.list.length)return s.append(...u.slice(1)),void a.remove();const c=a.offsetHeight,E=d.offsetHeight,h=u.indexOf(d);u=u.slice(1,h+1),requestAnimationFrame((()=>{(0,n.setStyle)(a,{transform:`translateY(${h*E}px)`,transition:"transform  0.5s ease"}),u.forEach((_=>{(0,n.setStyle)(_,{transition:"transform  0.5s ease",transform:`translateY(-${c+18}px)`})}));const _=()=>{(0,n.setStyle)(a,{transition:null,transform:null}),u.forEach((_=>{(0,n.setStyle)(_,{transition:null,transform:null})})),s.append(...u),a.removeEventListener("transitionend",_)};a.addEventListener("transitionend",_)}))},this.onNeedRows=async()=>{try{if(this.isPending)return;this.isPending=!0;const _=this.audioListContainer;if(_){const e=await this.autoplayQueue.getNextAudios(this.offset);if(0===e.length&&!this.autoplayQueue.hasMore)return this.onNoMore();const t=e.map((_=>{const e=s.AudioUtils.drawAudio(_);e.trim();const t=document.createElement("div");return t.innerHTML=e,t.firstChild}));0!==t.length&&(_.append(...t),this.offset+=t.length),this.isPending=!1}}catch(_){this.isPending=!1,console.log(_)}};const _=document.createElement("div");_.classList.add(l.AUTOPLAY_HEADER),this.headerElement=_,this.headerInitiator=(0,r.createReactInitiator)(d.AutoplayHeaderApplication,_,{destroyAfterNavigation:!1})}}},955316:(_,e,t)=>{t.d(e,{AutoplayHeaderApplication:()=>n});var i=t(785893),o=t(504190),s=t(780891),a=t(86894),l=t(729282);function n({autoplayService:_}){const e=(0,o.useStore)(_.$toggleSupported),t=(0,o.useStore)(_.$enabled),n=(0,o.useStore)(_.setEnabledFx.pending);return(0,i.jsx)(s.AppRootProvider,{children:(0,i.jsx)(l.AutoplayHeader,{autoplaySwitch:e&&(0,i.jsx)(a.Switch,{checked:n?!t:t,disabled:n,onChange:e=>{_.setEnabledFx(e.target.checked)}})})})}},729282:(_,e,t)=>{t.d(e,{AutoplayHeader:()=>a});var i=t(785893),o=t(471828),s=t(972520);function a(_){return(0,i.jsxs)("div",{className:s.default.header,children:[(0,i.jsxs)("div",{className:s.default.content,children:[(0,i.jsx)("h2",{className:"CatalogBlock__title",children:o.getLang("audio_autoplay_title")}),(0,i.jsx)("div",{className:"CatalogBlock__subtitle",children:o.getLang("audio_autoplay_subtitle")})]}),(0,i.jsx)("div",{className:s.default.actions,children:_.autoplaySwitch})]})}},281700:(_,e,t)=>{t.d(e,{AutoplayHeaderApplication:()=>i.AutoplayHeaderApplication});var i=t(955316)},716434:(_,e,t)=>{t.d(e,{FullscreenBanner:()=>n});var i=t(851782),o=t(159663),s=t(842989),a=t(322695),l=t(324153);class n{static initiate(_){n.fetch(_).then((({banner:e,bannerId:t})=>e?new n(_,t,e):null)).catch((()=>null))}show(){this.box.show(),this.startView=this.productCollector.getCurrentTime()}hide(){this.box.hide(),this.sendViewStat()}sendViewStat(){const _={end_view:this.productCollector.getCurrentTime(),start_view:this.startView},e={type:l.EventItemType.AUDIO_FULLSCREEN_BANNER,id:this.bannerId,track_code:this.sectionId};this.viewCollector.logEvent(_,e)}static fetch(_){return new Promise(((e,t)=>{i.ajax.post("/audio?act=get_fullscreen_banner",{section_id:_},{onDone:_=>{_?.bannerId?e(_):t()},onFail:()=>(t(),!0)})}))}addEventListeners(){const _=this.box.bodyNode.querySelector(".FullscreenBanner__closeButton");_&&_.addEventListener("click",this.close.bind(this));this.box.bodyNode.querySelectorAll(".FullscreenBanner__button").forEach((_=>{_.addEventListener("click",(()=>{this.consume(_.dataset.reason||s.ConsumeReason.Click),setTimeout((()=>this.hide()))}))}))}close(){this.consume(s.ConsumeReason.Close),this.hide()}consume(_){i.ajax.post("/al_audio.php?act=consume_banner",{id:this.bannerId,type:"fullscreen",track_code:this.sectionId,reason:_})}constructor(_,e,t){this.sectionId=_,this.bannerId=e,this.productCollector=new a.ProductionStatCollector,this.viewCollector=new a.ViewStatCollector(this.productCollector),this.box=new o.MessageBox({bodyStyle:"padding: 0",width:655,containerClass:"FullscreenBanner",noControls:!0,onHide:()=>this.consume(s.ConsumeReason.Close)}),this.box.content(t),this.addEventListeners(),this.show()}}},257274:(_,e,t)=>{t.d(e,{AudioAdActionsModalApplication:()=>d});var i=t(785893),o=t(667294),s=t(924766),a=t(780891),l=t(651851),n=t(572967),r=t(273135);function d({target:_,ad:e,portalRoot:t=null,onClosed:d}){const[u,c]=(0,o.useState)((()=>{const o=e.choices.map(n.mapChoiceToActionChoice);return o.length?(0,i.jsx)(s.DropdownActionSheet,{portalRoot:t,shown:!0,onShownChange:_=>{_||c(null)},content:(0,i.jsx)(i.Fragment,{children:o.map((({label:_,action:e},t)=>(0,i.jsx)(s.DropdownActionSheet.Item,{onClick:e,children:_},t)))}),children:(0,i.jsx)(r.ForwardElementRef,{element:_})}):null}));return(0,l.useUpdateEffect)((()=>{u||d()}),[u]),(0,i.jsx)(a.AppRootProvider,{children:u})}},637381:(_,e,t)=>{t.d(e,{AudioAdActionsModalController:()=>a});var i=t(4139),o=t(257274);let s;class a{static ensure(){return s||(s=new a),s}open(_,e,t){this.mount(_,e,t)}close(_){_&&_!==this.currentTarget||this.unmount()}isOpen(_){return(!_||_===this.currentTarget)&&this.initiator.isMounted()}unmount(){this.initiator.unmount(),this.currentTarget=null}mount(_,e,t){this.isOpen(_)||(this.currentTarget=_),this.initiator.render({target:_,ad:e,portalRoot:t,onClosed:this.handleClosed})}constructor(){this.initiator=(0,i.createReactInitiator)(o.AudioAdActionsModalApplication),this.handleClosed=()=>{this.unmount()}}}}}]);try{stManager.done("dist/web/chunks/7ecb3ed3.9c85fb1d.js")}catch(_){}