(()=>{"use strict";var t,e,i,n={466394:(t,e,i)=>{i.d(e,{EasterEggs:()=>l});var n=i(541843),o=i(70689),s=i(902947),a=i(93367),r=i(324153),c=i(322695),h=i(251087),d=i(2190),u=i(618418),g=i(184132);const l={URL:"easter-eggs",ANIMATION_GROUP:"easter_eggs",CLICK_ANIMATION_GROUP:"easter_eggs_click",ACT_POPUP:"getPopup",ACT_FOUND_EGG:"foundEgg",ACT_HIDE_EVENT:"hideEvent",ACT_EASTER_EGGS:"getEasterEggs",ACT_PERFORM_ACTION:"performAction",frames:{},activeAnimations:{},_init:function(t){this.eggs=t,this._checkContainer(),this._setEggs(),this._setCurEvents(),n.LottieManager.observer.ignoreGroup(this.CLICK_ANIMATION_GROUP)},_setCurEvents:function(){this.curSet||(this.curSet=!0,window.cur._back?(window.cur._back.hide&&window.cur._back.hide.push(this._flush.bind(this)),window.cur._back.show&&(window.cur._back.show.push(this._flush.bind(this)),window.cur._back.show.push(this.updateEggs.bind(this)))):(0,u.pushNavDestroy)((()=>this._flush())))},_flush:function(t){if(this.activeAnimations)for(let e in this.activeAnimations)if(this.activeAnimations.hasOwnProperty(e)){const i=e.split("_");(0,s.isNumeric)(t)&&t!==parseInt(i[0])||(this.activeAnimations[e].stop(),this.activeAnimations[e].destroy(),delete this.activeAnimations[e])}if(this.frames)for(let e in this.frames)if(this.frames.hasOwnProperty(e)){const i=e.split("_");(0,s.isNumeric)(t)&&t!==parseInt(i[0])||((0,a.removeEvent)(this.frames[e],"click"),(0,a.removeEvent)((0,o.geByClass)("EasterEggFrame__hideEvent",this.frames[e]),"click"),this.frames[e].parentNode.removeChild(this.frames[e]),delete this.frames[e])}this.container&&(this.container.innerHTML=""),this.frames=[],this.activeAnimations=[]},_checkContainer:function(){this.container||(this.container=document.body.appendChild((0,o.ce)("div",{className:"EasterEggsContainer",innerHTML:""})))},_setEggs:function(){this.eggs&&this.eggs.forEach((t=>{t.positions&&t.positions.length&&t.positions.forEach((e=>{this._validPosition(e.url_regexp)&&this._appendEasterEgg(e,t)}))}))},_validPosition:function(t){if(t=(t||"").replace(/(^#)|(#$)/g,""))try{const e=new RegExp(t),i=this._getNormalizedUrl();return e.test(i)}catch(t){return!1}return!1},_getNormalizedUrl(){switch(window.cur.module){case"profile":return"/id"+(window.cur.oid||0);case"groups":return"/club"+(void 0===window.cur.oid?0:-window.cur.oid);default:return location.pathname}},_appendEasterEgg:function(t,e){e.animation?.url&&this._getAnimation(e.animation?.url).then((async i=>{const c=document.createElement("div");c.className="EasterEggFrame",(0,a.addEvent)(c,"click",function i(){(0,a.removeEvent)(c,"click",i),this.onFrameClick({eggId:e.id,eggEventId:e.event_id,positionId:t.position_id,hash:t.hash,url:e.url,clickAnimation:e.click_animation})}.bind(this));const h=document.createElement("div");h.className="EasterEggFrame__hideEvent",(0,a.addEvent)(h,"click",(i=>{(0,a.stopEvent)(i),this.onHideClick({eventId:e.event_id,eggId:e.id,positionId:t.position_id})})),(0,s.isNumeric)(t.appearance.top)?(0,o.setStyle)(c,{top:t.appearance.top}):(0,s.isNumeric)(t.appearance.bottom)&&(0,o.setStyle)(c,{bottom:t.appearance.bottom}),(0,s.isNumeric)(t.appearance.left)?((0,o.setStyle)(c,{left:t.appearance.left}),(0,o.setStyle)(h,{right:0})):(0,s.isNumeric)(t.appearance.right)&&((0,o.setStyle)(c,{right:t.appearance.right}),(0,o.setStyle)(h,{left:0})),t.appearance.fixed&&(0,o.setStyle)(c,{position:"absolute"}),e.animation?.width&&(0,o.setStyle)(c,{width:e.animation?.width}),e.animation?.height&&(0,o.setStyle)(c,{height:e.animation?.height});let d=null;t.appearance.container&&(d=document.querySelector(t.appearance.container)),d?d.appendChild(c):this.container.appendChild(c),c.style.display="block";const u=await n.LottieManager.loadAnimation({group:this.ANIMATION_GROUP,name:e.animation?.url,animationData:i,containers:[c],width:e.animation?.width,height:e.animation?.height,loop:!0,autoplay:!0}).catch((()=>{c.style.display="none"}));c.appendChild(h);const g=e.id+"_"+t.position_id;this.frames[g]=c,this.activeAnimations[g]=u,this.sendStats(r.IEasterEggsItemEventType.EGG_SHOW,e.id,e.event_id,t.position_id)}))},async _runClickAnimation(t,e,i,s){const a=t+"_"+e,r=this.frames[a],c=this.activeAnimations[a];i?.width&&(0,o.setStyle)(r,{width:i?.width}),i?.height&&(0,o.setStyle)(r,{height:i?.height});const h=await n.LottieManager.loadAnimation({group:this.CLICK_ANIMATION_GROUP,name:i.url,animationData:s,containers:[r],width:i?.width,height:i?.height,loop:!1,autoplay:!0});c&&c.destroy(),this.activeAnimations[a]=h},_getAnimation:function(t){return new Promise(((e,i)=>{const n=new XMLHttpRequest;n.open("GET",t,!0),n.send(),n.onreadystatechange=()=>{if(4===n.readyState)try{const t=JSON.parse(n.responseText);e(t)}catch(t){i()}}}))},onFrameClick:function(t){if(!(0,s.isNumeric)(t.eggId)||!(0,s.isNumeric)(t.positionId))return;const e=()=>{this._foundEgg(t.eggId,t.positionId,t.hash,(()=>{if(this._flush(t.eggId),t.url)return window.nav.go(t.url);this._showPopup(t.eggId,t.eggEventId,t.positionId)}))};t.clickAnimation&&t.clickAnimation.url?this._getAnimation(t.clickAnimation?.url).then((i=>{this._runClickAnimation(t.eggId,t.positionId,t.clickAnimation,i),setTimeout(e,t.clickAnimation?.duration||0)})):e()},onHideClick:function(t){window.ajax.post(this.URL,{act:this.ACT_HIDE_EVENT,event_id:t.eventId,egg_id:t.eggId,position_id:t.positionId},{onDone:()=>{this.updateEggs()},onFail:()=>!0})},_foundEgg:function(t,e,i,n){window.ajax.post(this.URL,{act:this.ACT_FOUND_EGG,egg_id:t,position_id:e,position_hash:i},{onDone:()=>{this.updateEggs(),n&&n()},onFail:()=>!0})},updateEggs:function(){this._flush(),window.ajax.post(this.URL,{act:this.ACT_EASTER_EGGS,url:window.location.pathname},{onDone:t=>{t&&this._init(t)},onFail:()=>!0})},_showPopup:function(t,e,i){g.Ranges.isUserId(window.vk.id)&&window.ajax.post(this.URL,{act:this.ACT_POPUP,egg_id:t},{onDone:(n,o,s)=>{if(!o)return;if("function"!=typeof window.MessageBox)return;const a=new window.MessageBox({title:n,hideButtons:!0,needShadow:!1,containerClass:"ImageStatusPopup__container",onShow:()=>{this.sendStats(r.IEasterEggsItemEventType.POPUP_SHOW,t,e,i),this.curBoxData={eggId:t,eggEventId:e,positionId:i}},onDestroy:()=>{this.curBoxData={}}});a.content(o),a.show(),setTimeout((()=>{a.evalBox(s,this.URL,{act:this.ACT_POPUP})}))},onFail:()=>!0})},sendStats:function(t,e=0,i=0,n=0){t===r.IEasterEggsItemEventType.POPUP_ACTION&&this.curBoxData&&(e=this.curBoxData.eggId,i=this.curBoxData.eggEventId,n=this.curBoxData.positionId),c.easterEggsItemStat.logEvent(e,i,n,t)},performAction:function(t,e){e.preventDefault(),this.sendStats(r.IEasterEggsItemEventType.POPUP_ACTION),t&&window.ajax.post(this.URL,{act:this.ACT_PERFORM_ACTION,jwt:t},{onDone:()=>((0,h.curBox)()?.hide(),!0),onFail:()=>((0,h.curBox)()?.hide(),!0)})},setLightTheme(t){t.preventDefault(),this.sendStats(r.IEasterEggsItemEventType.POPUP_ACTION),(0,h.curBox)()?.hide(),d.colorScheme.setMode(d.ColorSchemeMode.Light)}}},831842:(t,e,i)=>{var n=i(802130),o=i(466394);window.vk?.pe?.static_manager_dynamic_imports&&window.vk?.stDomain&&(i.p=window.vk.stDomain+"/dist/"),window.EasterEggs=o.EasterEggs;try{window.stManager.done(window.jsc("web/easter_eggs.js"))}catch(t){}requestIdleCallback((()=>{try{(0,n.statlogsValueEvent)("entries_requests",1,"easter_eggs","web")}catch{}}),{timeout:5e3})}},o={};function s(t){var e=o[t];if(void 0!==e)return e.exports;var i=o[t]={exports:{}};return n[t].call(i.exports,i,i.exports,s),i.exports}s.m=n,t=[],s.O=(e,i,n,o)=>{if(!i){var a=1/0;for(d=0;d<t.length;d++){for(var[i,n,o]=t[d],r=!0,c=0;c<i.length;c++)(!1&o||a>=o)&&Object.keys(s.O).every((t=>s.O[t](i[c])))?i.splice(c--,1):(r=!1,o<a&&(a=o));if(r){t.splice(d--,1);var h=n();void 0!==h&&(e=h)}}return e}o=o||0;for(var d=t.length;d>0&&t[d-1][2]>o;d--)t[d]=t[d-1];t[d]=[i,n,o]},s.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return s.d(e,{a:e}),e},i=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,s.t=function(t,n){if(1&n&&(t=this(t)),8&n)return t;if("object"==typeof t&&t){if(4&n&&t.__esModule)return t;if(16&n&&"function"==typeof t.then)return t}var o=Object.create(null);s.r(o);var a={};e=e||[null,i({}),i([]),i(i)];for(var r=2&n&&t;"object"==typeof r&&!~e.indexOf(r);r=i(r))Object.getOwnPropertyNames(r).forEach((e=>a[e]=()=>t[e]));return a.default=()=>t,s.d(o,a),o},s.d=(t,e)=>{for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},s.e=()=>Promise.resolve(),s.u=t=>53297===t?"chunks/"+t+".a3bee52c.js":71475===t?"chunks/"+t+".db838172.js":void 0,s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),s.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.p="/dist/",(()=>{s.b=document.baseURI||self.location.href;var t={77265:0};s.O.j=e=>0===t[e];var e=(e,i)=>{var n,o,[a,r,c]=i,h=0;if(a.some((e=>0!==t[e]))){for(n in r)s.o(r,n)&&(s.m[n]=r[n]);if(c)var d=c(s)}for(e&&e(i);h<a.length;h++)o=a[h],s.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return s.O(d)},i=self.webpackChunkvkweb=self.webpackChunkvkweb||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))})();var a=s.O(void 0,[213,95167,75934],(()=>s(831842)));a=s.O(a)})();